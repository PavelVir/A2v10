"use strict";function findHandle(t){for(let e of t.childNodes)if(e.nodeType===Node.ELEMENT_NODE&&e.classList.contains("drag-handle"))return e;return null}!function(){window.app={modules:{},components:{},nextToken:function(){return""+i++}},window.require=e,window.component=function(t,e){if(t in app.components)return app.components[t];if(e)return{};throw new Error('component "'+t+'" not found')},window.define=function(t,i){let s={default:void 0};return i(e,s),s.default};let t=document.querySelector("meta[name=rootUrl]");function e(t,e){if(t in app.modules){let e=app.modules[t];return"function"==typeof e&&(e=e(),app.modules[t]=e),e}if(e)return null;throw new Error('module "'+t+'" not found')}window.$$rootUrl=t&&t.content||"";let i=1603}(),app.modules["std:locale"]=function(){return window.$$locale},function(t){t.closest=t.closest||function(t){let e=this;for(;e;){if(e.matches(t))return e;e=e.parentElement}return null},t.scrollIntoViewCheck=t.scrollIntoViewCheck||function(){let t=this,e=t.getBoundingClientRect(),i=t.parentElement;for(;i&&!(i.offsetHeight<i.scrollHeight);)i=i.parentElement;if(!i)return;let s=i.getBoundingClientRect();(e.top<s.top||e.bottom>s.bottom)&&t.scrollIntoView({block:"nearest"})}}(Element.prototype),function(t){t.isZero=t.isZero||function(){let t=new Date(0,0,1,0,0,0,0);return t.setHours(0,-t.getTimezoneOffset(),0,0),this.getTime()===t.getTime()}}(Date.prototype),app.modules["std:platform"]={set:function(t,e,i){Vue.set(t,e,i)},defer:function(t){Vue.nextTick(t)},print:function(){window.print()},File,performance},app.modules["std:eventBus"]=new Vue({}),app.modules["std:const"]=function(){return{SEVERITY:{ERROR:"error",WARNING:"warning",INFO:"info"}}},app.modules["std:utils"]=function(){const t=require("std:locale"),e=require("std:platform"),i=t.$Locale,s=t.$Locale,n={timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit"},r={timeZone:"UTC",hour:"2-digit",minute:"2-digit"},o=new Intl.DateTimeFormat(i,n).format,a=new Intl.DateTimeFormat(i,r).format,l=new Intl.NumberFormat(s,{minimumFractionDigits:2,maximumFractionDigits:6,useGrouping:!0}).format,d=new Intl.NumberFormat(s,{minimumFractionDigits:0,maximumFractionDigits:6,useGrouping:!0}).format,c=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?Z$/;let u={};return{isArray:Array.isArray,isFunction:function(t){return"function"==typeof t},isDefined:h,isObject:p,isObjectExact:v,isDate:m,isString:f,isNumber:g,isBoolean:function(t){return"boolean"==typeof t},toString:function(t){if(!h(t))return"";if(null===t)return"";if(p(t))return $(t);return""+t},defaultValue:function(t){switch(t){case void 0:return;case Number:return 0;case String:return"";case Boolean:return!1;case Date:return C();case Object:return null;default:if("function"==typeof t)return null;throw new Error("There is no default value for type "+t)}},notBlank:function(t){if(!t)return!1;if(m(t))return!T(t);switch(typeof t){case"string":return""!==t;case"date":return!1;case"object":if("$id"in t)return!!t.$id}return""!==(t||"")},toJson:$,fromJson:JSON.parse,isPrimitiveCtor:function(t){return t===String||t===Number||t===Boolean||t===Date||t===e.File||t===Object},isDateCtor:function(t){return t===Date},isEmptyObject:function(t){return!t||0===Object.keys(t).length&&t.constructor===Object},defineProperty:function(t,e,i,s){Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:i})},eval:function(t,e,i,s,n){let r=b(t,e);if(n)return r;return m(r)?x(r,i):p(r)?$(r):x(r,i,s)},simpleEval:b,format:x,toNumber:k,parse:function(t,e){switch(e){case"Currency":case"Number":return k(t);case"Date":return D(t)}return t},getStringId:function(t){if(!t)return"0";if(g(t))return t;if(v(t)){if("$id"in t)return t.$id||0;if("Id"in t)return t.Id||0;console.error("Id or @id not found in object")}return"0"},isEqual:function(t,e){if(t===e)return!0;if(m(t)&&m(e))return t.getTime()===e.getTime();if(v(t)&&v(e))return JSON.stringify(t)===JSON.stringify(e);return!1},date:{today:S,now:function(t){let e=new Date,i=t?e.getSeconds():0;return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),i,0))},zero:C,parse:D,tryParse:function(t){if(!t)return C();if(m(t))return t;if(c.test(t))return new Date(t);let e;e=8===t.length?new Date(+t.substring(0,4),+t.substring(4,6)-1,+t.substring(6,8),0,0,0,0):t.startsWith('"\\/"')?new Date(t.substring(4,t.length-4)):new Date(t);if(!isNaN(e.getTime()))return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0));return t},equal:I,isZero:T,formatDate:o,format:o,add:function(t,e,i){if(!m(t))return null;var s=0;switch(i){case"year":return new Date(Date.UTC(t.getFullYear()+e,t.getMonth(),t.getDate(),0,0,0,0));case"month":let i=t.getMonth()+e,r=t.getDate();var n=new Date(Date.UTC(t.getFullYear(),i+1,0,0,0)).getDate();return r>n&&(r=n),new Date(Date.UTC(t.getFullYear(),i,r,0,0,0));case"day":s=864e5;break;case"hour":s=36e5;break;case"minute":s=6e4;break;case"second":s=1e3;break;default:throw new Error("Invalid unit value for utils.date.add")}return new Date(t.getTime()+e*s)},diff:function(t,e,i){e.getTime()>i.getTime()&&([e,i]=[i,e]);switch(t){case"second":return(i-e)/1e3;case"minute":return+((i-e)/1e3/60).toFixed(0);case"month":let t=0;if(i.getDate()<e.getDate()&&(t=-1),e.getFullYear()===i.getFullYear())return i.getMonth()-e.getMonth()+t;let s=0,n=e.getFullYear();for(;n<i.getFullYear();){let t=i.getDate(),r=O(new Date(n+1,e.getMonth(),1,0,0,0,0)).getDate();t>r&&(t=r),e=new Date(n+1,e.getMonth(),t,0,0,0,0),n=e.getFullYear(),s+=12}return s+=i.getMonth()-e.getMonth(),s+t;case"day":let r=864e5;return Math.floor((i-e)/r);case"year":let o=new Date(e.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())<e?i>e?-1:0:i<e?1:0;return i.getFullYear()-e.getFullYear()+o}throw new Error("Invalid unit value for utils.date.diff")},create:F,compare:function(t,e){if(!m(t)||!m(e))return null;let i=t.getTime(),s=e.getTime();return i-s},endOfMonth:O,minDate:F(1901,1,1),maxDate:F(2999,12,31),fromDays:function(t){return new Date(Date.UTC(1900,0,t,0,0,0,0))},parseTime:function(t){let e=(t=t||"").split(/[^\d]/).filter(t=>t);if(0===e.length)return new Date(1970,0,1,0,0,0,0);1===e.length&&e.push("0");let i=Math.min(+e[0],23),s=Math.min(+e[1],59);return new Date(1970,0,1,i,s,0,0)}},text:{contains:q,containsText:function(t,e,i){if(!i)return!0;if(!t)return!1;for(let s of e.split(","))if(q(t[s],i))return!0;return!1},sanitize:function(t){return(""+t||"").replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"")},splitPath:function(t){let e=t.lastIndexOf(".");return{obj:t.substring(0,e),prop:t.substring(e+1)}},capitalize:M,maxChars:function(t,e){return(t=""+t||"").length<e?t:t.substring(0,e-1)+"â€¦"},equalNoCase:function(t,e){return(t||"").toLowerCase()===(e||"").toLowerCase()}},currency:{round:function(t,e){if(isNaN(t))return Nan;h(e)||(e=2);let i=!1;t<0&&(t=-t,i=!0);let s=Number(Math.round(t.toFixed(12)+"e"+e)+"e-"+e);return i?-s:s},format:l},func:{curry:function(t,...e){return(...i)=>t(...e,...i)},debounce:U},debounce:U};function h(t){return void 0!==t}function p(t){return null!==t&&"object"==typeof t}function m(t){return t instanceof Date}function f(t){return"string"==typeof t}function g(t){return"number"==typeof t}function v(t){return p(t)&&!Array.isArray(t)}function $(t){return JSON.stringify(t,(function(t,e){if(!T(this[t]))return"$"===t[0]||"_"===t[0]?void 0:e}),2)}function b(t,e){if(!e||!t)return"";let i=(e||"").split("."),s=t;for(let t=0;t<i.length;t++){let e=i[t];if(!(e in s))throw new Error(`Property '${e}' not found in ${s.constructor.name} object`);s=s[i[t]]}return s}function _(t){return t<10?"0"+t:""+t}function y(t,e){if(!e)return d(t);if(u[e])return u[e](t);let i=e.match(/^([#][,\s])?(#*)?(0*)?\.?(0*)?(#*)?$/);if(!i)return console.error(`Invalid number format: '${e}'`),t;function n(t){return t?t.length:0}let r=!!i[1],o=(n(i[2]),n(i[3])),a=n(i[4]),l=n(i[5]),c=Intl.NumberFormat(s,{minimumFractionDigits:a,maximumFractionDigits:a+l,minimumIntegerDigits:o,useGrouping:r}).format;return u[e]=c,c(t)}function w(e,i){if(!i)return o(e);switch(i){case"MMMM yyyy":return M(e.toLocaleDateString(t.$Locale,{month:"long",year:"numeric"}));default:console.error("invalid date format: "+i)}return o(e)}function x(t,e,i){if(i=i||{},!e)return t;if(!h(t))return"";switch(e){case"DateTime":return m(t)?T(t)?"":i.format?w(t,i.format):o(t)+" "+a(t):(console.error(`Invalid Date for utils.format (${t})`),t);case"Date":return f(t)&&(t=function(t){try{let e=new Date(t);return e.setUTCHours(0,0,0,0),e}catch(e){return t}}(t)),m(t)?T(t)?"":i.format?w(t,i.format):o(t):(console.error(`Invalid Date for utils.format (${t})`),t);case"DateUrl":return T(t)?"":m(s=t)&&(0!==s.getUTCHours()||0!==s.getUTCMinutes()&&0!==s.getUTCSeconds())?t.toISOString():""+t.getFullYear()+_(t.getMonth()+1)+_(t.getDate());case"Time":return m(t)?T(t)?"":a(t):(console.error(`Invalid Date for utils.format (${t})`),t);case"Period":return t.format?t.format("Date"):(console.error(`Invalid Period for utils.format (${t})`),t);case"Currency":return g(t)||(t=k(t)),i.hideZeros&&0===t?"":i.format?y(t,i.format):l(t);case"Number":return g(t)||(t=k(t)),i.hideZeros&&0===t?"":y(t,i.format);default:console.error(`Invalid DataType for utils.format (${e})`)}var s;return t}function k(t){return f(t)&&(t=t.replace(/\s/g,"").replace(",",".")),isFinite(t)?+t:0}function S(){let t=new Date;return new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0))}function C(){return new Date(Date.UTC(0,0,1,0,0,0,0))}function D(t,e){if(t=t||"",c.test(t))return new Date(t);if(!t)return C();let i=S(),s=t.split(/[^\d]/).filter(t=>t);if(1===s.length)if(8===s[0].length){let t=s[0];s=[],s.push(t.substring(0,2)),s.push(t.substring(2,4)),s.push(t.substring(4))}else s.push(""+(i.getMonth()+1)),s.push(""+i.getFullYear());else 2===s.length&&s.push(""+i.getFullYear());let n=function(t){let s=e||"+10";return t<=(s.startsWith("+")||s.startsWith("-")?i.getFullYear()%100+parseInt(s,10):+s%100)?"20":"19"},r=new Date(Date.UTC(+function(t){switch((t=""+t).length){case 1:t=n(t)+"0"+t;break;case 2:t=n(t)+t;break;case 4:break;default:t=i.getFullYear()}return+t}(s[2]),+((s[1]?s[1]:1)-1),+s[0],0,0,0,0));return isNaN(r.getDate())?C():r}function I(t,e){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}function T(t){return!!m(t)&&I(t,C())}function O(t){return new Date(Date.UTC(t.getFullYear(),t.getMonth()+1,0,0,0,0))}function F(t,e,i){return new Date(Date.UTC(t,e-1,i,0,0,0,0))}function M(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""}function q(t,e){return!e||!!t&&-1!==(t||"").toString().toLowerCase().indexOf(e.toLowerCase())}function U(t,e){let i=null;return function(){clearTimeout(i),i=setTimeout(()=>{t.call()},e)}}},app.modules["std:url"]=function(){const t=require("std:utils"),e=require("std:period");return{combine:s,makeQueryString:r,parseQueryString:o,normalizeRoot:function(t){let e=window.$$rootUrl;return e&&t.startsWith(e)?t.substring(e.length):t},idChangedOnly:function(t,e){let i=(t||"").split("?")[0],s=(e||"").split("?")[0],n=i.split("/"),r=s.split("/");if(n.length!==r.length)return!1;function o(t){let e=t[t.length-1];return"new"===e||"0"===e}if(o(r)&&!o(n)&&n.slice(0,n.length-1).join("/")===r.slice(0,r.length-1).join("/"))return!0;return!1},idOrCopyChanged:function(t,e){let i=(t||"").split("?")[0],s=(e||"").split("?")[0],n=i.split("/"),r=s.split("/");if(n.length!==r.length)return!1;if(n.pop(),r.pop(),"edit"===n.pop()&&"copy"===r.pop())return n.join("/")===r.join("/");return!1},makeBaseUrl:function(t){let e=(t||"").split("/"),i=e.length;return i>=6?e.slice(2,i-2).join("/"):t},parseUrlAndQuery:a,replaceUrlQuery:function(t,e){t||(t=window.location.pathname+window.location.search);let i=a(t,e);return i.url+r(i.query)},createUrlForNavigate:function(e,i){let n=i||"new",o="";t.isDefined(n.$id)?n=n.$id:t.isObjectExact(n)&&(n=i.Id,delete i.Id,o=r(i),t.isDefined(n)||(n="new"));e.endsWith("new")&&"new"===n&&(n="");return s(e,n)+o},firstUrl:"",encodeUrl:encodeURIComponent,helpHref:function(t){let e=document.querySelector("meta[name=helpUrl]");if(!e||!e.content)return console.warn("help url is not specified"),"";return e.content+(t||"")},replaceSegment:function(t,e,i){let s=t.split("/");l(t)?(s.pop(),e&&s.push(e)):(i&&s.pop(),e&&s.pop(),i&&s.push(i),e&&s.push(e));return s.join("/")},removeFirstSlash:function(t){return t&&t.startsWith&&t.startsWith("/")?t.substring(1):t},isNewPath:function(t){return!!(t=t.split("?")[0])&&(-1!==t.indexOf("/new")||!(!l(t)||!t.endsWith("/0")))}};function i(t){return(t=(t=""+t||"").replace(/\\/g,"/")).startsWith("/")&&(t=t.substring(1)),t.endsWith("/")&&(t=t.substring(0,t.length-1)),t}function s(...t){return"/"+t.map(i).filter(t=>!!t).join("/")}function n(i){return t.isDefined(i)&&null!==i?t.isDate(i)?t.format(i,"DateUrl"):e.isPeriod(i)?i.format("DateUrl"):t.isObjectExact(i)?"Object"===i.constructor.name?(t.isDefined(i.Id)||console.error("Id is not defined for Filter object"),""+(i.Id||"")):(t.isDefined(i.$id)||console.error("$id is not defined for "+i.constructor.name),""+(i.$id||"0")):""+i:""}function r(e){if(!e)return"";if(!t.isObjectExact(e))return"";let i=encodeURIComponent,s=Object.keys(e).filter(t=>!t.startsWith("_")&&!t.startsWith("$")&&!function(t){if(!t)return!0;let e=n(t);return!e||"0"===e}(e[t])).map(t=>i(t)+"="+i(n(e[t]))).join("&");return s?"?"+s:""}function o(t){var e={};return t.replace(/\??([^=&]+)=([^&]*)/g,(function(t,i,s){e[decodeURIComponent(i)]=""+decodeURIComponent(s)})),e}function a(t,e){let i={};for(let t in e)t.startsWith("_")||t.startsWith("$")||(i[t]=n(e[t]));let s={url:t,query:i};if(-1!==t.indexOf("?")){let e=t.split("?");s.url=e[0],s.query=Object.assign({},o(e[1]),i)}return s}function l(t){return t.startsWith("/_dialog/")}},app.modules["std:period"]=function(){const t=require("std:utils"),e=t.date,i=window.$$locale;function s(t){t&&"From"in t&&(t.From||t.To)?(this.From=e.tryParse(t.From),this.To=e.tryParse(t.To)):(this.From=e.minDate,this.To=e.maxDate),Object.defineProperty(this,"Name",{enumerable:!0,get(){return this.format("Date")}})}return s.prototype.assign=function(t){return n(t)?(this.From=t.From,this.To=t.To):null===t.From&&null===t.To?(this.From=e.minDate,this.To=e.maxDate):(this.From=e.tryParse(t.From),this.To=e.tryParse(t.To)),this.normalize(),this},s.prototype.equal=function(t){return e.equal(this.From,t.From)&&e.equal(this.To,t.To)},s.prototype.fromUrl=function(i){if(t.isObject(i)&&"From"in i)return this.From=e.tryParse(i.From),this.To=e.tryParse(i.To),this.normalize(),this;let s=(i||"").split("-");if("all"===s[0].toLowerCase())return this.From=e.minDate,this.To=e.maxDate,this;let n=s[0],r=s.length>1?s[1]:s[0];return this.From=e.tryParse(n),this.To=e.tryParse(r),this},s.prototype.isAllData=function(){return this.From.getTime()===e.minDate.getTime()&&this.To.getTime()===e.maxDate.getTime()},s.prototype.format=function(e){if(this.isAllData())return"DateUrl"===e?"All":i.$AllPeriodData;let s=this.From,n=this.To;return s.getTime()===n.getTime()?t.format(s,e):"DateUrl"===e?t.format(s,e)+"-"+t.format(n,e):t.format(s,e)+" - "+(t.format(n,e)||"???")},s.prototype.text=function(e){if(this.isAllData())return i.$AllPeriodData;let s=o(!1);for(let t of s){let e=a(t.key);if(this.equal(e))return t.name}if(e)return i.$CustomPeriod;let n=this.From,r=this.To;return t.format(n,"Date")+" - "+(t.format(r,"Date")||"???")},s.prototype.in=function(e){let i=e.getTime(),s=t.date.zero().getTime();if(this.From.getTime()!==s&&this.To.getTime()!==s)return i>=this.From.getTime()&&i<=this.To.getTime()},s.prototype.normalize=function(){return this.From.getTime()>this.To.getTime()&&([this.From,this.To]=[this.To,this.From]),this},s.prototype.set=function(t,e){return this.From=t,this.To=e,this.normalize()},s.prototype.toJson=function(){return JSON.stringify(this)},{isPeriod:n,like:function(t){return!!t&&(2===Object.getOwnPropertyNames(t).length&&!(!t.hasOwnProperty("From")||!t.hasOwnProperty("To")))},constructor:s,zero:r,all:function(){return a("allData")},create:a,predefined:o};function n(t){return t instanceof s}function r(){return new s}function o(t){let e=[{name:i.$Today,key:"today"},{name:i.$Yesterday,key:"yesterday"},{name:i.$Last7Days,key:"last7"},{name:i.$CurrMonth,key:"currMonth"},{name:i.$PrevMonth,key:"prevMonth"},{name:i.$CurrQuart,key:"currQuart"},{name:i.$PrevQuart,key:"prevQuart"},{name:i.$CurrYear,key:"currYear"},{name:i.$PrevYear,key:"prevYear"}];return t&&e.push({name:i.$AllPeriodData,key:"allData"}),e}function a(t,i,s){let n=e.today(),o=r();switch(t){case"today":o.set(n,n);break;case"yesterday":let r=e.add(n,-1,"day");o.set(r,r);break;case"last7":let a=e.add(n,-6,"day");o.set(a,n);break;case"last30":let l=e.add(n,-29,"day");o.set(l,n);break;case"startMonth":let d=e.create(n.getFullYear(),n.getMonth()+1,1);o.set(d,n);break;case"prevMonth":{let t=e.create(n.getFullYear(),n.getMonth(),1),i=e.create(n.getFullYear(),n.getMonth()+1,1);o.set(t,e.add(i,-1,"day"))}break;case"currMonth":{let t=e.create(n.getFullYear(),n.getMonth()+1,1),i=e.create(n.getFullYear(),n.getMonth()+2,1);o.set(t,e.add(i,-1,"day"))}break;case"startQuart":{let t=3*Math.floor(n.getMonth()/3),i=e.create(n.getFullYear(),t+1,1);o.set(i,n)}break;case"currQuart":{let t=n.getFullYear(),i=Math.floor(n.getMonth()/3),s=3*i,r=3*(i+1),a=e.create(t,s+1,1),l=e.add(e.create(t,r+1,1),-1,"day");o.set(a,l)}break;case"prevQuart":{let t=n.getFullYear(),i=Math.floor(n.getMonth()/3)-1;i<0&&(t-=1,i=3);let s=3*i,r=3*(i+1),a=e.create(t,s+1,1),l=e.add(e.create(t,r+1,1),-1,"day");o.set(a,l)}break;case"startYear":let c=e.create(n.getFullYear(),1,1);o.set(c,n);break;case"currYear":{let t=e.create(n.getFullYear(),1,1),i=e.create(n.getFullYear(),12,31);o.set(t,i)}break;case"prevYear":{let t=e.create(n.getFullYear()-1,1,1),i=e.create(n.getFullYear()-1,12,31);o.set(t,i)}break;case"allData":o.set(e.minDate,e.maxDate);break;case"custom":o.set(i,s);break;default:console.error("invalid menu key: "+t)}return o}},app.modules["std:modelInfo"]=function(){const t=require("std:period");return{copyfromQuery:function(t,e){if(!t)return;let i={PageSize:e.pageSize,Offset:e.offset,SortDir:e.dir,SortOrder:e.order,GroupBy:e.group};for(let e in i)t[e]=i[e];if(t.Filter)for(let i in t.Filter)t.Filter[i]=e[i]},get:function(t){if(!t)return;let e={pageSize:t.PageSize,offset:t.Offset,dir:t.SortDir,order:t.SortOrder,group:t.GroupBy};if(t.Filter)for(let i in t.Filter)e[i]=t.Filter[i];return e},reconcile:e,reconcileAll:i,setModelInfoForRoot:function(t){t.$createModelInfo=o,t._setModelInfo_=r,t._findRootModelInfo=a},setModelInfo:function(t,e,n){t.__modelInfo=e||{PageSize:20};let r=n.$ModelInfo;if(!r)return;i(r);for(let e in r)t[e].$ModelInfo=s(r[e])}};function e(t){if(t&&t.Filter)for(let e in t.Filter){let i=t.Filter[e];if("string"==typeof i&&i.startsWith('"\\/"')){let s=new Date(i.substring(4,i.length-4));t.Filter[e]=s}}}function i(t){if(t)for(let i in t)e(t[i])}function s(e){let i=e.Filter;if(!i)return e;if(!("Period"in i))return e;let s=i.Period;return t.like(s)&&(i.Period=new t.constructor(s)),e}function n(e,i){t.isPeriod(i)?this.Filter[e].assign(i):this.Filter[e]=i}function r(t,e){if(e.$ModelInfo)for(let i in e.$ModelInfo)return t||(t=this[i]),t.$ModelInfo=s(e.$ModelInfo[i]),t.$ModelInfo.$setFilter=n,t.$ModelInfo}function o(t,e){return t.$ModelInfo||(t.$ModelInfo=s(e),t.$ModelInfo.$setFilter=n),t.$ModelInfo}function a(){for(let t in this._meta_.props){let e=this[t];if(e.$ModelInfo)return e.$ModelInfo}return null}},app.modules["std:http"]=function(){const t=require("std:eventBus"),e=require("std:url");return{get:function(t,e){return i("GET",t,null,e)},post:function(t,e,s,n){return i("POST",t,e,s,n)},load:function(s,n,r){if(n){let t=n.firstElementChild;if(t&&t.__vue__){let e=t.__vue__;e.$destroy(),e.$el.remove(),e.$el=null,t.__vue__=null}n.innerHTML=""}return new Promise((function(o,a){t.$emit("beginLoad"),i("GET",s).then((function(i){if(i.startsWith("<!DOCTYPE"))return void window.location.assign("/");let a=(new DOMParser).parseFromString(i,"text/html"),l=a.body.firstElementChild,d=l.id||null;if(n.innerHTML=l?l.outerHTML:"",d&&!document.getElementById(d))return n.innerHTML="",void o(!1);for(let t=0;t<a.scripts.length;t++){let e=a.scripts[t];if("text/javascript"===e.type){let t=document.createElement("script");e.src?t.src=e.src:t.text=e.text,document.body.appendChild(t).parentNode.removeChild(t)}}if(n.firstElementChild&&n.firstElementChild.__vue__){let i=n.firstElementChild,o=i.__vue__;if(o.$data.__baseUrl__=r||e.normalizeRoot(s),o.$data.__baseQuery__=e.parseUrlAndQuery(s).query,i.classList.contains("modal")){let e=i.getAttribute("data-controller-attr");e&&t.$emit("modalSetAttribites",e,o)}}a.body.remove(),o(!0),t.$emit("endLoad")})).catch((function(e){a(e),t.$emit("endLoad")}))}))},upload:function(e,i){return new Promise((function(s,n){let r=new XMLHttpRequest;r.onload=function(i){if(t.$emit("endRequest",e),200===r.status){let t=r.responseText?JSON.parse(r.responseText):"";s(t)}else 255===r.status&&n(r.responseText||r.statusText)},r.onerror=function(t){alert("Error")},r.open("POST",e,!0),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("Accept","application/json"),t.$emit("beginRequest",e),r.send(i)}))},localpost:function(t,e){return new Promise((function(i,s){let n=new XMLHttpRequest;n.onload=function(t){if(200===n.status){let t=n.getResponseHeader("content-type"),e=n.responseText;-1!==t.indexOf("application/json")&&(e=JSON.parse(n.responseText)),i(e)}else 255===n.status?s(n.responseText||n.statusText):s(n.statusText)},n.onerror=function(t){s(t)};let r="http://127.0.0.1:64031/"+t;n.open("POST",r,!0),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.setRequestHeader("Accept","text/plain"),n.setRequestHeader("Content-Type","text/plain"),n.send(e)}))}};function i(e,i,s,n,r){return new Promise((function(o,a){let l=new XMLHttpRequest;l.onload=function(e){if(r||t.$emit("endRequest",i),200===l.status){if(n)return void o(l.response);let t=l.getResponseHeader("content-type")||"",e=l.responseText;t&&-1!==t.indexOf("application/json")&&(e=l.responseText?JSON.parse(l.responseText):""),o(e)}else 255===l.status?n?l.response instanceof Blob?function(t,e){const i=new FileReader;i.addEventListener("loadend",t=>{const s=i.result;e(s)}),i.readAsText(t)}(l.response,t=>a("server error: "+t)):a(l.statusText):a(l.responseText||l.statusText):473===l.status?"Unauthorized"===l.statusText&&window.location.assign("/"):a(l.statusText)},l.onerror=function(e){r||t.$emit("endRequest",i),a(l.statusText)},l.open(e,i,!0),l.setRequestHeader("X-Requested-With","XMLHttpRequest"),l.setRequestHeader("Accept","application/json, text/html"),n&&(l.responseType="blob"),r||t.$emit("beginRequest",i),l.send(s)}))}},function(){const t=require("std:eventBus"),e=require("std:url"),i={};function s(t){t.title&&(document.title=t.title,i[t.url]=t.title)}function n(){let t=window.location.pathname;return e.normalizeRoot(t)}const r=new Vuex.Store({strict:!0,state:{route:n(),query:e.parseQueryString(window.location.search)},getters:{seg0:t=>t.route.split("/")[1],seg1:t=>t.route.split("/")[2],len:t=>t.route.split("/").length,url:t=>t.route,query:t=>t.query,route:t=>{let e=t.route.split("/");return{len:e.length,seg0:e[1],seg1:e[2]}},baseUrl:t=>t.route+e.makeQueryString(t.query),search:t=>e.makeQueryString(t.query)},mutations:{navigate:function(t,i){let n=window.$$rootUrl,r=n+t.route+e.makeQueryString(t.query);t.route=i.url.toLowerCase(),t.query=Object.assign({},i.query);let o=n+t.route+e.makeQueryString(i.query),a=window.history;s(i),a.replaceState(r,null,r),a.pushState(r,null,o)},query:function(t,i){let s=window.$$rootUrl;t.query=Object.assign({},i);let n=s+t.route+e.makeQueryString(t.query);window.history.replaceState(null,null,n)},setquery:function(e,i){let s=window.$$rootUrl,n=s+this.getters.baseUrl;e.query=Object.assign({},e.query,i);let r=s+this.getters.baseUrl;r!==n&&(window.history.replaceState(null,null,r),t.$emit("queryChange",e.query))},popstate:function(t){t.route=n(),t.query=e.parseQueryString(window.location.search),t.route in i&&(document.title=i[t.route])},setstate:function(t,i){window.history.replaceState(null,null,window.$$rootUrl+i.url),t.route=n(),t.query=e.parseQueryString(window.location.search),s(i)},setnewid:function(t,i){let s=window.$$rootUrl,n=t.route,r=e.replaceSegment(n,i.id,i.action);t.route=r;let o=s+r+e.makeQueryString(t.query);window.history.replaceState(null,null,o)},close:function(t){function e(){window.close()}if(window.history.length>1){let t=window.location.pathname;window.history.back(),setTimeout(()=>{window.location.pathname===t&&e()},300)}else e()}}});function o(t,e){return t.split("?")[0]+(e||"")}r.parseQueryString=e.parseQueryString,r.makeQueryString=e.makeQueryString,r.replaceUrlSearch=o,r.replaceUrlQuery=function(t,i){return o(t,e.makeQueryString(i))},r.makeBackUrl=function(t){let e=t.split("/");return 5===e.length?e.slice(0,3).join("/"):4===t.length?e.slice(0,2).join("/"):t},app.components["std:store"]=r}(),app.modules["std:log"]=function(){let t=!1,e=!1;return{info:function(e){if(!t)return;console.info(e)},warn:function(e){if(!t)return;console.warn(e)},error:function(t){console.error(t)},time:function(e,i,s){if(!t&&!s)return;console.warn(e+" "+(performance.now()-i).toFixed(2)+" ms")},traceEnabled:function(){return e||function(){let i=window.sessionStorage.getItem("traceEnabled");null!==i&&(t="true"===i,t&&console.warn("tracing is enabled"));e=!0}(),t},enableTrace:function(e){if(window.$$debug){t=e,console.warn("tracing is "+(t?"enabled":"disabled"));try{window.sessionStorage.setItem("traceEnabled",e)}catch(t){}}}}},app.modules["std:console"]=function(){return{log(){window.$$debug&&console.log(...arguments)},dir(){window.$$debug&&console.dir(...arguments)},info(){window.$$debug&&console.info(...arguments)},error(){window.$$debug&&console.error(...arguments)},warn(){window.$$debug&&console.warn(...arguments)}}},app.modules["std:validators"]=function(){const t=require("std:utils"),e=require("std:eventBus"),i=/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i,s=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:/?#]+|\[[a-f\d:]+\])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i;let n=new WeakMap;return{validate:function(i,s,a,l){let d=[];t.isArray(i)?d=i:t.isObject(i)||t.isFunction(i)?d.push(i):t.isString(i)&&d.push({valid:"notBlank",msg:i});return function(i,s,a,l){let d=[];return d.pending=0,i.forEach((function(i){const c=i.severity||"error";if(!t.isFunction(i.applyIf)||i.applyIf(s,a))if(t.isString(i))r({valid:"notBlank"},a)||d.push({msg:i,severity:"error"});else if(t.isFunction(i)){let e=i(s,a);t.isString(e)&&e?d.push({msg:e,severity:c}):t.isObject(e)&&d.push({msg:e.msg,severity:e.severity||c})}else if(t.isString(i.valid))r(i,a)||d.push({msg:i.msg,severity:c});else if(t.isFunction(i.valid)){if(i.async){if(!n.has(i))return void o(i,s,a);{let e=n.get(i);if(!e.has(s))return void o(i,s,a);{let i=e.get(s);if(i.val===function(e){if(t.isObjectExact(e)&&"$id"in e)return e.$id;return e}(a))return void(i.result&&d.push(i.result))}}}let r=i.valid(s,a);if(r&&r.then){if(d.pending+=1,!i.async)return void console.error("Async rules should be marked async:true");let n=o(i,s,a);r.then(r=>{let o={severity:c,msg:i.msg},a=!1;t.isString(r)?(o.msg=r,n.result=o,d.push(o),a=!0):r||(d.push(o),n.result=o,a=!0),s._root_._needValidate_=!0,a&&l&&l(),d.pending-=1,e.$emit("pendingValidate")})}else t.isString(r)?d.push({msg:r,severity:c}):t.isObjectExact(r)?d.push({msg:r.msg,severity:r.severity}):r||d.push({msg:i.msg,severity:c})}else console.error("invalid valid element type for rule")})),d}(d,s,a,l)},removeWeak:function(){n=new WeakMap}};function r(e,n){switch(e.valid){case"notBlank":return t.notBlank(n);case"email":return""===n||i.test(n);case"url":return""===n||s.test(n);case"isTrue":return!0===n;case"regExp":return e.regExp instanceof RegExp?""===n||e.regExp.test(n):(console.error("rule.regExp is undefined or is not an regular expression"),!1)}return console.error(`invalid std rule: '${e}'`),!0}function o(e,i,s){let r;n.has(e)?r=n.get(e):(r=new WeakMap,n.set(e,r)),t.isObjectExact(s)&&"$id"in s&&(s=s.$id);let o={val:s,result:null};return r.set(i,o),o}},app.modules["std:impl:array"]=function(){const t=require("std:utils");return{defineArray:function(i){i.$lock=!1,i.$lockUpdate=function(t){this.$lock=t},i.$new=function(t){let e=new this._elem_(t||null,this._path_+"[]",this);return e.__checked=!1,e},i.$sum=function(t){return this.reduce((e,i)=>e+t(i),0)},i.$find=function(t,e){for(let i=0;i<this.length;i++){let s=this[i];if(t.call(e,s,i,this))return s;if("$items"in s){let i=s.$items.$find(t,e);if(i)return i}}return null},i.$sort=function(t){return this.sort(t),this.$renumberRows(),this},i.$copy=function(e){if(this.$root.isReadOnly)return this;if(this.$empty(),t.isArray(e))for(let t=0;t<e.length;t++)this.push(this.$new(e[t]));return this.$renumberRows(),this},i.$select=function(t){t.$select()},i.$clearSelected=function(){let t=this.$selected;return t?(t.$selected=!1,e(this,null),this):this},function(i){i.$empty=function(){return this.$root.isReadOnly||(this.splice(0,this.length),"$RowCount"in this&&(this.$RowCount=0)),this},i.$append=function(t){return this.$insert(t,"end")},i.$prepend=function(t){return this.$insert(t,"start")},i.$insert=function(i,s,n){const r=this;function o(t,i){let o=r._path_+"[].adding",a=r.$new(t);if(!1===r._root_.$emit(o,r,a))return null;let l,d=r.length,c=null;switch(s){case"end":d=r.push(a),c=r[d-1];break;case"start":r.unshift(a),c=r[0],d=1;break;case"above":l=r.indexOf(n),r.splice(l,0,a),c=r[l],d=l+1;break;case"below":l=r.indexOf(n)+1,r.splice(l,0,a),c=r[l],d=l+1}"$RowCount"in r&&(r.$RowCount+=1);let u=r._path_+"[].add";if(r._root_.$setDirty(!0),r._root_.$emit(u,r,c,d-1),i&&(c.$select(),e(r,c)),"$rowNo"in a._meta_){let t=a._meta_.$rowNo;for(let e=0;e<r.length;e++)r[e][t]=e+1}if(r.$parent){let t=r.$parent._meta_;t.$hasChildren&&r._path_.endsWith("."+t.$items)&&(r.$parent[t.$hasChildren]=!0)}return c}if(t.isArray(i)){let t=[],e=null;return i.forEach((function(i){e=o(i,!1),t.push(e)})),e&&e.$select(),t}return o(i,!0)},i.$renumberRows=function(){if(!this.length)return this;let t=this[0];if("$rowNo"in t._meta_){let e=t._meta_.$rowNo;for(let t=0;t<this.length;t++)this[t][e]=t+1}return this},i.$remove=function(t){if(this.$root.isReadOnly)return this;if(!t)return this;let e=this.indexOf(t);if(-1===e)return this;this.splice(e,1),"$RowCount"in this&&(this.$RowCount-=1);let i=this._path_+"[].remove";if(this._root_.$setDirty(!0),this._root_.$emit(i,this,t,e),!this.length){if(this.$parent){let t=this.$parent._meta_;t.$hasChildren&&this._path_.endsWith("."+t.$items)&&(this.$parent[t.$hasChildren]=!1),t.$items&&this.$parent.$select()}return this}return e>=this.length&&(e-=1),this.$renumberRows(),this.length>e&&this[e].$select(),this}}(i)},defineArrayItemProto:function(t){let i=t.prototype;i.$remove=function(){this._parent_.$remove(this)},i.$select=function(t){let i=t||this._parent_,s=i.$selected;if(s!==this&&(s&&(s.$selected=!1),this.$selected=!0,e(i,this),this._meta_.$items)){let t=this._parent_._parent_;for(;t&&t&&t!==this.$root;)t.$expanded=!0,t=t._parent_._parent_}}}};function e(t,e){let i=t._path_+"[].select";t._root_.$emit(i,t,e)}},function(){const t=require("std:platform"),e=require("std:validators"),i=require("std:utils"),s=require("std:log",!0),n=require("std:period"),r=require("std:modelInfo"),o=require("std:impl:array");let a=!1;function l(t){s&&s.info(t)}function d(t,e){s&&s.time(t,e)}function c(t,e,i,s){Object.defineProperty(t,e,{writable:s||!1,enumerable:!1,configurable:!1,value:i})}function u(t,e,i){Object.defineProperty(t,e,{enumerable:!1,configurable:!1,get:i})}function h(t,e,i){Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:i})}function p(t){if(!t)return"";let e=t.lastIndexOf(".");return t.substring(e+1)}function m(e,s,r,o){let a=e._meta_.props[r];a.type&&(a=a.type);let l=e._path_?e._path_+".":"",d=e._src_;if(s=s||{},i.isObjectExact(a)){if(!("type"in a))throw new Error(`Invalid _meta_ for '${r}'`);a=a.type}switch(a){case Number:d[r]=s[r]||0;break;case String:d[r]=s[r]||"";break;case Boolean:d[r]=s[r]||!1;break;case Date:let o=s[r]||null;d[r]=o?new Date(o):i.date.zero();break;case t.File:case Object:d[r]=null;break;case f:let c=e._meta_.markerProps[r];d[r]=c;break;case n.constructor:d[r]=new a(s[r]);break;default:d[r]=new a(s[r]||null,l+r,e)}Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get(){return this._src_[r]},set(t){let e=!1,s=r.startsWith("$$"),n=this._meta_.props[r],o=!1;if(n.type&&(o=!!n.json,n=n.type),o||(t=function(t,e){return i.isDefined(e)||(e=i.defaultValue(t)),t===Number?i.toNumber(e):t===String?i.toString(e):t!==Date||i.isDate(e)?e:i.date.parse(""+e)}(n,t)),t===this._src_[r])return;let a=this._src_[r];if(!this._lockEvents_){let e=(this._path_||"Root")+"."+r+".changing";if(!1===this._root_.$emit(e,this,t,a,r))return}if(this._src_[r]&&this._src_[r].$set?(this._src_[r].$set(t),e=!0):this._src_[r]=t,s||this._root_.$setDirty(!0,this._path_,r),this._lockEvents_)return;if(e)return;let l=(this._path_||"Root")+"."+r+".change";this._root_.$emit(l,this,t,a,r)}})}function f(){}function g(t,e){let s=t._root_.$template;if(!s)return;let n=s._props_;if(!n)return;let r=e.name;if(r in n)for(let e in n[r]){let s=n[r][e];i.isPrimitiveCtor(s)||(i.isFunction(s)?(l(`create property: ${r}.${e}`),Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s})):i.isObjectExact(s)?s.get&&(l(`create property: ${r}.${e}`),Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s.get,set:s.set})):alert("todo: invalid property type"))}}function v(t){if(Object.seal(t),t._meta_)for(let e in t._meta_.props){let s=t._meta_.props[e];if(s.type&&(s=s.type),i.isPrimitiveCtor(s))continue;if(s===n.constructor)continue;let r=t[e];i.isArray(r)?r.forEach(t=>v(t)):i.isObjectExact(r)&&v(r)}}function b(){if("__modelInfo"in this){let t=this.__modelInfo;if(i.isDefined(t.ReadOnly)&&t.ReadOnly)return!0;if(i.isDefined(t.StateReadOnly)&&t.StateReadOnly)return!0}return!1}function _(){if("__modelInfo"in this){let t=this.__modelInfo;if(i.isDefined(t.StateReadOnly)&&t.StateReadOnly)return!0}return!1}function y(){if("$main"in this._meta_){return this[this._meta_.$main]}return null}function w(){if("__modelInfo"in this){let t=this.__modelInfo;if(i.isDefined(t.Copy))return t.Copy}return!1}function x(e){let i=new Array(e||0);return function(e){k(e),o.defineArray(e),h(e,"$selected",(function(){for(let t of this.$elements)if(t.$selected)return t})),h(e,"$selectedIndex",(function(){for(let t=0;t<this.length;t++)if(this[t].$selected)return t;return-1})),h(e,"$elements",(function(){return function*t(e){for(let i=0;i<e.length;i++){let s=e[i];yield s,s.$items&&(yield*t(s.$items))}}(this)})),h(e,"Count",(function(){return this.length})),h(e,"$isEmpty",(function(){return!this.length})),h(e,"$checked",(function(){return this.filter(t=>t.$checked)})),h(e,"$hasSelected",(function(){return!!this.$selected})),e.Selected=function(t){let e=this.$selected;return e?e[t]:null},e.$isLazy=function(){const t=this.$parent._meta_;if(!t.$lazy)return!1;let e=p(this._path_);return-1!==t.$lazy.indexOf(e)},e.$load=function(){this.$isLazy()&&t.defer(()=>this.$loadLazy())},e.$resetLazy=function(){return this.$lock=!1,this.$empty(),this.$loaded&&(this.$loaded=!1),this},e.$loadLazy=function(){if(this.$isLazy()&&!this.$lock)return new Promise((t,e)=>{if(!this.$vm)return;if(this.$loaded)return void t(this);if(!this.$parent)return void t(this);const i=this.$parent._meta_;if(!i.$lazy)return void t(this);let s=p(this._path_);-1!==i.$lazy.indexOf(s)?this.$vm.$loadLazy(this.$parent,s).then(()=>t(this)):t(this)})},e.$reload=function(){return this.$lock=!1,this.$vm.$reload(this)},e.__fireChange__=function(t){let e=this.$root,i=this;"selected"===t&&(i=this.$selected),e.$emit(this._path_+"[].change",this,i)}}(i),i}function k(t){u(t,"$host",(function(){return this._root_._host_})),u(t,"$root",(function(){return this._root_})),u(t,"$parent",(function(){return this._parent_})),u(t,"$vm",(function(){return this._root_&&this._root_._host_?this._root_._host_.$viewModel:null})),u(t,"$ctrl",(function(){return this._root_&&this._root_._host_?this._root_._host_.$ctrl:null})),u(t,"$ready",(function(){return!this.$vm||!this.$vm.$isLoading})),t.$isValid=function(t){return!0}}function S(t,...e){this._enableValidate_&&(this._needValidate_||(this._needValidate_=!0)),l("emit: "+t);let i=this.$template;if(!i)return;let s=i.events;if(s&&t in s){l("handle: "+t);let i=s[t].call(this,...e);return!1===i&&l(t+" returns false"),i}}function C(t){let e=this.$template;return e&&e.delegates?t in e.delegates?e.delegates[t].bind(this.$root):void console.error(`Delegate "${t}" not found in the template`):(console.error("There are no delegates in the template"),null)}function D(t,e,s){const n=this.$template;if(!n)return!1;if(!n.commands)return!1;const r=n.commands[t];if(!r)return!1;const o=s&&!0===s.validRequired,a=s&&!0===s.checkReadOnly;return!(s&&!0===s.checkArgument&&!e)&&((!0!==r.checkReadOnly&&!a||!this.$root.$readOnly)&&(!((!0===r.validRequired||o)&&!this.$root.$valid)&&(i.isFunction(r.canExec)?r.canExec.call(this,e):i.isBoolean(r.canExec)?r.canExec:!i.isDefined(r.canExec)||(console.error(t+".canExec should be a function"),!1))))}function I(t,e,s,n){try{this._root_._enableValidate_=!1;let r=this.$vm;const o=this.$template;if(!o)return;if(!o.commands)return;let a=o.commands[t];if(!a)return void console.error(`Command "${t}" not found`);const l=a.confirm||s,d=a.saveRequired||n&&n.saveRequired;if((a.validRequired||n&&n.validRequired)&&!r.$data.$valid)return;if(i.isFunction(a.canExec)&&!a.canExec.call(this,e))return;let c=this;const u=function(){const s=function(){return i.isFunction(a)?a.call(c,e):i.isFunction(a.exec)?a.exec.call(c,e):void console.error($`There is no method 'exec' in command '${t}'`)};if(!l)return s();r.$confirm(l).then(s)};if(!d||!r.$isDirty)return u();r.$save().then(u)}finally{this._root_._enableValidate_=!0,this._root_._needValidate_=!0}}function T(t,e,s){if(t._errors_||s)return!t._errors_&&s&&(t._errors_={}),s&&s.length>0?t._errors_[e]=s:e in t._errors_&&delete t._errors_[e],i.isEmptyObject(t._errors_)&&(t._errors_=null),s}function O(t,i,s,n){if(!t._root_._needValidate_)return t._errors_&&i in t._errors_?t._errors_[i]:null;return T(t,i,function(t,i,s,n){if(!t)return null;let r=t._root_.$template;if(!r)return null;var o=r.validators;if(!o)return null;var a=o[i];return a?e.validate(a,t,s,n):null}(t,i,s,n))}function*F(t,e,i,s){if(s=s||"",!e)return void(yield{item:t,val:t[i],ix:s});let n=e.split("."),r=t;for(let t=0;t<n.length;t++){let e=t===n.length-1,o=n[t];if(o.endsWith("[]")){let a=o.substring(0,o.length-2);a in r||console.error(`Invalid validator key. Property '${a}' not found in '${r.constructor.name}'`);let l=r[a];if(!l)continue;for(let r=0;r<l.length;r++){let o=l[r];if(e)yield{item:o,val:o[i],ix:s+":"+r};else{let e=n.slice(t+1).join(".");yield*F(o,e,i,s+":"+r)}}return}{o in r||console.error(`Invalid Validator key. property '${o}' not found in '${r.constructor.name}'`);let t=r[o];if(e)return void(t&&(yield{item:t,val:t[i],ix:s}));r=t}}}function M(t,i,s){if(!s)return;let n=[];for(let r of function*(t,e){let i=e.lastIndexOf("."),s="",n=e;-1!==i&&(s=e.substring(0,i),n=e.substring(i+1)),yield*F(t,s,n,"")}(t,i)){let t=e.validate(s,r.item,r.val);T(r.item,i,t),t&&t.length&&n.push(...t)}return n.length?n:null}function q(){this._needValidate_=!0;var t=this._validateAll_(!1);return this._validateAll_(!0),t}function U(i){var s=this;if(!s._host_)return;if(!s._needValidate_)return;s._needValidate_=!1,i&&e.removeWeak();var n=t.performance.now();let r=s.$template;if(!r)return;let o=r.validators;if(!o)return;let a=[];for(var l in o){let t=M(s,l,o[l]);t&&a.push({x:l,e:t})}return d("validation time:",n),a}function P(t,e,s){this.$root.$readOnly||e&&e.toLowerCase().startsWith("query")||function(t){let e=t.$template,i=e&&e.options;return i&&i.noDirty}(this.$root)||e&&s&&function(t,e){let s=t.$template;const n=s&&s.options;if(!n)return!1;const r=n.skipDirty;return!(!r||!i.isArray(r))&&-1!==r.indexOf(e)}(this.$root,`${e}.${s}`)||(this.$dirty=t)}function E(){return this.$set({}),this}function V(t){this.$root.isReadOnly||this.$merge(t)}function N(t){let e=this._meta_.props;if(!e)return;let s=e[t];return i.isObjectExact(s)?s.len:void 0}function L(t,e){let i=t.$template,s=i&&i.options,n=s&&s.bindOnce;return!!n&&-1!==n.indexOf(e)}function A(){let t=this,e=t.$template,s=e&&e.options;if(!s)return;let n=s.persistSelect;if(!n||!n.length)return;let r={};for(let e of n){let s=i.simpleEval(t,e);if("$selected"in s){let t=s.$selected;t&&(r[e]=t.$id)}}return r}function B(t){if(!t)return;let e=this;for(let s in t){let n=i.simpleEval(e,s),r=t[s];if("$find"in n){let t=n.$find(t=>t.$id===r);t&&t.$select()}}}function R(e,s,n){let r=this.$id__;try{for(var o in null===e&&(e={}),this._root_._enableValidate_=!1,this._lockEvents_+=1,this._meta_.props){if(o.startsWith("$$"))continue;if(s&&L(this._root_,o))continue;let r=this._meta_.props[o];r.type&&(r=r.type);let a=this[o];if(Array.isArray(a)){if(a.$loaded&&(a.$loaded=!1),a.$copy(e[o]),"$RowCount"in a){let t=o+".$RowCount";a.$RowCount=t in e&&e[t]||0}}else if(i.isDateCtor(r)){e[o]?t.set(this,o,new Date(e[o])):t.set(this,o,i.date.zero())}else if(i.isPrimitiveCtor(r))t.set(this,o,e[o]);else{if(n&&!(o in e))continue;let i=new r(e[o],o,this);t.set(this,o,i)}}}finally{this._root_._enableValidate_=!0,this._root_._needValidate_=!0,this._lockEvents_-=1}if(this.$parent._lockEvents_)return this;let a=this.$id__,l=!1;if(i.isDefined(a)&&i.isDefined(r)&&(l=a!==r),l){let t=this._path_+".change";this._root_.$emit(t,this.$parent,this,this,p(this._path_))}return this}function j(t){if(t&&t.$cross)for(let e in this){if(e.startsWith("$")||e.startsWith("_"))continue;let i=this[e];if(i._elem_&&i.$cross)for(let e in t.$cross){if(i._elem_.name!=e)continue;let s=i.$cross,n=t.$cross[e];for(let t in s){let e=s[t],i=n[t];e&&i?e.splice(0,e.length,...i):e&&!i&&e.splice(0,e.length)}}}}function H(){this._host_.$viewModel=null,this._host_=null}app.modules["std:datamodel"]={createObject:function(e,s,n,o){const $=e.constructor.name;let x=null;"TRoot"===$&&(x=t.performance.now()),o=o||e,c(e,"_src_",{}),c(e,"_path_",n||""),c(e,"_root_",o._root_||o),c(e,"_parent_",o),c(e,"_errors_",null,!0),c(e,"_lockEvents_",0,!0),e._uiprops_={};let k=!1;const S=e._root_.$template;S&&!i.isEmptyObject(S._props_)&&(k=!0),k&&function(t,e){const s=t._root_.$template;if(!s)return;const n=s._props_;if(!n)return;let r=e.name;if(r in n)for(let e in n[r]){let s=n[r][e];i.isPrimitiveCtor(s)?(l(`create scalar property: ${r}.${e}`),t._meta_.props[e]=s):i.isObjectExact(s)&&(s.get||(l(`create object property: ${r}.${e}`),t._meta_.props[e]=f,t._meta_.markerProps||(t._meta_.markerProps={}),t._meta_.markerProps[e]=s))}}(e,e.constructor);for(let t in e._meta_.props)m(e,s,t);k&&g(e,e.constructor),n&&n.endsWith("]")&&(e.$selected=!1),e._meta_.$items&&(e.$expanded=!1,e.$collapsed=!1,e.$level=0,function(t){t.$expand=function(){if(!this._meta_.$items)return null;if(this.$expanded)return null;this[this._meta_.$items];return this.$vm.$expand(this,this._meta_.$items,!0)},t.$selectPath=async function(t,e){if(!t.length)return null;let i=this._meta_.$items;if(!i)return null;let s=null;e(this,t[0])&&(s=this);for(let n=1;n<t.length;n++){if(!s)return null;await s.$expand(),s=s[i].$find(i=>e(i,t[n]))}return s}}(e)),e.$lockEvents=function(){this._lockEvents_+=1},e.$unlockEvents=function(){this._lockEvents_-=1},u(e,"$eventsLocked",(function(){return this._lockEvents_>0})),h(e,"$valid",(function(){if(this._root_._needValidate_&&this._root_._validateAll_(),this._errors_)return!1;for(var t in this){if("$"===t[0]||"_"===t[0])continue;let e=this[t];if(i.isArray(e))for(let t=0;t<e.length;t++){let s=e[t];if(i.isObject(s)&&"$valid"in s&&!s.$valid)return!1}else if(i.isObject(e)&&"$valid"in e&&!e.$valid)return!1}return!0})),h(e,"$invalid",(function(){return!this.$valid})),e.$errors=function(t){if(!this)return null;let e=this._root_;if(!e)return null;if(!e._validate_)return null;let i=`${this._path_}.${t}`,s=e._validate_(this,i,this[t]);return s&&0===s.length?null:s},!0===e._meta_.$group&&h(e,"$groupName",(function(){if(!i.isDefined(this.$level))return"#err#";const t=this._root_.__modelInfo.Levels;if(t){const e=t[this.constructor.name];if(e&&this.$level<=e.length)return this[e[this.$level-1]]}return console.error("invalid data for $groupName"),"#err#"})),e._meta_.$itemType&&(e.$setProperty=function(i,s){let r=n+"."+i,o=new e._meta_.$itemType(s,r,e);return t.set(this,i,o),this._root_.$setDirty(!0),o});let C=$+".construct",D=null,I=n?p(n):"";if(e._root_.$emit(C,e,I),e._root_===e){for(var T in e._root_ctor_=e.constructor,e.$dirty=!1,e._query_={},e._meta_.props){let t=T+".$RowCount";if(s&&t in s){let i=s[t]||0;e[T].$RowCount=i}}r.setModelInfoForRoot(e),e._setRuntimeInfo_=j,e._saveSelections=A,e._restoreSelections=B,e._enableValidate_=!0,e._needValidate_=!1,e._modelLoad_=s=>{D=s,function(e){if(e.$template&&e.$template.defaults)for(let s in e.$template.defaults){let n=s.lastIndexOf(".");if(-1===n)continue;let r=s.substring(0,n),o=s.substring(n+1);if(o.endsWith("[]"))continue;let a=e.$template.defaults[s],l=i.simpleEval(e,r);l.$isNew&&(i.isFunction(a)?t.set(l,o,a.call(e,l,o)):t.set(l,o,a))}}(e),e._fireLoad_(),a=!0},e._fireLoad_=()=>{t.defer(()=>{let t=e.$vm.__isModalRequery();e.$emit("Model.load",e,D,t),e._root_.$setDirty(!!e._root_.$isCopy)})},e._fireUnload_=()=>{e.$emit("Model.unload",e)},u(e,"$readOnly",b),u(e,"$stateReadOnly",_),u(e,"$isCopy",w),u(e,"$mainObject",y),e._seal_=v,e._fireGlobalPeriodChanged_=t=>{e.$emit("GlobalPeriod.change",e,t)}}return x&&d("create root time:",x),e},createArray:function(t,e,i,s,n){let r=new x(t?t.length:0),o=e+"[]";c(r,"_elem_",i),c(r,"_path_",e),c(r,"_parent_",n),c(r,"_root_",n._root_||n),h(r,"$valid",(function(){if(this._errors_)return!1;for(var t of this)if(t._errors_)return!1;return!0})),h(r,"$invalid",(function(){return!this.$valid})),i.prototype._meta_.$cross&&h(r,"$cross",(function(){return i.prototype._meta_.$cross})),g(r,s);let a=s.name+".construct";if(r._root_.$emit(a,r),!t)return r;for(let e=0;e<t.length;e++)r[e]=new r._elem_(t[e],o,r),r[e].__checked=!1;return r},defineObject:function(t,e,s){var n;c(t.prototype,"_meta_",e),t.prototype.$merge=R,t.prototype.$empty=E,t.prototype.$set=V,t.prototype.$maxLength=N,k(t.prototype),u(t.prototype,"$isNew",(function(){return!this.$id})),u(t.prototype,"$isEmpty",(function(){return!this.$id})),u(t.prototype,"$id",(function(){let t=this._meta_.$id;if(!t){let t=this.constructor.name;throw new Error(t+" object does not have an Id property")}return this[t]})),u(t.prototype,"$id__",(function(){let t=this._meta_.$id;if(t)return this[t]})),u(t.prototype,"$name",(function(){let t=this._meta_.$name;if(!t){let t=this.constructor.name;throw new Error(t+" object does not have a Name property")}return this[t]})),s&&(n=t,o.defineArrayItemProto(n),Object.defineProperty(n.prototype,"$checked",{enumerable:!0,configurable:!0,get(){return this.__checked},set(t){this.__checked=t;let e=this.$parent,i=e._path_+"[].check";e._root_.$emit(i,e,this)}})),e.$hasChildren&&u(t.prototype,"$hasChildren",(function(){let t=this._meta_.$hasChildren;if(t)return this[t]})),e.$items&&u(t.prototype,"$items",(function(){let t=this._meta_.$items;if(t)return this[t]})),e.$permissions&&u(t.prototype,"$permissions",(function(){let t=this._meta_.$permissions;if(t){var e=this[t];if(this.$isNew&&0===e){let t=this.$ModelInfo;t&&i.isDefined(t.Permissions)&&(e=t.Permissions)}return Object.freeze({canView:!!(1&e),canEdit:!!(2&e),canDelete:!!(4&e),canApply:!!(8&e),canUnapply:!!(16&e)})}}))},implementRoot:function(e,i,s){if(e.prototype.$emit=S,e.prototype.$setDirty=P,e.prototype.$defer=t.defer,e.prototype.$merge=R,e.prototype.$template=i,e.prototype._exec_=I,e.prototype._canExec_=D,e.prototype._delegate_=C,e.prototype._validate_=O,e.prototype._validateAll_=U,e.prototype.$forceValidate=q,e.prototype.$destroy=H,!i)return;let n={};for(let t in i.properties){let e=t.split(".");if(2!==e.length){console.error(`invalid propery name '${t}'`);continue}let s=e[0],r=e[1],o=i.properties[t];s in n||(n[s]={}),n[s][r]=o}i._props_=n},setModelInfo:r.setModelInfo,enumData:F}}(),function(){let t=require("std:http");app.modules["std:dataservice"]={post:function(e,i,s){return t.post(e,i,s)},get:function(e){return t.get(e)}}}(),app.modules["std:popup"]=function(){const t=[];let e=!1;const i="Perhaps you forgot to create a _close function for popup element";return{startService:function(){if(e)return;e=!0,document.body.addEventListener("click",n),document.body.addEventListener("contextmenu",n),document.body.addEventListener("keydown",r)},registerPopup:function(e){t.push(e)},unregisterPopup:function(e){let i=t.indexOf(e);-1!==i&&t.splice(i,1);delete e._close},closeAll:function(){t.forEach(t=>{t._close&&t._close(document)})},closest:s,closeInside:function(t){if(!t)return;let e=t.querySelectorAll(".popover-wrapper");for(let t=0;t<e.length;t++){let i=e[t];i._close&&i._close()}}};function s(t,e){return t?t.closest(e):null}function n(e){if(0!==t.length)for(let n=0;n<t.length;n++){let r=t[n];if(s(e.target,".dropdown-item")||e.target.hasAttribute("close-dropdown")||s(e.target,"[dropdown-top]")!==r){if(!r._close)throw new Error(i);r._close(e.target)}}}function r(e){if(27===e.which)for(let s=0;s<t.length;s++){let n=t[s];if(!n._close)throw new Error(i);n._close(e.target)}}},app.modules["std:mask"]=function(){return{getMasked:i,getUnmasked:function(i,s){let n="";for(let r=0;r<i.length;r++){let o=i[r],a=s[r];if(!e(o))if(t(o)){if(!a||"_"===a)return"";n+=a}else n+=o}return n},mountElement:s,unmountElement:n,setMask:function(t,e){if(!t)return;e?t.__opts?(t.__opts.mask=e,t.value=i(e,"")):(s(t,e),t.value=i(e,"")):(n(t,e),t.value="")}};function t(t){return"#"===t||"@"===t}function e(t){return-1!=="- ()".indexOf(t)}function i(e,i){let s="",n=0;for(let r=0;r<e.length;r++){let o=e[r],a=i[n];o===a?(s+=a,n++):t(o)?(s+=a||"_",n++):s+=o}return s}function s(t,e){t&&(t.__opts={mask:e},t.addEventListener("keydown",c,!1),t.addEventListener("blur",u,!1),t.addEventListener("focus",h,!1),t.addEventListener("paste",p,!1))}function n(t,e){t&&(delete t.__opts,t.removeEventListener("keydown",c),t.removeEventListener("blur",u),t.removeEventListener("focus",h),t.removeEventListener("paste",p))}function r(t){return t&&void 0!==t.selectionStart?(t.selectionStart!==t.selectionEnd&&t.setSelectionRange(t.selectionStart,t.selectionStart),t.selectionStart):0}function o(e,i,s){if(i>=e.length)return i+1;if(t(e[i]))return i;if("r"===s){for(let s=i+1;s<e.length;s++)if(t(e[s]))return s;return e.length+1}if("l"===s){for(let s=i-1;s>=0;s--)if(t(e[s]))return s;return o(e,0,"r")}throw new Error(`mask.fitCaret. Invalid fit value '${s}'`)}function a(t,e,i){if(t&&0!==t.offsetWidth&&0!==t.offsetHeight&&t.setSelectionRange){e=o(t.__opts.mask,e,i),t.setSelectionRange(e,e)}}function l(t,e,i,s){if(t.setRangeText)return void t.setRangeText(e,i,s);let n=t.value,r=n.substring(0,i);r+=e,r+=n.substring(s),t.value=r}function d(t,e){let i=r(t),s=t.__opts.mask;if(i=o(s,i,"r"),function(t,e){return"#"===t&&(e>="0"&&e<="9"||"_"===e)}(s[i],e)){l(t,e,i,i+1);let n=o(s,i+1,"r");t.setSelectionRange(n,n)}}function c(t){if(function(t,e){if(t.which>=112&&t.which<=123)return!0;if(16===t.which||17===t.which)return!0;if(t.which>=112&&t.which<=123)return!0;if(9===t.which)return!0;if(13===t.which)return m(e),setTimeout(()=>{let t="l";e.value||(e.value=i(e.__opts.mask,""),t="r"),a(e,"r"===t?0:32768,t)},10),!0;if(t.ctrlKey)switch(t.which){case 86:case 67:case 65:case 88:case 90:case 45:return!0}else if(t.shiftKey)switch(t.which){case 45:case 46:case 37:case 39:case 36:case 35:return!0}return!1}(t,this))return;let e=!1;if(function(t,e){if(46!==t.which)return!1;let s=e.selectionStart,n=e.selectionEnd,r=e.value.length;return 0===s&&n===r&&(e.value=i(e.__opts.mask,""),a(e,0,"r"),t.preventDefault(),t.stopPropagation(),!0)}(t,this))return;let s=r(this),n=t.which;switch(229===n&&(n=t.target.value.charAt(t.target.selectionStart-1).charCodeAt()),n){case 37:a(this,s-1,"l"),e=!0;break;case 39:a(this,s+1,"r"),e=!0;break;case 38:case 40:case 33:case 34:e=!0;break;case 36:a(this,0,"r"),e=!0;break;case 35:a(this,this.__opts.mask.length,"l"),e=!0;break;case 46:d(this,"_"),e=!0;break;case 8:a(this,s-1,"l"),d(this,"_"),a(this,s-1,"l"),e=!0;break;default:1===t.key.length&&d(this,t.key),e=!0}e&&(t.preventDefault(),t.stopPropagation())}function u(t){m(this)}function h(){this.value||(this.value=i(this.__opts.mask,"")),setTimeout(()=>{a(this,0,"r")},10)}function p(i){i.preventDefault();let s=i.clipboardData.getData("text/plain");s&&(this.value=function(i,s){let n="",r=0;function o(){let t;for(;;){if(t=s[r],!t)return"_";if(r++,t>="0"&&t<="9")return t}}let a=o();for(let s=0;s<i.length;s++){let r=i[s];e(r)?n+=r:t(r)?(n+=a,a=o()):(n+=r,r===a&&(a=o()))}return n}(this.__opts.mask,s))}function m(t){var e=document.createEvent("HTMLEvents");e.initEvent("change",!1,!0),t.dispatchEvent(e)}},app.modules["std:tools"]=function(){const t=require("std:eventBus");return{alert:function(e,i,s){let n={promise:null,data:{message:e,title:i,style:"alert",list:s}};return t.$emit("confirm",n),n.promise}}},app.modules["std:html"]=function(){return{getColumnsWidth:function(t){let e=t.getElementsByTagName("col"),i=t.querySelectorAll("tbody.col-shadow")[0];i.style.display="table-row-group";let s=t.querySelectorAll("tbody.col-shadow > tr > td"),n=Math.min(e.length,s.length);for(let t=0;t<n;t++){let i=s[t].offsetWidth;e[t].setAttribute("data-col-width",i)}i.style.display="none"},getRowHeight:function(t,e){let i=t.getElementsByTagName("tr");for(let t=0;t<i.length;t++){let s=i[t].offsetHeight-(e||12);i[t].setAttribute("data-row-height",s)}},downloadBlob:function(t,e,i){let s=URL.createObjectURL(t),n=document.createElement("a");n.style="display:none",document.body.appendChild(n);let r=e||"file";"excel"===(i=(i||"").toLowerCase())?r+=".xlsx":"pdf"===i&&(r+=".pdf");n.download=r,n.href=s,n.click(),document.body.removeChild(n),URL.revokeObjectURL(s)},downloadUrl:function(t){let e=document.createElement("a");e.style="display:none",document.body.appendChild(e),e.href=t,e.setAttribute("download",""),e.click(),document.body.removeChild(e)},openUrl:function(t){let e=document.createElement("a");e.style="display:none",document.body.appendChild(e),e.href=t,e.setAttribute("target","_blank"),e.click(),document.body.removeChild(e)},printDirect:function(e){if(window.cefHost||navigator.userAgent.toLowerCase().indexOf("firefox")>-1)return void window.open(e);t();let i=document.createElement("iframe");document.body.classList.add("waiting"),i.id="print-direct-frame",i.style.cssText="display:none;width:0;height:0;border:none;position:absolute;left:-10000,top:-100000",document.body.appendChild(i),document.activeElement&&document.activeElement.blur();i.setAttribute("src",e),i.onload=function(t){let e=i.contentWindow;if(e.document.body){let t=e.document.createElement("input");t.setAttribute("id","dummy-focus"),t.cssText="width:0;height:0;border:none;position:absolute;left:-10000,top:-100000",e.document.body.appendChild(t),t.focus(),e.document.body.removeChild(t)}document.body.classList.remove("waiting"),e.print()}},removePrintFrame:t,updateDocTitle:function(t){if(document.title===t)return;document.title=t}};function t(){let t=window.frames["print-direct-frame"];t&&document.body.removeChild(t)}},app.modules["std:routing"]=function(){return{dataUrl:function(t){return"_data"}}},app.modules["std:accel"]=function(){const t=[];let e=!1;return{registerControl:function(s,n,r){-1===t.findIndex(t=>t.elem===n)&&t.push({elem:n,accel:s,action:r});!function(){if(t.length>0){if(e)return;document.addEventListener("keydown",i,!1),e=!0}else{if(!e)return;document.removeEventListener("keydown",i,!1)}}()},unregisterControl:function(e){var i=t.findIndex(t=>t.elem===e);-1!==i&&t.splice(i)}};function i(e){const i=`${e.ctrlKey?"C":"_"}${e.altKey?"A":"_"}${e.shiftKey?"S":"_"}${e.metaKey?"M":"_"}:${e.code}`;let s=t.find(t=>t.accel===i);s&&"focus"===s.action&&Vue.nextTick(()=>{s.elem.focus()})}},function(){const t=require("std:http"),e=require("std:url"),i=require("std:eventBus"),s=require("std:utils");function n(t){let e=t.firstElementChild;if(!e)return;let i=e.__vue__;i&&!i.$marker&&(i=i.$parent),i&&i.$marker()&&i.$destroy(),t.__vue__=null}Vue.component("include",{template:'<div :class="implClass"></div>',props:{src:String,cssClass:String,needReload:Boolean,insideDialog:Boolean,done:Function},data:()=>({loading:!0,currentUrl:"",_needReload:!0}),methods:{loaded(t){this.loading=!1,this.insideDialog&&i.$emit("modalCreated",this),this.done&&this.done()},requery(){this.currentUrl&&(this.__destroy(),t.load(this.currentUrl,this.$el).then(this.loaded).catch(this.error))},__destroy(){n(this.$el)},modalRequery(){this.insideDialog&&setTimeout(()=>{this.requery()},1)},error(t){if(t=t||"",this.insideDialog&&i.$emit("modalClose",!1),0===t.indexOf("UI:")){let e={promise:null,data:{message:t.substring(3).replace("\\n","\n"),style:"alert"}};i.$emit("confirm",e)}else alert(t)}},computed:{implClass(){return`include ${this.cssClass||""} ${this.loading?"loading":""}`}},mounted(){this.src&&(this.currentUrl=this.src,t.load(this.src,this.$el).then(this.loaded).catch(this.error))},destroyed(){this.__destroy()},watch:{src:function(i,s){this.insideDialog||i.split("?")[0]===s.split("?")[0]||e.idChangedOnly(i,s)||e.idOrCopyChanged(i,s)?this.currentUrl=i:(this.loading=!0,this.currentUrl=i,this.__destroy(),t.load(i,this.$el).then(this.loaded).catch(this.error))},needReload(t){t&&this.requery()}}}),Vue.component("a2-include",{template:'<div class="a2-include"></div>',props:{source:String,arg:void 0,dat:void 0},data:()=>({needLoad:0}),methods:{__destroy(){n(this.$el)},loaded(){},makeUrl(){let t=this.arg||"0",i=e.combine("_page",this.source,t);return this.dat&&(i+=e.makeQueryString(this.dat)),i},load(){let e=this.makeUrl();this.__destroy(),t.load(e,this.$el).then(this.loaded).catch(this.error)}},watch:{source(t,e){s.isEqual(t,e)||(this.needLoad+=1)},arg(t,e){s.isEqual(t,e)||(this.needLoad+=1)},dat(t,e){s.isEqual(t,e)||(this.needLoad+=1)},needLoad(){this.load()}},mounted(){this.source&&(this.currentUrl=this.makeUrl(this.source),t.load(this.currentUrl,this.$el).then(this.loaded).catch(this.error))},destroyed(){this.__destroy()}})}(),function(){const t=require("std:utils"),e=require("std:mask"),i=require("std:accel"),s={props:{label:String,required:Boolean,align:{type:String,default:"left"},description:String,disabled:Boolean,tabIndex:Number,dataType:String,format:String,validatorOptions:Object,updateTrigger:String,mask:String,hideZeros:Boolean,testId:String,accel:String},computed:{path(){return this.item._path_?this.item._path_+"."+this.prop:this.prop},pathToValidate(){return this.itemToValidate._path_+"."+this.propToValidate},modelValue(){if(!this.item)return null;let i=this.item[this.prop];return this.dataType?t.format(i,this.dataType,{hideZeros:this.hideZeros,format:this.format}):this.mask&&i?e.getMasked(this.mask,i):i},modelValueRaw(){if(!this.item)return null;return this.item[this.prop]},errors(){if(!this.item)return null;let t,e=this.item._root_;return e&&e._validate_?(t=this.itemToValidate?e._validate_(this.itemToValidate,this.pathToValidate,this.itemToValidate[this.propToValidate],this.deferUpdate):e._validate_(this.item,this.path,this.modelValueRaw,this.deferUpdate),t):null},inputClass(){let t="";return this.align&&"left"!==this.align&&(t+="text-"+this.align),this.isNegative&&(t+=" negative-red"),"input"===this.updateTrigger&&(t+=" trigger-input"),t},isNegative(){return!("Number"!==this.dataType&&"Currency"!==this.dataType||!this.item||!(this.modelValue<0))},hasLabel(){return!!this.label},hasDescr(){return!!this.description},maxLength(){if(this.item&&this.item.$maxLength)return this.item.$maxLength(this.prop)}},mounted(){this.$parent.$registerControl&&this.$parent.$registerControl(this),this.accel&&i.registerControl(this.accel,this.$refs.input,"focus"),this.mask&&e.mountElement(this.$refs.input,this.mask)},beforeDestroy(){this.$parent.$unregisterControl&&this.$parent.$unregisterControl(this),this.accel&&i.unregisterControl(this.$refs.input),this.mask&&e.unmountElement(this.$refs.input,this.mask)},methods:{valid(){return!this.invalid()},invalid(t){let e=this.errors;return!!e&&(t&&(t.warn=e.every(t=>"warning"===t.severity),t.info=e.every(t=>"info"===t.severity),t.all=e.length),e.length>0)},pending(){return this.errors&&this.errors.pending>0},cssClass(){let t={},e=this.invalid(t),i="control-group"+(e?" invalid":" valid");return e&&t.warn?i+=" val-warning":e&&t.info&&(i+=" val-info"),this.required&&(i+=" required"),this.disabled&&(i+=" disabled"),i},deferUpdate(){this.$children.forEach(t=>t.$forceUpdate()),this.$forceUpdate()},test(){alert("from base control")}},watch:{mask(){e.setMask(this.$refs.input,this.mask),this.updateValue&&this.updateValue(this.$refs.input.value)}}};app.components.control=s}(),Vue.component("validator",{props:{invalid:Function,errors:Array,options:Object},template:'<div v-if="invalid()" class="validator" :class="cssClass" :style="cssStyle"><span v-for="err in errors" v-text="err.msg" :class="err.severity"></span></div>',computed:{cssStyle(){let t={};return this.options&&this.options.width&&(t.width=this.options.width),t},cssClass(){let t={};return this.options?(this.options.placement&&(t[this.options.placement]=!0),this.options.width&&(t["with-width"]=!0),t):t}}}),Vue.component("a2-static-validator",{props:{item:{type:Object,default:()=>({})},prop:String},template:'<div v-if="invalid()" class="static-validator"><span v-for="err in errors" v-text="err.msg" :class="err.severity"></span></div>',computed:{path(){return this.item._path_+"."+this.prop},modelValue(){return this.item?this.item[this.prop]:null},errors(){if(!this.item)return null;let t,e=this.item._root_;return e&&e._validate_?(t=e._validate_(this.item,this.path,this.modelValue,this.deferUpdate),t):null}},methods:{invalid(t){let e=this.errors;return!!e&&e.length>0}}}),function(){const t=require("std:utils"),e=require("std:mask");let i=component("control");const s={extends:i,template:'<div :class="cssClass()" :test-id="testId">\n\t<label v-if="hasLabel"><span v-text="label"/><slot name="hint"/><slot name="link"></slot></label>\n\t<div class="input-group">\n\t\t<input v-if="password" type="text" class="fake-pwd-field" tabindex="-1"/>\n\t\t<input ref="input" :type="controlType" v-focus :autocomplete="autocompleteText"\n\t\t\tv-bind:value="modelValue" \n\t\t\t\tv-on:change="onChange($event.target.value)" \n\t\t\t\tv-on:input="onInput($event.target.value)"\n\t\t\t\tv-on:keypress="onKey($event)"\n\t\t\t\t:class="inputClass" :placeholder="placeholder" :disabled="disabled" :tabindex="tabIndex" :maxlength="maxLength" :spellcheck="spellCheck"/>\n\t\t<slot></slot>\n\t\t<a class="a2-hyperlink add-on a2-inline" tabindex="-1" href="" @click.stop.prevent="clear" v-if="clearVisible"><i class="ico ico-clear"></i></a>\n\t\t<validator :invalid="invalid" :errors="errors" :options="validatorOptions"></validator>\n\t</div>\n\t<slot name="popover"></slot>\n\t<span class="descr" v-if="hasDescr" v-text="description"></span>\n</div>\n',props:{item:{type:[Object,Array],default:()=>({})},prop:String,itemToValidate:Object,propToValidate:String,placeholder:String,password:Boolean,number:Boolean,spellCheck:{type:Boolean,default:void 0},enterCommand:Function,hasClear:Boolean},computed:{controlType(){return this.password?"password":"text"},autocompleteText(){return this.password?"new-password":"off"},clearVisible(){return!!this.hasClear&&!!this.item[this.prop]}},methods:{updateValue(i){this.mask?this.item[this.prop]=e.getUnmasked(this.mask,i):this.item[this.prop]=t.parse(i,this.dataType);let s=this.modelValue;this.$refs.input.value!==s&&(this.$refs.input.value=s,this.$emit("change",this.item[this.prop]))},onInput(t){"input"===this.updateTrigger&&this.updateValue(t)},onChange(t){"input"!==this.updateTrigger&&this.updateValue(t)},onKey(t){this.number&&(t.charCode<48||t.charCode>57)&&45!==t.charCode&&(t.preventDefault(),t.stopPropagation()),"Enter"===t.code&&this.enterCommand&&this.enterCommand()},clear(){this.item[this.prop]=""}}};Vue.component("textbox",s),app.components.textbox=s;const n={extends:i,template:'<div :class="cssClass()" :test-id="testId">\n\t<label v-if="hasLabel"><span v-text="label"/><slot name="hint"/><slot name="link"></slot></label>\n\t<div class="input-group">\n\t\t<textarea ref="input" v-focus v-auto-size="autoSize" v-bind:value="modelValue2" :style="areaStyle"\n\t\t\tv-on:change="onChange($event.target.value)" \n\t\t\tv-on:input="onInput($event.target.value)"\n\t\t\tv-on:keypress="onKey($event)"\n\t\t\t:rows="rows" :class="inputClass" :placeholder="placeholder" :disabled="disabled" :tabindex="tabIndex" :maxlength="maxLength" :spellcheck="spellCheck"/>\n\t\t<slot></slot>\n\t\t<validator :invalid="invalid" :errors="errors" :options="validatorOptions"></validator>\n\t</div>\n\t<slot name="popover"></slot>\n\t<span class="descr" v-if="hasDescr" v-text="description"></span>\n</div>\n',props:{item:{type:[Object,Array],default:()=>({})},prop:String,itemToValidate:Object,propToValidate:String,placeholder:String,autoSize:Boolean,rows:Number,spellCheck:{type:Boolean,default:void 0},enterCommand:Function,maxHeight:String},computed:{modelValue2(){return this.item?this.item[this.prop]:null},areaStyle(){if(this.maxHeight)return{"max-height":this.maxHeight}}},methods:{updateValue(t){this.item[this.prop]!==t&&(this.item[this.prop]=t,this.$emit("change",this.item[this.prop]))},onInput(t){"input"===this.updateTrigger&&this.updateValue(t)},onChange(t){"input"!==this.updateTrigger&&this.updateValue(t)},onKey(t){"Enter"===t.code&&t.ctrlKey&&this.enterCommand&&this.enterCommand()}},watch:{modelValue(){if(!this.autoSize)return;let t=this.$refs.input;if(t){var e=document.createEvent("HTMLEvents");e.initEvent("autosize",!1,!0),t.dispatchEvent(e)}}}},r={extends:i,template:'<div :class="cssClass()" :test-id="testId">\n\t<label v-if="hasLabel"><span v-text="label"/><slot name="hint"/><slot name="link"></slot></label>\n\t<div class="input-group static">\n\t\t<span v-focus v-text="textProp" :class="inputClass" :tabindex="tabIndex" class="static-input"/>\n\t\t<slot></slot>\n\t\t<validator :invalid="invalid" :errors="errors" :options="validatorOptions"></validator>\n\t</div>\n\t<slot name="popover"></slot>\n\t<span class="descr" v-if="hasDescr" v-text="description"></span>\n</div>\n',props:{item:{type:[Object,Array],default:()=>({})},prop:String,itemToValidate:Object,propToValidate:String,text:[String,Number,Date]},computed:{textProp(){return this.mask&&this.text?e.getMasked(this.mask,this.text):this.text}}};Vue.component("textbox",s),app.components.textbox=s,Vue.component("a2-textarea",n),app.components[n],Vue.component("static",r),app.components[r]}(),function(){const t=require("std:utils");let e=component("control");Vue.component("combobox",{extends:e,template:'<div :class="cssClass()" v-lazy="itemsSource" :test-id="testId">\n\t<label v-if="hasLabel"><span v-text="label"/><slot name="hint"/><slot name="link"></slot></label>\n\t<div class="input-group">\n\t\t<div class="select-wrapper" :disabled="disabled" >\n\t\t\t<div v-text="getWrapText()" class="select-text" ref="wrap" :class="wrapClass"/>\n\t\t\t<span class="caret"/>\n\t\t</div>\n\t\t<select v-focus v-model="cmbValue" :disabled="disabled" :tabindex="tabIndex" ref="sel" :title="getWrapText()">\n\t\t\t<slot>\n\t\t\t\t<option v-for="(cmb, cmbIndex) in itemsSource" :key="cmbIndex" \n\t\t\t\t\tv-text="getName(cmb, true)" :value="getValue(cmb)"></option>\n\t\t\t</slot>\n\t\t</select>\n\t\t<validator :invalid="invalid" :errors="errors" :options="validatorOptions"></validator>\n\t</div>\n\t<slot name="popover"></slot>\n\t<span class="descr" v-if="hasDescr" v-text="description"></span>\n</div>\n',props:{prop:String,item:{type:Object,default:()=>({})},itemsSource:{type:Array,default:()=>[]},itemToValidate:Object,propToValidate:String,nameProp:String,valueProp:String,showvalue:Boolean,align:String},computed:{cmbValue:{get(){return this.getComboValue()},set(t){this.item&&(this.item[this.prop]=t)}},wrapClass(){let t="";return this.align&&"left"!==this.align&&(t+="text-"+this.align),t}},methods:{getName(e,i){return this.nameProp?t.eval(e,this.nameProp):e.$name},getValue(e){return this.valueProp?t.eval(e,this.valueProp):e},getWrapText(){return this.showvalue?this.getComboValue():this.getText()},getComboValue(){let e=this.item?this.item[this.prop]:null;if(!t.isObjectExact(e))return e;let i=this.valueProp||"$id";return i in e?-1!==this.itemsSource.indexOf(e)?e:this.itemsSource.find(t=>t[i]===e[i]):e},getText(){let e=this.getComboValue();if(t.isObjectExact(e))return this.getName(e);if(this.itemsSource&&this.itemsSource.length){let t=this.valueProp||"$id",i=this.itemsSource.find(i=>i[t]===e);return i?this.getName(i):""}return this.getOptionsText(e)},getOptionsText(t){let e=this.$refs.sel;if(!e)return"";let i=e.options;for(let e=0;e<i.length;e++)if(""+i[e].value==""+t)return i[e].text;let s=e.selectedIndex;return s<0||s>=i.length?"":i[s].text}},mounted(){let t=this.getText();t&&(this.$refs.wrap.innerText=t)}})}(),function(){const t=require("std:utils"),e=window.$$locale;Vue.component("a2-calendar",{template:'\n<div @click.stop.prevent="dummy">\n\t<table class="calendar-pane">\n\t\t<thead><tr>\n\t\t\t\t<th class="h-btn"><a v-if="hasPrev" @click.stop.prevent="prevMonth"><i class="ico ico-triangle-left"></i></a></th>\n\t\t\t\t<th :colspan="isDayView ? 5 : 7" class="month-title"><span v-text="title"></span></th>\n\t\t\t\t<th class="h-btn"><a v-if="hasNext" @click.stop.prevent=\'nextMonth\'><i class="ico ico-triangle-right"></i></a></th>\n\t\t\t</tr>\n\t\t\t<tr class="weekdays" v-if="isDayView"><th v-for="d in 7" v-text="wdTitle(d)">ÐŸÐ½</th></tr>\n\t\t\t<tr class="weekdays" v-else><th colspan="9"></th></tr>\n\t\t</thead>\n\t\t<tbody v-if="isDayView">\n\t\t\t<tr v-for="row in days">\n\t\t\t\t<td v-for="day in row" :class="dayClass(day)"><a @click.stop.prevent="selectDay(day)" \n\t\t\t\t\t@mouseover="mouseOver(day)"\n\t\t\t\t\tv-text="day.getDate()" :title="dayTitle(day)"/></td>\n\t\t\t</tr>\n\t\t</tbody>\n\t\t<tbody v-else>\n\t\t\t<tr v-for="qr in monthes">\n\t\t\t\t<td v-for="m in qr" class="mcell" :class="monthClass(m.date)" colspan="3"><a @click.stop.prevent="selectDay(m.date)" v-text="m.name"/></td>\n\t\t\t</tr>\n\t\t</tbody>\n\t\t<tfoot v-if="showFooter" ><tr><td colspan="7" class="calendar-footer">\n\t\t\t<a class="today" @click.stop.prevent=\'today\' v-text=\'todayText\'></a></td></tr></tfoot>\n\t</table>\n</div>\n',props:{showToday:{type:Boolean,default:!0},pos:String,model:Date,setMonth:Function,setDay:Function,getDayClass:Function,hover:Function,view:String},computed:{isDayView(){return"day"===(this.view||"day")},showFooter(){return this.showToday&&this.isDayView},days(){let t=new Date(this.model);t.setHours(0,-t.getTimezoneOffset(),0,0);t.getDate();t.setDate(1);let e=t.getDay()-1;-1===e?e=6:0===e&&(e=7),t.setDate(1-e);let i=[];for(let e=0;e<6;e++){let e=[];for(let i=0;i<7;i++){let i=new Date(t);i.setHours(0,-i.getTimezoneOffset(),0,0),e.push(new Date(i)),t.setDate(t.getDate()+1)}i.push(e)}return i},monthes(){let i=[];for(let s=0;s<4;s++){let n=[];for(let i=0;i<3;i++){let r=3*s+i,o=t.date.create(this.model.getFullYear(),r+1,1),a=t.text.capitalize(o.toLocaleDateString(e.$Locale,{month:"long"}));n.push({date:o,month:r+1,name:a})}i.push(n)}return i},hasPrev(){return"right"!==this.pos},hasNext(){return"left"!==this.pos},title(){let i=this.model.toLocaleString(e.$Locale,{month:"long",year:"numeric"});return t.text.capitalize(i)},todayText:()=>e.$Today,todayDate:()=>t.date.today()},methods:{dummy(){},nextMonth(){let e=new Date(this.model);this.isDayView?e=t.date.add(e,1,"month"):e.setFullYear(e.getFullYear()+1),this.setMonth(e,this.pos)},prevMonth(){let e=new Date(this.model);this.isDayView?e=t.date.add(e,-1,"month"):e.setFullYear(e.getFullYear()-1),this.setMonth(e,this.pos)},wdTitle(t){return this.days[0][t-1].toLocaleString(e.$Locale,{weekday:"short"})},today(){this.setDay(this.todayDate)},selectDay(t){this.setDay(t,this.pos)},dayClass(e){let i="";if(e.getMonth()!==this.model.getMonth()&&(i+=" other"),this.getDayClass)return i+=this.getDayClass(e),i;let s=t.date;return s.equal(e,this.todayDate)&&(i+=" today"),s.equal(e,this.model)&&(i+=" active"),i},monthClass(t){let e="";return t.getFullYear()===this.model.getFullYear()&&t.getMonth()===this.model.getMonth()&&(e+=" active"),e},dayTitle:t=>t.toLocaleString(e.$Locale,{year:"numeric",month:"long",day:"numeric",weekday:"long"}),mouseOver(t){this.hover&&this.hover(t)}}})}(),function(){const t=require("std:popup"),e=require("std:utils"),i=require("std:eventBus"),s=component("control"),n=window.$$locale;Vue.component("a2-date-picker",{extends:s,template:'\n<div :class="cssClass2()" class="date-picker" :test-id="testId">\n\t<label v-if="hasLabel"><span v-text="label"/><slot name="hint"/><slot name="link"></slot></label>\n\t<div class="input-group"  @click="clickInput($event)">\n\t\t<input v-focus v-model.lazy="model" :class="inputClass" :disabled="inputDisabled"/>\n\t\t<a href @click.stop.prevent="toggle($event)" tabindex="-1"><i class="ico ico-calendar"></i></a>\n\t\t<validator :invalid="invalid" :errors="errors" :options="validatorOptions"></validator>\n\t\t<div class="calendar" v-if="isOpen">\t\t\n\t\t\t<a2-calendar :model="modelDate" :view="view"\n\t\t\t\t:set-month="setMonth" :set-day="selectDay" :get-day-class="dayClass"/>\n\t\t</div>\n\t</div>\n\t<span class="descr" v-if="hasDescr" v-text="description"></span>\n</div>\n',props:{item:Object,prop:String,itemToValidate:Object,propToValidate:String,align:{type:String,default:"center"},view:String,yearCutOff:String},data:()=>({isOpen:!1}),methods:{toggle(t){this.disabled||(this.isOpen||(i.$emit("closeAllPopups"),e.date.isZero(this.modelDate)&&(this.item[this.prop]=e.date.today())),this.isOpen=!this.isOpen)},clickInput(t){"month"===this.view&&(this.toggle(t),t.stopPropagation(),t.preventDefault())},setMonth(t){this.setDate(t)},selectDay(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0));this.setDate(e),this.isOpen=!1},setDate(t){let e=this.modelDate,i=new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),0,0));this.item[this.prop]=i},dayClass(t){let i="",s=e.date;return s.equal(t,s.today())&&(i+=" today"),s.equal(t,this.modelDate)&&(i+=" active"),t.getMonth()!==this.modelDate.getMonth()&&(i+=" other"),i},cssClass2(){let t=this.cssClass();return this.isOpen&&(t+=" open"),t},__clickOutside(){this.isOpen=!1}},computed:{modelDate(){return this.item[this.prop]},inputDisabled(){return this.disabled||"month"===this.view},model:{get(){return e.date.isZero(this.modelDate)?"":"month"===this.view?e.text.capitalize(this.modelDate.toLocaleString(n.$Locale,{timeZone:"UTC",year:"numeric",month:"long"})):this.modelDate.toLocaleString(n.$Locale,{timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit"})},set(t){let i=e.date.parse(t,this.yearCutOff);e.date.isZero(i)?(this.item[this.prop]=i,this.isOpen=!1):this.setDate(i)}}},mounted(){t.registerPopup(this.$el),this.$el._close=this.__clickOutside},beforeDestroy(){t.unregisterPopup(this.$el)}})}(),function(){const t=require("std:popup"),e=require("std:utils"),i=require("std:eventBus"),s=component("control"),n=window.$$locale,r={props:{model:Date,setHour:Function,setMinute:Function,getHourClass:Function,getMinuteClass:Function},template:'\n<div @click.stop.prevent="dummy" class="time-picker-pane calendar-pane">\n<table class="table-hours">\n<thead><tr><th colspan="6" v-text="locale.$Hours">Ð“Ð¾Ð´Ð¸Ð½Ð¸</th></tr></thead>\n<tbody>\n\t<tr v-for="row in hours">\n\t\t<td v-for="h in row" :class="getHourClass(h)"><a @click.stop.prevent="clickHours(h)" v-text="h"/></td>\n\t</tr>\t\n</tbody></table>\n<div class="divider"/>\n<table class="table-minutes">\n<thead><tr><th colspan="3" v-text="locale.$Minutes">Ð¥Ð²Ð¸Ð»Ð¸Ð½Ð¸</th></tr></thead>\n<tbody>\n\t<tr v-for="row in minutes">\n\t\t<td v-for="m in row" :class="getMinuteClass(m)"><a @click.stop.prevent="clickMinutes(m)" v-text="m"/></td>\n\t</tr>\t\n</tbody></table>\n</div>\n',methods:{clickHours(t){this.setHour&&this.setHour(+t)},clickMinutes(t){this.setMinute&&this.setMinute(t)},dummy(){}},computed:{locale:()=>n,hours(){let t=[];for(let i=0;i<4;i++){let s=[];t.push(s);for(let t=0;t<6;t++){var e=6*i+t;e<10&&(e="0"+e),s.push(e)}}return t},minutes(){let t=[];for(let i=0;i<4;i++){let s=[];t.push(s);for(let t=0;t<3;t++){var e=5*(3*i+t);e<10&&(e="0"+e),s.push(e)}}return t}}};Vue.component("a2-time-picker",{extends:s,template:'\n<div :class="cssClass2()" class="date-picker">\n\t<label v-if="hasLabel"><span v-text="label"/><slot name="hint"/><slot name="link"></slot></label>\n\t<div class="input-group">\n\t\t<input v-focus v-model.lazy="model" :class="inputClass" :disabled="inputDisabled"/>\n\t\t<a href @click.stop.prevent="toggle($event)"><i class="ico ico-waiting-outline"></i></a>\n\t\t<validator :invalid="invalid" :errors="errors" :options="validatorOptions"></validator>\n\t\t<div class="calendar" v-if="isOpen">\n\t\t\t<a2-time-sheet :model="modelDate" :set-hour="setHour" :set-minute="setMinute" :get-hour-class="hourClass" :get-minute-class="minuteClass"/>\n\t\t</div>\n\t</div>\n\t<span class="descr" v-if="hasDescr" v-text="description"></span>\n</div>\n',components:{"a2-time-sheet":r},props:{item:Object,prop:String,itemToValidate:Object,propToValidate:String,align:{type:String,default:"center"}},data:()=>({isOpen:!1}),methods:{toggle(t){this.disabled||(this.isOpen||(i.$emit("closeAllPopups"),e.date.isZero(this.modelDate)&&(this.item[this.prop]=e.date.today())),this.isOpen=!this.isOpen)},setHour(t){let e=new Date(this.modelDate);e.setUTCHours(t),this.item[this.prop]=e},setMinute(t){let e=new Date(this.modelDate);e.setMinutes(t),this.item[this.prop]=e,this.isOpen=!1},hourClass(t){let e="";return this.modelDate.getUTCHours()===+t&&(e+=" active"),e},minuteClass(t){return this.modelDate.getUTCMinutes()===+t?"active":void 0},cssClass2(){let t=this.cssClass();return this.isOpen&&(t+=" open"),t},__clickOutside(){this.isOpen=!1}},computed:{modelDate(){return this.item[this.prop]},inputDisabled(){return this.disabled},model:{get(){let t=this.modelDate;return e.date.isZero(t)?"":t.toLocaleTimeString(n.$Locale,{timeZone:"UTC",hour:"2-digit",minute:"2-digit"})},set(t){let i=new Date(this.modelDate);if(t){e.date.isZero(i)&&(i=e.date.today());let s=e.date.parseTime(t);i.setUTCHours(s.getHours(),s.getMinutes())}else i.setUTCHours(0,0);this.item[this.prop]=i,this.isOpen=!1}}},mounted(){t.registerPopup(this.$el),this.$el._close=this.__clickOutside},beforeDestroy(){t.unregisterPopup(this.$el)}})}(),function(){const t=require("std:popup"),e=require("std:utils"),i=require("std:eventBus"),s=require("std:period"),n=component("control");window.$$locale;Vue.component("a2-period-picker",{extends:n,template:'\n<div class="control-group period-picker" @click.stop.prevent="toggle($event)" :class="{open: isOpen}">\n\t<label v-if="hasLabel"><span v-text="label"/><slot name="hint"/></label>\n\t<div class="input-group">\n\t\t<span class="period-text" v-text="text" :class="inputClass" :tabindex="tabIndex"/>\n\t\t<span class="caret"/>\n\t\t<div class="calendar period-pane" v-if="isOpen" @click.stop.prevent="dummy">\n\t\t\t<ul class="period-menu" style="grid-area: 1 / 1 / span 2 / auto">\n\t\t\t\t<li v-for=\'(mi, ix) in menu\' :key="ix" :class="{active: isSelectedMenu(mi.key)}"><a v-text=\'mi.name\' @click.stop.prevent="selectMenu(mi.key)"></a></li>\n\t\t\t</ul>\n\t\t\t<a2-calendar style="grid-area: 1 / 2" :show-today="false" pos="left" :model="prevModelDate" \n\t\t\t\t:set-month="setMonth" :set-day="setDay" :get-day-class="dayClass" :hover="mouseHover"/>\n\t\t\t<a2-calendar style="grid-area: 1 / 3; margin-left:6px":show-today="false" pos="right" :model="modelDate" \n\t\t\t\t:set-month="setMonth" :set-day="setDay" :get-day-class="dayClass" :hover="mouseHover"/>\n\t\t\t<div class="period-footer" style="grid-area: 2 / 2 / auto / span 2">\n\t\t\t\t<span class="current-period" v-text="currentText" :class="{processing: selection}"/>\n\t\t\t\t<span class="aligner"></span>\n\t\t\t\t<button class="btn btn-primary" @click.stop.prevent="apply" v-text="locale.$Apply" :disabled="applyDisabled"/>\n\t\t\t\t<button class="btn btn-default" @click.stop.prevent="close" v-text="locale.$Cancel" />\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<span class="descr" v-if="hasDescr" v-text="description"></span>\n</div>\n',props:{item:Object,prop:String,showAll:{type:Boolean,default:!0},display:String,callback:Function},data:()=>({isOpen:!1,selection:"",modelDate:e.date.today(),currentPeriod:s.zero(),selectEnd:e.date.zero(),timerId:null}),computed:{locale:()=>window.$$locale,text(){return"name"===this.display?this.period.text():"namedate"===this.display?this.period.isAllData()?this.period.text(!0):`${this.period.text(!0)} [${this.period.format("Date")}]`:this.period.format("Date")},period(){if(!this.item)return this.currentPeriod;let t=this.item[this.prop];return s.isPeriod(t)||console.error("PeriodPicker. Value is not a Period"),t},prevModelDate(){return e.date.add(this.modelDate,-1,"month")},currentText(){return this.currentPeriod.format("Date")},applyDisabled(){return"start"===this.selection},menu(){return s.predefined(this.showAll)}},methods:{dummy(){},setMonth(t,i){this.modelDate="left"===i?e.date.add(t,1,"month"):t},setDay(t){this.selection?"start"===this.selection&&(this.currentPeriod.To=t,this.currentPeriod.normalize(),this.selection=""):(this.selection="start",this.currentPeriod.From=t,this.currentPeriod.To=e.date.zero(),this.selectEnd=e.date.zero())},dayClass(t){let e="",i=this.currentPeriod;return this.selection&&(i=s.create("custom",this.currentPeriod.From,this.selectEnd)),i.in(t)&&(e+=" active"),i.From.getTime()===t.getTime()&&(e+=" period-start"),i.To.getTime()===t.getTime()&&(e+=" period-end"),e},close(){this.isOpen=!1},apply(){this.period.equal(this.currentPeriod)||(this.period.assign(this.currentPeriod),this.fireEvent()),this.isOpen=!1},fireEvent(){this.callback&&this.callback(this.period);let t=this.item.$root;if(!t)return;let e=this.item._path_+"."+this.prop+".change";t.$emit(e,this.item,this.period,null)},toggle(t){this.isOpen||(i.$emit("closeAllPopups"),this.modelDate=this.period.To,(this.modelDate.isZero()||this.modelDate.getTime()===e.date.maxDate.getTime())&&(this.modelDate=e.date.today()),this.currentPeriod.assign(this.period),this.selection="",this.selectEnd=e.date.zero()),this.isOpen=!this.isOpen},__clickOutside(){this.isOpen=!1},isSelectedMenu(t){return s.create(t).equal(this.currentPeriod)},selectMenu(t){let e=s.create(t);this.currentPeriod.assign(e),this.apply()},mouseHover(t){this.selection&&this.selectEnd.getTime()!==t.getTime()&&(clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.selectEnd=t},150))}},mounted(){t.registerPopup(this.$el),this.$el._close=this.__clickOutside},beforeDestroy(){t.unregisterPopup(this.$el)}})}(),function(){const t=require("std:popup"),e=require("std:utils"),i=require("std:platform"),s=window.$$locale,n=require("std:eventBus"),r=component("control");Vue.component("a2-selector",{extends:r,template:'\n<div :class="cssClass2()"  :test-id="testId">\n\t<label v-if="hasLabel"><span v-text="label"/><slot name="hint"/><slot name="link"></slot></label>\n\t<div class="input-group">\n\t\t<div v-if="isCombo" class="selector-combo" @click.stop.prevent="open"><span tabindex="-1" class="select-text" v-text="valueText" @keydown="keyDown" ref="xcombo"/></div>\n\t\t<input v-focus v-model="query" :class="inputClass" :placeholder="placeholder" v-else\n\t\t\t@input="debouncedUpdate" @blur.stop="blur" @keydown="keyDown" @keyup="keyUp" ref="input" \n\t\t\t:disabled="disabled" @click="clickInput($event)"/>\n\t\t<slot></slot>\n\t\t<a class="selector-open" href="" @click.stop.prevent="open" v-if="caret"><span class="caret"></span></a>\n\t\t<a class="selector-clear" href="" @click.stop.prevent="clear" v-if="clearVisible">&#x2715</a>\n\t\t<validator :invalid="invalid" :errors="errors" :options="validatorOptions"></validator>\n\t\t<div class="selector-pane" v-if="isOpen" ref="pane" :class="paneClass">\n\t\t\t<div class="selector-body" :style="bodyStyle">\n\t\t\t\t<slot name="pane" :items="items" :is-item-active="isItemActive" :item-name="itemName" :hit="hit" :slotStyle="slotStyle">\n\t\t\t\t\t<ul class="selector-ul">\n\t\t\t\t\t\t<li @mousedown.prevent="hit(itm)" :class="{active: isItemActive(itmIndex)}"\n\t\t\t\t\t\t\tv-for="(itm, itmIndex) in items" :key="itmIndex" v-text="itemName(itm)">}</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</slot>\n\t\t\t</div>\n\t\t\t<a v-if=\'canNew\' class="create-elem a2-hyperlink a2-inline" @mousedown.stop.prevent="doNew()"><i class="ico ico-plus"/> <span v-text="newText"></span></a>\n\t\t</div>\n\t\t<div class="selector-pane" v-if="isOpenNew" @click.stop.prevent="dummy">\n\t\t\t<slot name="new-pane"></slot>\n\t\t</div>\n\t</div>\n\t<slot name="popover"></slot>\n\t<span class="descr" v-if="hasDescr" v-text="description"></span>\n</div>\n',props:{item:Object,prop:String,itemsSource:Array,textItem:Object,textProp:String,display:String,itemToValidate:Object,propToValidate:String,placeholder:String,delay:Number,minChars:Number,fetch:Function,hitfunc:Function,listWidth:String,listHeight:String,createNew:Function,placement:String,caret:Boolean,hasClear:Boolean,mode:String},data:()=>({isOpen:!1,isOpenNew:!1,loading:!1,items:[],query:"",filter:"",current:-1}),computed:{valueText(){if(!this.item)return"";if(this.hasText){if(this.item[this.prop].$isEmpty)return this.textItem[this.textProp]}let t=this.item[this.prop];return e.isNumber(t)&&this.itemsSource&&(t=this.itemsSource.find(e=>e.$id===t),!t)?"":e.simpleEval(t,this.display)},canNew(){return!!this.createNew},clearVisible(){if(!this.hasClear)return!1;let t=this.item[this.prop];return t&&e.isDefined(t)&&!t.$isEmpty},hasText(){return!!this.textProp},newText(){return`${s.$CreateLC} "${this.query}"`},pane(){return{items:this.items,isItemActive:this.isItemActive,itemName:this.itemName,hit:this.hit}},paneClass(){if(this.placement)return"panel-"+this.placement},bodyStyle(){let t={};return this.listWidth&&(t.minWidth=this.listWidth),this.listHeight&&(t.maxHeight=this.listHeight),t},slotStyle(){let t={};return this.listWidth&&(t.width=this.listWidth,t.minWidth=this.listWidth),this.listHeight&&(t.maxHeight=this.maxHeight),t},debouncedUpdate(){let t=this.delay||300;return e.debounce(()=>{this.current=-1,this.filter=this.query,this.update()},t)},isCombo(){return"combo-box"===this.mode||"hyperlink"===this.mode}},watch:{valueText(t){if(this.hasText){this.item[this.prop].$isEmpty||(this.textItem[this.textProp]="")}this.query=this.valueText}},methods:{dummy(){},__clickOutside(){this.isOpen=!1,this.isOpenNew=!1},cssClass2(){let t=this.cssClass();return(this.isOpen||this.isOpenNew)&&(t+=" open"),"hyperlink"===this.mode?t+=" selector-hyperlink":"combo-box"===this.mode&&(t+=" selector-combobox"),t},isItemActive(t){return t===this.current},itemName(t){return e.simpleEval(t,this.display)},blur(){let t=this.query;if(this.hasText&&t!==this.valueText){let e=this.item[this.prop];e&&e.$empty&&e.$empty(),this.textItem[this.textProp]=t}this.cancel()},open(){if(!this.isOpen)if(n.$emit("closeAllPopups"),-1!=this.current&&this.$nextTick(()=>this.scrollIntoView()),this.doFetch(this.valueText,!0),this.isCombo){let t=this.$refs.xcombo;t&&t.focus()}else{let t=this.$refs.input;t&&t.focus()}this.isOpen=!this.isOpen},cancel(){this.query=this.valueText,this.isOpen=!1},keyUp(t){this.isOpen&&27===t.which?(t.preventDefault(),t.stopPropagation(),this.cancel()):13===t.which&&this.hasText&&this.blur()},clickInput(t){this.caret&&!this.isOpen&&(t.stopPropagation(),t.preventDefault(),this.open())},keyDown(t){if(this.isOpen)switch(t.stopPropagation(),t.which){case 27:t.preventDefault();break;case 13:if(-1===this.current)return;this.hit(this.items[this.current]);break;case 40:t.preventDefault(),this.current+=1,this.current>=this.items.length&&(this.current=0),this.query=this.itemName(this.items[this.current]),this.scrollIntoView();break;case 38:t.preventDefault(),this.current-=1,this.current<0&&(this.current=this.items.length-1),this.query=this.itemName(this.items[this.current]),this.scrollIntoView();break;case 115:this.cancel();break;default:return}else 115===t.which&&this.open()},hit(t){let s=this.item[this.prop];this.query=this.valueText,this.isOpen=!1,this.isOpenNew=!1,this.current=this.items.indexOf(t),this.$nextTick(()=>{this.hitfunc?this.hitfunc.call(this.item.$root,t):s&&s.$merge?s.$merge(t,!0):e.isNumber(s)?this.item[this.prop]=t.$id:i.set(this.item,this.prop,t)})},clear(){this.query="",this.isOpen=!1,this.isOpenNew=!1;let t=this.item[this.prop];t.$empty&&t.$empty()},scrollIntoView(){this.$nextTick(()=>{let t=this.$refs.pane;if(!t)return;let e=t.querySelector(".active");e&&e.scrollIntoView(!1)})},update(){let t=this.query||"",e=+(this.minChars||0);e&&t.length<e||(this.isOpen=!0,this.isOpenNew=!1,""!==t?this.doFetch(t,!1):this.clear())},doFetch(t,i){if(this.itemsSource){this.items.length||(this.items=this.itemsSource);let t=-1,i=this.item[this.prop];return t=e.isNumber(i)?this.items.findIndex(t=>t.Id===i):this.items.indexOf(i),void(-1!==t&&(this.current=t,setTimeout(()=>this.scrollIntoView(),10)))}this.loading=!0;let s=this.fetchData(t,i);s.then?s.then(t=>{this.loading=!1;let e=Object.keys(t)[0];this.items=t[e]}).catch(()=>{this.items=[]}):e.isArray(s)&&this.items!=s&&(this.items.length!=s.length&&(this.current=-1),this.items=s)},fetchData(t,e){this.fetch||console.error("Selector. Fetch not defined"),e=e||!1;let i=this.item[this.prop];return i&&!("$vm"in i)&&(i.$vm=this.$root),this.fetch.call(this.item.$root,i,t,e)},doNew(){if(this.isOpen=!1,this.createNew){let t={elem:this.item[this.prop],text:this.query};this.createNew(t)}}},mounted(){t.registerPopup(this.$el),this.query=this.valueText,this.$el._close=this.__clickOutside},beforeDestroy(){t.unregisterPopup(this.$el)}})}(),function(){const t=require("std:utils"),e=require("std:log"),i=require("std:eventBus"),s=window.$$locale,n=t.text.equalNoCase,r={name:"data-grid-column",template:'\n<th :class="cssClass" @click.prevent="doSort">\n\t<div class="h-fill" v-if="fixedHeader" v-text="headerText">\n\t</div><div class="h-holder">\n\t\t<slot>{{headerText}}</slot>\n\t</div>\n</th>\n',props:{header:String,content:String,dataType:String,hideZeros:Boolean,format:String,icon:String,bindIcon:String,id:String,align:{type:String,default:"left"},editable:{type:Boolean,default:!1},noPadding:{type:Boolean,default:!1},validate:String,sort:{type:Boolean,default:void 0},sortProp:String,small:{type:Boolean,default:void 0},bold:String,mark:String,controlType:String,width:String,fit:Boolean,wrap:String,command:Object},created(){this.$parent.$addColumn(this)},destroyed(){this.$parent.$removeColumn(this)},computed:{sortProperty(){return this.sortProp||this.content},dir(){return this.$parent.sortDir(this.sortProperty)},fixedHeader(){return this.$parent.fixedHeader},isSortable(){return!!this.sortProperty&&(void 0===this.sort?this.$parent.isGridSortable:this.sort)},isUpdateUrl(){return!this.$root.inDialog},template(){return this.id?this.$parent.$scopedSlots[this.id]:null},classAlign(){return"left"!==this.align?(" text-"+this.align).toLowerCase():""},cssClass(){let t=this.classAlign;return this.isSortable&&(t+=" sort",this.dir&&(t+=" "+this.dir)),t},headerText(){return this.header||"Â "},evalOpts(){return{hideZeros:this.hideZeros,format:this.format}}},methods:{doSort(){this.isSortable&&this.$parent.doSort(this.sortProperty)},cellCssClass(e,i){let s=this.classAlign;if(this.mark){let i=t.simpleEval(e,this.mark);i&&(s+=" "+i)}return i&&"checkbox"!==this.controlType&&(s+=" cell-editable"),this.wrap&&(s+=" "+this.wrap),this.small&&(s+=" small"),function(i,n){if(i)if("true"===i)s+=n;else if(i.startsWith("{")){var r=i.substring(1,i.length-1);t.simpleEval(e,r)&&(s+=n)}}(this.bold," bold"),s.trim()}}};Vue.component("data-grid-column",r);const o={name:"data-grid-row",template:'\n<tr @click="rowSelect(row)" :class="rowClass()" v-on:dblclick.prevent="doDblClick" ref="tr" @mousedown="mouseDown(row)">\n\t<td v-if="isMarkCell" class="marker">\n\t\t<div :class="markClass"></div>\n\t</td>\n\t<td v-if="detailsMarker" class="details-marker" @click.prevent="toggleDetails">\n\t\t<i v-if="detailsIcon" class="ico" :class="detailsExpandClass" />\n\t</td>\n\t<data-grid-cell v-for="(col, colIndex) in cols" :key="colIndex" :row="row" :col="col" :index="index" />\n</tr>',components:{"data-grid-cell":{functional:!0,name:"data-grid-cell",props:{row:Object,col:Object,index:Number},render(e,i){let s=i.props.row,n=i.props.col,r=i.props.index,o={class:n.cellCssClass(s,n.editable||n.noPadding)},a={props:{row:s,col:n}};if(n.template){return e("td",o,[n.template(a.props)])}if("validator"===n.controlType){let t={props:["item","col"],template:'<span><i v-if="item.$invalid" class="ico ico-error"></i></span>'};return o.class={"cell-validator":!0},e("td",o,[e(t,{props:{item:s,col:n}})])}if(!n.content&&!n.icon&&!n.bindIcon)return e("td",o);let l={props:["path","item"],template:'<validator :path="path" :item="item"></validator>'},d={props:{path:n.validate,item:s}};function c(e,i){if(t.isBoolean(e)||t.isNumber(e)||t.isObjectExact(e))return e;if("this"===(e=e||""))e=s;else if(e.startsWith("{"))if(-1!==(e=e.substring(1,e.length-1)).indexOf("."))e=t.eval(s,e);else{if(!(e in s))throw new Error(`Property '${e}' not found in ${s.constructor.name} object`);e=s[e]}else e&&i&&(e=t.eval(s,e,n.dataType,n.evalOpts));return e}if(n.command){let i=c(n.command.arg1,!1),r=c(n.command.arg2,n.command.eval),l=c(n.command.arg3,!1),d=n.command.arg4;return e("td",o,[e({props:["row","col"],template:'<a @click.prevent="doCommand($event)" :href="getHref()"><i v-if="hasIcon" :class="iconClass" class="ico"></i><span v-text="eval(row, col.content, col.dataType, col.evalOpts)"></span></a>',computed:{hasIcon:()=>n.icon||n.bindIcon,iconClass(){let e=n.content?"":" ico-single";return n.bindIcon?"ico-"+t.eval(s,n.bindIcon)+e:n.icon?"ico-"+n.icon+e:null}},methods:{doCommand(t){n.command.cmd(i,r,l,d)},eval:t.eval,getHref(){if(!n.command)return null;if(n.command.isDialog)return"";if(-1!==n.command.cmd.name.indexOf("$exec"))return"";let e=r;return t.isObjectExact(r)&&(e=r.$id),i+"/"+e}}},a)])}if("$index"===n.content)return e("td",o,[r+1]);let u=t.eval(s,n.content,n.dataType,n.evalOpts),h=[e("span",{class:{"dg-cell":!0,"negative-red":function(e){if("Number"===e.dataType||"Currency"===e.dataType){if(t.eval(s,e.content,e.dataType,e.evalOpts,!0)<0)return!0}return!1}(n)}},u)],p=n.content?"":" ico-single";return n.icon?h.unshift(e("i",{class:"ico ico-"+n.icon+p})):n.bindIcon&&h.unshift(e("i",{class:"ico ico-"+t.eval(s,n.bindIcon)+p})),n.validate&&h.push(e(l,d)),e("td",o,h)}}},props:{row:Object,cols:Array,index:Number,mark:String,group:Boolean,level:Number,isItemActive:Function,hitItem:Function},computed:{isMarkCell(){return this.$parent.isMarkCell},detailsMarker(){return this.$parent.isRowDetailsCell},detailsIcon(){if(!this.detailsMarker)return!1;let t=this.$parent.rowDetailsVisible;return!1===t||t&&this.row[t]},detailsExpandClass(){return this.row._uiprops_.$details?"ico-minus-circle":"ico-plus-circle"},totalColumns(){console.error("implement me")},markClass(){return this.mark?t.simpleEval(this.row,this.mark):""}},methods:{rowClass(){let e="dg-row";return(this.isItemActive?this.isItemActive(this.index):!!this.row.$selected)&&(e+=" active"),this.$parent.isMarkRow&&this.mark&&(e+=" "+t.simpleEval(this.row,this.mark)),(this.index+1)%2&&(e+=" even"),this.$parent.rowBold&&this.row[this.$parent.rowBold]&&(e+=" bold"),this.level&&(e+=" lev-"+this.level),e.trim()},rowSelect(t){t.$select&&t.$select()},mouseDown(t){this.hitItem&&this.hitItem(t)},doDblClick(t){t.stopImmediatePropagation(),this.$parent.doubleclick&&(window.getSelection().removeAllRanges(),this.$parent.doubleclick())},toggleDetails(t){this.detailsIcon&&Vue.set(this.row._uiprops_,"$details",!this.row._uiprops_.$details)}}},a={name:"data-grid-row-details",template:'\n<tr v-if="visible()" class="row-details">\n\t<td v-if="isMarkCell" class="marker">\n\t\t<div :class="markClass"></div>\n\t</td>\n\t<td :colspan=\'totalCols\' class="details-cell">\n\t\t<div class="details-wrapper"><slot></slot></div>\n\t</td>\n</tr>\n',props:{cols:Number,row:Object,mark:String},computed:{isMarkCell(){return this.$parent.isMarkCell},markClass(){return this.mark?t.simpleEval(this.row,this.mark):""},detailsMarker(){return this.$parent.isRowDetailsCell},totalCols(){return this.cols+(this.isMarkCell?1:0)+(this.detailsMarker?1:0)}},methods:{visible(){return!!this.$parent.isRowDetailsAlways||(this.$parent.isRowDetailsCell?!!this.row._uiprops_.$details:this.row===this.$parent.selected())}}};Vue.component("data-grid",{props:{"items-source":[Object,Array],border:Boolean,grid:String,fixedHeader:Boolean,hideHeader:Boolean,hover:{type:Boolean,default:void 0},striped:{type:Boolean,default:void 0},compact:Boolean,sort:Boolean,routeQuery:Object,mark:String,filterFields:String,markStyle:String,rowBold:String,doubleclick:Function,groupBy:[Array,Object,String],rowDetails:Boolean,rowDetailsActivate:String,rowDetailsVisible:[String,Boolean],isItemActive:Function,hitItem:Function,emptyPanelCallback:Function,testId:String,autoSelect:String},template:'\n<div v-lazy="itemsSource" :class="{\'data-grid-container\':true, \'fixed-header\': fixedHeader, \'bordered\': border}" :test-id="testId">\n\t<div class="data-grid-header-border" v-if="fixedHeader" />\n\t<div :class="{\'data-grid-body\': true, \'fixed-header\': fixedHeader}">\n\t<div class="data-grid-empty" v-if="$isEmpty">\n\t\t<slot name="empty" />\n\t</div>\n\t<table :class="cssClass">\n\t\t<colgroup>\n\t\t\t<col v-if="isMarkCell" class="fit"/>\n\t\t\t<col v-if="isRowDetailsCell" class="fit" />\n\t\t\t<col v-bind:class="columnClass(col)" v-bind:style="columnStyle(col)" v-for="(col, colIndex) in columns" :key="colIndex"></col>\n\t\t</colgroup>\n\t\t<thead>\n\t\t\t<tr v-show="isHeaderVisible">\n\t\t\t\t<th v-if="isMarkCell" class="marker"><div v-if="fixedHeader" class="h-holder">&#160;</div></th>\n\t\t\t\t<th v-if="isRowDetailsCell" class="details-marker"><div v-if="fixedHeader" class="h-holder">&#160;</div></th>\n\t\t\t\t<slot></slot>\n\t\t\t</tr>\n\t\t</thead>\n\t\t<template v-if="isGrouping">\n\t\t\t<tbody>\n\t\t\t\t<template v-for="(g, gIndex) of $groups">\n\t\t\t\t\t<tr v-if="isGroupGroupVisible(g)" :class="\'group lev-\' + g.level" :key="gIndex">\n\t\t\t\t\t\t<td @click.prevent=\'toggleGroup(g)\' :colspan="groupColumns">\n\t\t\t\t\t\t<span :class="{expmark: true, expanded: g.expanded}" />\n\t\t\t\t\t\t<span class="grtitle" v-text="groupTitle(g)" />\n\t\t\t\t\t\t<span v-if="isGroupCountVisible(g)" class="grcount" v-text="g.count" /></td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<template v-for="(row, rowIndex) in g.items">\n\t\t\t\t\t\t<data-grid-row v-show="isGroupBodyVisible(g)" :group="true" :level="g.level" :cols="columns" :row="row" :key="gIndex + \':\' + rowIndex" :index="rowIndex" :mark="mark" ref="row" />\n\t\t\t\t\t\t<data-grid-row-details v-if="rowDetails" v-show="isGroupBodyVisible(g)" :cols="columns.length" :row="row" :key="\'rd:\' + gIndex + \':\' + rowIndex" :mark="mark">\n\t\t\t\t\t\t\t<slot name="row-details" :row="row"></slot>\n\t\t\t\t\t\t</data-grid-row-details>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t</tbody>\n\t\t</template>\n\t\t<template v-else>\n\t\t\t<tbody>\n\t\t\t\t<template v-for="(item, rowIndex) in $items">\n\t\t\t\t\t<data-grid-row :cols="columns" :row="item" :key="rowIndex" :index="rowIndex" :mark="mark" ref="row" :is-item-active="isItemActive" :hit-item="hitItem"/>\n\t\t\t\t\t<data-grid-row-details v-if="rowDetails" :cols="columns.length" :row="item" :key="\'rd:\' + rowIndex" :mark="mark">\n\t\t\t\t\t\t<slot name="row-details" :row="item"></slot>\n\t\t\t\t\t</data-grid-row-details>\n\t\t\t\t</template>\n\t\t\t</tbody>\n\t\t</template>\n\t\t<slot name="footer"></slot>\n\t</table>\n\t</div>\n</div>\n',components:{"data-grid-row":o,"data-grid-row-details":a},data:()=>({columns:[],clientItems:null,clientGroups:null,localSort:{dir:"asc",order:""}}),computed:{$items(){return this.clientItems?this.clientItems:this.itemsSource},isMarkCell(){return"marker"===this.markStyle||"both"===this.markStyle},isRowDetailsCell(){return this.rowDetails&&"cell"===this.rowDetailsActivate},isRowDetailsAlways(){return this.rowDetails&&"always"===this.rowDetailsActivate},isMarkRow(){return"row"===this.markStyle||"both"===this.markStyle},isHeaderVisible(){return!this.hideHeader},cssClass(){let t="data-grid";return this.grid&&(t+=" grid-"+this.grid.toLowerCase()),null!=this.striped&&(t+=this.striped?" striped":" no-striped"),null!=this.hover&&(t+=this.hover?" hover":" no-hover"),this.compact&&(t+=" compact"),t},isGridSortable(){return!!this.sort},isLocal(){return!this.$parent.sortDir},isGrouping(){return this.groupBy},groupColumns(){return this.columns.length+(this.isMarkCell?1:0)+(this.isRowDetailsCell?1:0)},$groupCount(){return t.isString(this.groupBy)?this.groupBy.split("-").length:t.isObjectExact(this.groupBy)?1:this.groupBy.length},$groups(){this.doSortLocally();let i=performance.now(),n={},r=this.groupBy;if(t.isString(r)){let t=[];for(let e of r.split("-"))t.push({prop:e.trim(),count:!0});r=t}else t.isObjectExact(r)&&(r=[r]);if(!this.$items)return null;for(let e of this.$items){let i=n;for(let n of r){let r=t.eval(e,n.prop);t.isDate(r)&&(r=t.format(r,"Date")),t.isDefined(r)||(r=""),""===r&&(r=s.$Unknown||"Unknown"),r in i||(i[r]={}),i=i[r]}i.items||(i.items=[]),i.items.push(e)}let o=[];for(let t of function*t(e,i,s,n){for(let r in e){if("items"===r)continue;let o=e[r],a=o.items?o.items.length:0;n&&(n.c+=a);let l={group:r,p0:i,expanded:!0,level:s,items:o.items||null,count:a};if(yield l,!e.items){let e={c:0};yield*t(o,l,s+1,e),l.count+=e.c}}}(n,null,1))t.source=r[t.level-1],!1===t.source.expanded&&(t.expanded=!1),o.push(t);return this.clientGroups=o,e.time("datagrid grouping time:",i),this.clientGroups},$isEmpty(){if(!this.itemsSource)return!1;let t=this.itemsSource.$ModelInfo;return!!t&&("HasRows"in t?!this.itemsSource.length&&!1===t.HasRows:0===this.itemsSource.length)}},watch:{localSort:{handler(){this.handleSort()},deep:!0},"itemsSource.length"(){this.handleSort()},$isEmpty(t,e){this.emptyPanelCallback&&this.emptyPanelCallback.call(this.$root.$data,t)}},methods:{selected(){let t=this.itemsSource;return t.$origin&&(t=t.$origin),t.$selected},$addColumn(t){this.columns.push(t)},$removeColumn(t){let e=this.columns.indexOf(t);-1!==e&&this.columns.splice(e,1)},columnClass(e){let i="";return(e.fit||"validator"===e.controlType)&&(i+="fit"),this.sort&&e.isSortable&&t.isDefined(e.dir)&&(i+=" sorted"),i},columnStyle:e=>({width:t.isDefined(e.width)?e.width:void 0}),doSort(t){this.isLocal?n(this.localSort.order,t)?this.localSort.dir=n(this.localSort.dir,"asc")?"desc":"asc":this.localSort={order:t,dir:"asc"}:this.$parent.$emit("sort",t)},sortDir(t){return this.isLocal?n(this.localSort.order,t)?this.localSort.dir:void 0:this.$parent.sortDir(t)},doSortLocally(){if(!this.isLocal)return;if(!this.localSort.order)return;let t=performance.now(),i="desc"===this.localSort.dir,s=this.localSort.order,n=[].concat(this.itemsSource);n.sort((t,e)=>{let n=t[s],r=e[s];return n===r?0:n<r?i?1:-1:i?-1:1}),e.time("datagrid sorting time:",t),this.clientItems=n},handleSort(){this.isGrouping?this.clientGroups=null:this.doSortLocally()},toggleGroup(t){t.expanded=!t.expanded},isGroupCountVisible:e=>!(e&&e.source&&t.isDefined(e.source.count))||e.source.count,isGroupGroupVisible(t){if(!t.group)return!1;if(!t.p0)return!0;let e=t.p0;for(;e;){if(!e.expanded)return!1;e=e.p0}return!0},isGroupBodyVisible(t){if(!t.expanded)return!1;let e=t.p0;for(;e;){if(!e.expanded)return!1;e=e.p0}return!0},groupTitle:t=>t.source&&t.source.title?t.source.title.replace("{Value}",t.group).replace("{Count}",t.count):t.group,expandGroups(t){for(var e of this.$groups)e.expanded=e.level<t},__autoSelect(){if(this.autoSelect&&this.$items&&this.$items.length&&!this.$items.$selected)switch(this.autoSelect){case"first-item":this.$items[0].$select();break;case"last-item":this.$items[this.$items.length-1].$select()}},__invoke__test__(t){if("datagrid"===(t=t||{}).target&&t.testId===this.testId)switch(t.action){case"selectRow":this.$items.forEach(e=>{e.$id.toString()===t.id&&(e.$select(),t.result="success")})}}},updated(){let t=this.itemsSource;if(!t)return;let e=t.$selectedIndex,i=this.$refs.row;if(-1!==e&&i&&e<i.length){i[e].$refs.tr.scrollIntoViewCheck()}this.__autoSelect()},mounted(){this.testId&&i.$on("invokeTest",this.__invoke__test__)},beforeDestroy(){this.testId&&i.$off("invokeTest",this.__invoke__test__)}})}(),function(){const t=window.$$locale,e=require("std:eventBus");Vue.component("a2-pager",{props:{source:Object,emptyText:String,templateText:String},computed:{pages(){return Math.ceil(this.count/this.source.pageSize)},currentPage(){return Math.ceil(this.offset/this.source.pageSize)+1},title(){return this.count?this.textString:this.emptyString},emptyString(){return this.emptyText?this.emptyText:t.$NoElements},textString(){let e=Math.min(this.count,this.offset+this.source.pageSize);return this.templateText?this.templateText.replace(/\#\[Start\]/g,this.offset+1).replace(/\#\[End\]/g,e).replace(/\#\[Count\]/g,this.count):`${t.$PagerElements}: <b>${this.offset+1}</b>-<b>${e}</b> ${t.$Of} <b>${this.count}</b>`},offset(){return+this.source.offset},count(){return+this.source.sourceCount}},methods:{setOffset(t){t=+t,this.offset!==t&&(e.$emit("closeAllPopups"),this.$nextTick(()=>this.source.$setOffset(t)))},isActive(t){return t===this.currentPage},click(t,e){switch(e.preventDefault(),t){case"prev":this.setOffset(this.offset-this.source.pageSize);break;case"next":this.setOffset(this.offset+this.source.pageSize)}},goto(t,e){e.preventDefault();let i=(t-1)*this.source.pageSize;this.setOffset(i)}},render(t,e){if(-1===this.source.pageSize)return;let i=[];const s={class:"a2-pager-dots"},n=e=>t("button",{domProps:{innerText:e},on:{click:t=>this.goto(e,t)},class:{active:this.isActive(e)}});i.push(t("button",{on:{click:t=>this.click("prev",t)},attrs:{disabled:0===this.offset,"aria-label":"Previous page"}},[t("i",{class:"ico ico-chevron-left"})])),this.pages>0&&i.push(n(1));let r=2,o=this.pages-1;2==this.pages&&(o=2);let a=!1,l=!1,d=this.currentPage;o-r>4&&(d>4&&(a=!0),d<this.pages-3&&(l=!0),a&&!l?r=o-3:!a&&l?o=r+3:a&&l&&(r=d-1,o=d+1)),a&&i.push(t("span",s,"..."));for(let t=r;t<=o;++t)i.push(n(t));return l&&i.push(t("span",s,"...")),this.pages>2&&i.push(n(this.pages)),i.push(t("button",{on:{click:t=>this.click("next",t)},attrs:{disabled:this.currentPage>=this.pages,"aria-label":"Next Page"}},[t("i",{class:"ico ico-chevron-right"})])),i.push(t("span",{class:"a2-pager-divider"})),i.push(t("span",{class:"a2-pager-title",domProps:{innerHTML:this.title}})),t("div",{class:"a2-pager"},i)}})}(),Vue.component("popover",{template:'\n<div v-dropdown class="popover-wrapper" :style="{top: top}" :class="{show: isShowHover}">\n\t<span toggle class="popover-title" v-on:mouseover="mouseover" v-on:mouseout="mouseout"><i v-if="hasIcon" :class="iconClass"></i> <span :title="title" v-text="content"></span><slot name="badge"></slot></span>\n\t<div class="popup-body" :style="{width: width, left:offsetLeft}">\n\t\t<div class="arrow" :style="{left:offsetArrowLeft}"/>\n\t\t<div v-if="visible">\n\t\t\t<include :src="popoverUrl"/>\n\t\t</div>\n\t\t<slot />\n\t</div>\n</div>\n',data:()=>({state:"hidden",hoverstate:!1,popoverUrl:""}),props:{icon:String,url:String,content:[String,Number],title:String,width:String,top:String,hover:Boolean,offsetX:String},computed:{hasIcon(){return!!this.icon},offsetLeft(){return this.offsetX||void 0},offsetArrowLeft(){if(this.offsetX&&0===this.offsetX.indexOf("-"))return`calc(${this.offsetX.substring(1)} + 6px)`},iconClass(){let t="ico po-ico";return this.icon&&(t+=" ico-"+this.icon),t},visible(){return this.url&&"shown"===this.state},isShowHover(){return this.hover&&this.hoverstate?"show":void 0}},methods:{mouseover(){this.hover&&(this.hoverstate=!0)},mouseout(){this.hover&&(this.hoverstate=!1)}},mounted(){this.$el._show=()=>{if(this.state="shown",this.url){const t=require("std:url");let e=window.$$rootUrl;this.popoverUrl=t.combine(e,"/_popup",this.url)}},this.$el._hide=()=>{this.state="hidden",this.popoverUrl=""}}}),function(){const t=require("std:utils"),e=require("std:eventBus"),i=require("std:platform"),s={name:"tree-item",template:'\n<li @click.stop.prevent="doClick(item)" :title=title v-on:dblclick.stop.prevent="doDblClick(item)"\n\tv-show=isItemVisible\n\t:class="{expanded: isExpanded, collapsed:isCollapsed, active:isItemSelected, folder:isFolder, group: isItemGroup}" >\n\t<div :class="{overlay:true, \'no-icons\': !options.hasIcon}">\n\t\t<a class="toggle" v-if="isFolder" href @click.stop.prevent=toggle></a>\n\t\t<span v-else class="toggle"/>\n\t\t<i v-if="options.hasIcon" :class="iconClass"/>\n\t\t<a v-if="hasLink(item)" :href=dataHref tabindex="-1" v-text="item[options.label]" :class="{\'no-wrap\':!options.wrapLabel }"/>\n\t\t<span v-else v-text="item[options.label]" :class="{\'tv-folder\':true, \'no-wrap\':!options.wrapLabel}"/>\n\t</div>\n\t<ul v-if=isFolder v-show=isExpanded>\n\t\t<tree-item v-for="(itm, index) in item[options.subitems]" :options="options"\n\t\t\t:key="index" :item="itm" :click="click" :doubleclick="doubleclick" :get-href="getHref" :is-active="isActive" :expand="expand" :root-items="rootItems">\n\t\t</tree-item>\n\t</ul>\n</li>\n',props:{item:Object,options:Object,rootItems:Array,click:Function,expand:Function,isActive:Function,isGroup:Function,getHref:Function,doubleclick:Function},methods:{isFolderSelect(e){let i=this.options.folderSelect;return t.isFunction(i)?i(e):!!this.options.folderSelect},doClick(t){e.$emit("closeAllPopups"),this.isFolder&&!this.isFolderSelect(t)?this.toggle():"$select"in t?t.$select(this.rootItems):this.click&&this.click(t)},doDblClick(t){e.$emit("closeAllPopups"),this.isFolder&&!this.isFolderSelect(t)||this.doubleclick&&this.doubleclick()},hasLink(t){return!this.isFolder||this.isFolderSelect(t)},toggle(){e.$emit("closeAllPopups"),this.isFolder&&(this.expandItem(!this.item.$expanded),this.expand&&this.expand(this.item,this.options.subitems))},expandItem(t){i.set(this.item,"$expanded",t)},openElem:function(){this.isFolder&&this.expandItem(!0)}},computed:{isFolder:function(){if(t.isDefined(this.item.$hasChildren)&&this.item.$hasChildren)return!0;if(t.isDefined(this.options.isFolder))return this.item[this.options.isFolder];let e=this.item[this.options.subitems];return e&&e.length},isItemVisible:function(){let t=this.options.isVisible;return!t||this.item[t]},isExpanded:function(){return this.isFolder&&this.item.$expanded},isCollapsed:function(){return this.isFolder&&!this.item.$expanded},title(){var t=this.item[this.options.title];return t||(t=this.item[this.options.label]),t},isItemSelected:function(){return this.item&&"$selected"in this.item?this.item.$selected:this.isActive&&this.isActive(this.item)},isItemGroup(){let e=this.options?this.options.isGroup:void 0;return e?t.eval(this.item,e):this.isGroup&&this.isGroup(this.item)},iconClass:function(){let t=this.options.staticIcons;if(t)return"ico ico-"+(this.isFolder?t[0]:t[1]);if(this.options.icon){let t=this.item[this.options.icon];return t?"ico ico-"+(t||"empty"):""}},dataHref(){return this.getHref?this.getHref(this.item):""}},watch:{isItemSelected(t){t&&this.$el.scrollIntoViewCheck&&this.$el.scrollIntoViewCheck()}},updated(t){if(this.item.$expanded&&this.item.$hasChildren){this.item[this.options.subitems].$loaded||this.expandItem(!1)}}};Vue.component("tree-view",{components:{"tree-item":s},template:'\n<ul class="tree-view">\n\t<tree-item v-for="(itm, index) in items" :options="options" :get-href="getHref"\n\t\t:item="itm" :key="index"\n\t\t:click="click" :doubleclick="doubleclick" :is-active="isActive" :is-group="isGroup" :expand="expand" :root-items="items">\n\t</tree-item>\n</ul>',props:{options:Object,items:Array,isActive:Function,isGroup:Function,click:Function,expand:Function,autoSelect:String,getHref:Function,expandFirstItem:Boolean,doubleclick:Function},computed:{isSelectFirstItem(){return"first-item"===this.autoSelect}},watch:{items:function(){this.doExpandFirst()}},methods:{selectFirstItem(){if(!this.isSelectFirstItem)return;let t=this.items;if(!t.length)return;let e=null;if(this.options&&this.options.isVisible){let i=this.options.isVisible;e=t.$find(t=>t[i])}else e=t[0];e&&e.$select&&e.$select(this.items)},doExpandFirst(){this.expandFirstItem&&this.$nextTick(()=>{this.$children&&this.$children.forEach(t=>{t&&t.openElem&&t.openElem()})})}},created(){this.selectFirstItem(),this.doExpandFirst()},updated(){this.isSelectFirstItem&&!this.items.$selected&&this.selectFirstItem()}})}(),function(){const t=require("std:log",!0),e=require("std:utils"),i=require("std:period"),s=require("std:eventBus"),n=e.text.equalNoCase;function r(t,e){if(!t)return;let i=t.$ModelInfo;return i?i[e]:void 0}function o(t,e,i){if(!t)return;let s=t.$ModelInfo;s&&(s[e]=i)}function a(t){let s={dir:t.dir,order:t.order,offset:t.offset,group:t.GroupBy};for(let n in t.filter){let r=t.filter[n];i.isPeriod(r)?s[n]=r.format("DateUrl"):e.isDate(r)?s[n]=e.format(r,"DateUrl"):e.isObjectExact(r)?("Id"in r||console.error("The object in the Filter does not have Id property"),s[n]=r.Id?r.Id:void 0):s[n]=r||void 0}return s}function l(t,s){if(t)for(let n in s)if(n in t){let r=s[n];i.isPeriod(r)?s[n]=r.fromUrl(t[n]):e.isDate(r)?s[n]=e.date.tryParse(t[n]):e.isObjectExact(r)?r.Id=t[n]:e.isNumber(r)?s[n]=+t[n]:s[n]=t[n]}}Vue.component("collection-view",{template:'\n<div>\n\t<slot :ItemsSource="pagedSource" :Pager="thisPager" :Filter="filter">\n\t</slot>\n</div>\n',props:{ItemsSource:Array,initialPageSize:Number,initialFilter:Object,initialSort:Object,runAt:String,filterDelegate:Function},data(){let t=Object.assign({},{offset:0,dir:"asc",order:""},this.initialFilter);return{filter:this.initialFilter,filteredCount:0,localQuery:t}},computed:{pageSize(){return this.initialPageSize>0?this.initialPageSize:-1},dir(){return this.localQuery.dir},offset(){return this.localQuery.offset},order(){return this.localQuery.order},pagedSource(){let e=performance.now(),i=[].concat(this.ItemsSource);if(this.filterDelegate&&(i=i.filter(t=>this.filterDelegate(t,this.filter))),this.order&&this.dir){let t=this.order,e=n(this.dir,"asc");i.sort((i,s)=>i[t]===s[t]?0:i[t]<s[t]?e?-1:1:e?1:-1)}return this.filteredCount=i.length,this.pageSize>0&&(i=i.slice(this.offset,this.offset+this.pageSize)),i.$origin=this.ItemsSource,-1===i.indexOf(i.$origin.$selected)&&i.$origin.$clearSelected(),t&&t.time("get paged source:",e),i},sourceCount(){return this.ItemsSource.length},thisPager(){return this},pages(){let t=this.filteredCount;return Math.ceil(t/this.pageSize)}},methods:{$setOffset(t){this.localQuery.offset=t},sortDir(t){return n(t,this.order)?this.dir:void 0},doSort(t){let e=this.makeNewQuery();n(e.order,t)?e.dir=n(e.dir,"asc")?"desc":"asc":(e.order=t,e.dir="asc"),e.order||(e.dir=null),this.localQuery.dir=e.dir,this.localQuery.order=e.order},makeNewQuery(){return a(this)},copyQueryToLocal(t){for(let e in t){let i=t[e];this.localQuery[e]="offset"===e?t[e]:i||void 0}}},created(){this.initialSort&&(this.localQuery.order=this.initialSort.order,this.localQuery.dir=this.initialSort.dir),this.$on("sort",this.doSort)}}),Vue.component("collection-view-server",{template:'\n<div>\n\t<slot :ItemsSource="ItemsSource" :Pager="thisPager" :Filter="filter" :ParentCollectionView="parentCw">\n\t</slot>\n</div>\n',props:{ItemsSource:Array,initialFilter:Object,persistentFilter:Array},data(){return{filter:this.initialFilter,lockChange:!0}},watch:{jsonFilter:{handler(t,e){this.filterChanged()}}},computed:{jsonFilter(){return e.toJson(this.filter)},thisPager(){return this},pageSize(){return r(this.ItemsSource,"PageSize")},dir(){return r(this.ItemsSource,"SortDir")},order(){return r(this.ItemsSource,"SortOrder")},offset(){return r(this.ItemsSource,"Offset")},pages(){return cnt=this.sourceCount,Math.ceil(cnt/this.pageSize)},sourceCount(){return this.ItemsSource&&this.ItemsSource.$RowCount||0},parentCw(){let t=this.$parent;for(;t&&t.$options&&t.$options._componentTag&&!t.$options._componentTag.startsWith("collection-view-server");)t=t.$parent;return t}},methods:{$setOffset(t){this.offset!==t&&(o(this.ItemsSource,"Offset",t),this.reload())},sortDir(t){return n(t,this.order)?this.dir:void 0},doSort(t){if(n(t,this.order)){let t=n(this.dir,"asc")?"desc":"asc";o(this.ItemsSource,"SortDir",t)}else o(this.ItemsSource,"SortOrder",t),o(this.ItemsSource,"SortDir","asc");this.reload()},filterChanged(){if(this.lockChange)return;let t=this.ItemsSource.$ModelInfo;if(t?this.ItemsSource.$ModelInfo.Filter=this.filter:(t={Filter:this.filter},this.ItemsSource.$ModelInfo=t),this.persistentFilter&&this.persistentFilter.length){let i=this.ItemsSource._path_,s=i.lastIndexOf(".");i=i.substring(s+1);for(let s of this.ItemsSource.$parent.$parent)if(s[i].$ModelInfo)for(let t of this.persistentFilter)e.isEqual(s[i].$ModelInfo.Filter[t],this.filter[t])||(s[i].$ModelInfo.Filter[t]=this.filter[t],s[i].$loaded=!1);else s[i].$ModelInfo=t}"Offset"in t&&o(this.ItemsSource,"Offset",0),this.reload()},reload(){this.$root.$emit("cwChange",this.ItemsSource)},updateFilter(){let t=this.ItemsSource?this.ItemsSource.$ModelInfo:null;if(!t)return;let e=t.Filter;if(e){for(var i in this.lockChange=!0,this.filter)i in e&&(this.filter[i]=e[i]);this.$nextTick(()=>{this.lockChange=!1})}},__setFilter(t){this.ItemsSource===t.source&&(i.isPeriod(t.value)?this.filter[t.prop].assign(t.value):this.filter[t.prop]=t.value)}},created(){let t=this.ItemsSource?this.ItemsSource.$ModelInfo:null;t&&l(t.Filter,this.filter),this.$nextTick(()=>{this.lockChange=!1}),this.$on("sort",this.doSort),s.$on("setFilter",this.__setFilter)},updated(){this.updateFilter()},beforeDestroy(){s.$off("setFilter",this.__setFilter)}}),Vue.component("collection-view-server-url",{store:component("std:store"),template:'\n<div>\n\t<slot :ItemsSource="ItemsSource" :Pager="thisPager" :Filter="filter" :Grouping="thisGrouping">\n\t</slot>\n</div>\n',props:{ItemsSource:Array,initialFilter:Object,initialGroup:Object},data(){return{filter:this.initialFilter,GroupBy:"",lockChange:!0}},watch:{jsonFilter:{handler(t,e){this.filterChanged()}},GroupBy:{handler(t,e){this.filterChanged()}}},computed:{jsonFilter(){return e.toJson(this.filter)},pageSize(){let t=r(this.ItemsSource,"PageSize");return t||20},dir(){let t=this.$store.getters.query.dir;return t||(t=r(this.ItemsSource,"SortDir")),t},offset(){let t=this.$store.getters.query.offset;return e.isDefined(t)||(t=r(this.ItemsSource,"Offset")),t||0},order(){return r(this.ItemsSource,"SortOrder")},sourceCount(){return this.ItemsSource&&this.ItemsSource.$RowCount||0},thisPager(){return this},thisGrouping(){return this},pages(){return cnt=this.sourceCount,Math.ceil(cnt/this.pageSize)},Filter(){return this.filter}},methods:{commit(t){this.$store.commit("setquery",t)},sortDir(t){return n(t,this.order)?this.dir:void 0},$setOffset(t){this.offset!==t&&(o(this.ItemsSource,"Offset",t),this.commit({offset:t}))},doSort(t){let e=this.makeNewQuery();n(e.order,t)?e.dir=n(e.dir,"asc")?"desc":"asc":(e.order=t,e.dir="asc"),e.order||(e.dir=null),this.commit(e)},makeNewQuery(){return a(this)},filterChanged(){if(this.lockChange)return;let t=this.makeNewQuery();t.offset=0,t.order||(t.dir=void 0),this.commit(t)},__setFilter(t){this.ItemsSource===t.source&&(i.isPeriod(t.value)?this.filter[t.prop].assign(t.value):this.Filter[t.prop]=t.value)}},created(){let t=this.ItemsSource.$ModelInfo;t&&(l(t.Filter,this.filter),t.GroupBy&&(this.GroupBy=t.GroupBy)),l(this.$store.getters.query,this.filter),this.$nextTick(()=>{this.lockChange=!1}),this.$on("sort",this.doSort),s.$on("setFilter",this.__setFilter)},beforeDestroy(){s.$off("setFilter",this.__setFilter)}})}(),function(){const t=require("std:url"),e=require("std:http"),i=require("std:tools"),s=window.$$locale;Vue.component("a2-upload",{template:'\n<label :class="cssClass" @dragover="dragOver" @dragleave="dragLeave">\n\t<input v-if=\'canUpload\' type="file" @change="uploadImage" v-bind:multiple="isMultiple" :accept="accept" />\n\t<i class="ico" :class="icoClass"></i>\n\t<span class="upload-tip" v-text="tip" v-if="tip"></span>\n</label>\n\t\t',props:{item:Object,prop:String,base:String,newItem:Boolean,tip:String,readOnly:Boolean,accept:String,limit:Number,icon:String},data:function(){return{hover:!1}},computed:{cssClass(){return"file-upload"+(this.hover?" hover":"")},isMultiple(){return!!this.newItem},canUpload(){return!this.readOnly},icoClass(){return this.icon?"ico-"+this.icon:"image/*"===this.accept?"ico-image":"ico-upload"}},methods:{dragOver(t){this.hover=!0,t.preventDefault()},dragLeave(t){this.hover=!1,t.preventDefault()},checkLimit(t){if(!this.limit)return!1;return t.size/1024>this.limit},uploadImage(n){let r=window.$$rootUrl,o=this.item[this.prop],a=t.combine(r,"_image",this.base,this.prop,o);var l=new FormData;for(let t of n.target.files){if(this.checkLimit(t)){n.target.value="";let t=s.$FileTooLarge.replace("{0}",this.limit);return void i.alert(t)}l.append("file",t,t.name)}e.upload(a,l).then(t=>{n.target.value="";let e=void 0;if(this.item._meta_&&(e=this.item._meta_.$token),"OK"===t.status)if(this.newItem){let i=this.item.$parent;for(let s of t.elems){let t=i.$append();t[this.prop]=s.Id,t[e]=s.Token}}else this.item[this.prop]=t.elems[0].Id,this.item[e]=t.elems[0].Token}).catch(t=>{0===t.indexOf("UI:")?i.alert(t.substring(3).replace("\\n","\n")):alert(t)})}}}),Vue.component("a2-simple-upload",{template:'\n<label class="a2-simple-upload" :class="labelClass">\n\t<i class="ico" :class=\'icon\'></i>\n\t<input type="file" @change="uploadChange" ref="file"/>\n\t<span v-text="labelText" class="upload-text"></span>\n\t<button class="btnclose" @click.prevent="clear" v-if="file">&#x2715;</button>\n</label>\n\t\t',props:{item:Object,prop:String,text:String},data:function(){return{}},computed:{labelText(){return this.file?this.file.name:this.text||s.$ChooseFile},icon(){return this.file&&this.file.name?"ico-file":"ico-attach"},file(){return this.item?this.item[this.prop]:null},labelClass(){return this.file?"has-file":void 0}},methods:{fireChange(){},clear(){this.item&&(this.item[this.prop]=null,this.fireChange(),this.$refs.file.value="")},uploadChange(t){let e=t.target.files;this.item[this.prop]=e[0],this.fireChange()}}})}(),function(){require("std:utils");Vue.component("a2-tab-item",{name:"a2-tab-item",template:'\n<div class="tab-item" v-show="isActive">\n\t<slot />\n</div>\n',props:{header:String,badge:[String,Number,Object],icon:String,tabStyle:String,show:void 0,itemToValidate:Object,propToValidate:String},data:()=>({controls:[]}),computed:{hasIcon(){return!!this.icon},hasBadge(){return!!this.badge},iconCss(){return this.icon?"ico ico-"+this.icon:""},isActive(){return this===this.$parent.activeTab},tabCssClass(){return(this.isActive?"active ":"")+(this.tabStyle||"")},isVisible(){return"boolean"!=typeof this.show||this.show}},methods:{isInvalid(){if(!this.controls.length)return!1;for(let t of this.controls)if(t.invalid())return!0;return!1},$registerControl(t){this.controls.push(t)},$unregisterControl(t){let e=this.controls.indexOf(t);-1!==e&&this.controls.splice(e,1)}},created(){this.$parent.$addTab(this)},destroyed(){this.$parent.$removeTab(this)}}),Vue.component("a2-tab-panel",{template:'\n<div class="tab-panel">\n\t<template v-if="static">\n\t\t<ul class="tab-header">\n\t\t\t<li :class="tab.tabCssClass" v-for="(tab, tabIndex) in tabs" :key="tabIndex" @click.prevent="select(tab)" v-show="tab.isVisible">\n\t\t\t\t<i v-if="tab.hasIcon" :class="tab.iconCss" ></i>\n\t\t\t\t<span v-text="tab.header"></span><span class="badge" v-if="tab.hasBadge" v-text="tab.badge"></span>\n\t\t\t\t<i v-if="tab.isInvalid()" class="ico ico-error-outline"/>\n\t\t\t</li>\n\t\t</ul>\n\t\t<slot name="title" />\n\t\t<div class="tab-content" :class="contentCssClass">\n\t\t\t<slot />\n\t\t</div>\n\t</template>\n\t<template v-else>\n\t\t<ul class="tab-header">\n\t\t\t<li :class="{active: isActiveTab(item)}" v-for="(item, tabIndex) in items" :key="tabIndex" @click.prevent="select(item)" v-show="item.isVisible">\n\t\t\t\t<slot name="header" :item="item" :index="tabIndex" :number="tabIndex + 1">\n\t\t\t\t\t<span v-text="defaultTabHeader(item, tabIndex)"></span> \n\t\t\t\t</slot>\n\t\t\t</li>\n\t\t</ul>\n\t\t<slot name="title" />\n\t\t<div class="tab-content">\n\t\t\t<div class="tab-item" v-if="isActiveTab(item)" v-for="(item, tabIndex) in items" :key="tabIndex">\n\t\t\t\t<slot name="items" :item="item" :index="tabIndex" />\n\t\t\t</div>\n\t\t</div>\n\t</template>\n</div>\n',props:{items:Array,header:String},data:()=>({tabs:[],activeTab:null}),computed:{static(){return!this.items},contentCssClass(){return this.activeTab?this.activeTab.tabStyle:""}},watch:{items(t,e){let i=this.items;t.length<e.length?(this._index>=i.length&&(this._index=i.length-1),this.select(i[this._index])):t.length===e.length?i.length>0&&this.select(i[0]):this.select(i[i.length-1])}},methods:{select(t){this.activeTab=t,this.items&&(this._index=this.items.indexOf(t))},nextTab(){alert("next")},prevTab(){alert("prev")},isActiveTab(t){return t===this.activeTab},defaultTabHeader:(t,e)=>"Tab "+(e+1),$addTab(t){this.tabs.push(t)},$removeTab(t){let e=this.tabs.indexOf(t);-1!==e&&(this.tabs.splice(e,1),-1===this.tabs.indexOf(this.activeTab)&&this.tabs.length>0&&this.select(this.tabs[0]))}},mounted(){this.tabs.length>0?this.activeTab=this.tabs[0]:this.items&&this.items.length&&(this.activeTab=this.items[0]),this._index=0}})}(),function(){const t=require("std:utils"),e=(require("std:eventBus"),window.$$locale);Vue.component("a2-list",{template:'\n<ul class="a2-list" v-lazy="itemsSource">\n\t<template v-if="itemsSource">\n\t\t<li class="a2-list-item" tabindex="1" :class="cssClass(listItem)" v-for="(listItem, listItemIndex) in source" :key="listItemIndex" \n\t\t\t\t@mousedown.prevent="select(listItem)" @keydown="keyDown" \n\t\t\t\tref="li">\n\t\t\t<span v-if="listItem.__group" v-text="listItem.__group"></span>\n\t\t\t<slot name="items" :item="listItem" v-if="!listItem.__group"/>\n\t\t</li>\n\t\t<div class="list-empty" v-if="$isEmpty">\n\t\t\t<slot name="empty" />\n\t\t</div>\n\t</template>\n\t<template v-else>\n\t\t<slot />\n\t</template>\n</ul>\n',props:{itemsSource:Array,autoSelect:String,mark:String,markStyle:String,command:Function,selectable:{type:Boolean,default:!0},hover:{type:Boolean,default:!0},groupBy:String},computed:{selectedSource(){let t=this.itemsSource;return t?(t.$origin&&(t=t.$origin),t.$selected):null},source(){if(!this.groupBy)return this.itemsSource;let i={};for(let s of this.itemsSource){let n=t.eval(s,this.groupBy);t.isDate(n)&&(n=t.format(n,"Date")),t.isDefined(n)||(n=""),""===n&&(n=e.$Unknown||"Unknown"),n in i||(i[n]={group:n,items:[]}),i[n].items.push(s)}let s=[];for(let t in i){let e=i[t];for(var n of(s.push(Object.assign({},e,{__group:e.group,__count:e.items.length})),e.items))s.push(n)}return s},$isEmpty(){return this.itemsSource&&0===this.itemsSource.length}},methods:{cssClass(e){return this.groupBy&&e.__group?"group"+(this.mark?" mark":""):(e.$selected?"active ":" ")+(e=>{if(!this.mark)return"";let i=t.eval(e,this.mark);return"row"===this.markStyle?i+=" no-marker":"marker"===this.markStyle&&(i+=" no-background"),i})(e)},select(t){this.selectable&&t.$select&&t.$select()},selectStatic(){alert("yet not implemented"),console.dir(this)},selectFirstItem(){if(!this.autoSelect)return;if(!this.selectable)return;let e=this.itemsSource;if(!e.$selected&&e&&e.length)if("first-item"!==this.autoSelect)if("last-item"!==this.autoSelect){if("item-id"===this.autoSelect){let i=this.$root.$modelInfo.Id;if(!t.isDefined(i))return void console.error("Id not found in Root.modelInfo");let s=e.find(t=>t.$id===i);s||(console.error(`Element with id=${i} not found`),s=e[0]),s&&this.select(s)}}else{let t=e[e.length-1];this.select(t)}else{let t=e[0];this.select(t)}},keyDown(e){const i=t=>{let e;e=this.itemsSource.indexOf(this.selectedSource),-1!==e&&(e+=t,-1!==e&&e<this.itemsSource.length&&this.select(this.itemsSource[e]))};switch(e.which){case 38:i(-1);break;case 40:i(1);break;case 36:case 35:case 33:case 34:break;case 13:t.isFunction(this.command)&&this.command();break;default:return}e.preventDefault(),e.stopPropagation()}},created(){this.selectFirstItem()},updated(){if(!this.selectedSource&&this.autoSelect&&this.selectFirstItem(),!this.itemsSource)return;let t=this.$refs.li;t&&setTimeout(()=>{let e=t.findIndex(t=>t.classList.contains("active"));-1!==e&&t&&e<t.length&&t[e].scrollIntoViewCheck()},0)}})}(),function(){const t=require("std:eventBus"),e=window.$$locale,i=require("std:utils"),s={inserted(t,e){let i=t.closest(".modal-window");if(i){switch(e.value.width&&(i.style.width=e.value.width),e.value.cssClass){case"modal-large":i.style.width="800px";break;case"modal-small":i.style.width="350px"}e.value.minWidth&&(i.style.minWidth=e.value.minWidth)}}},n={inserted(t,e){let i=t.closest(".modal-window");i&&e.value&&i.setAttribute("maximize","true")}},r={inserted(t,e){const i=t.closest(".modal-window");if(!i)return;const s={down:!1,init:{x:0,y:0,cx:0,cy:0},offset:{x:0,y:0}};function n(t){s.down=!1,document.removeEventListener("mouseup",n),document.removeEventListener("mousemove",r)}function r(t){if(!s.down)return;let e=t.pageX-s.offset.x,n=t.pageY-s.offset.y,r=s.init.x+e,o=s.init.y+n,a=window.innerWidth-s.init.cx;window.innerHeight,s.init.cy;o<0&&(o=0),r<0&&(r=0),r>a&&(r=a),i.style.marginLeft=r+"px",i.style.marginTop=o+"px"}t.addEventListener("mousedown",(function(t){s.down=!0,s.offset.x=t.pageX,s.offset.y=t.pageY;const e=window.getComputedStyle(i);s.init.x=Number.parseFloat(e.marginLeft),s.init.y=Number.parseFloat(e.marginTop),s.init.cx=Number.parseFloat(e.width),s.init.cy=Number.parseFloat(e.height),document.addEventListener("mouseup",n,!1),document.addEventListener("mousemove",r,!1)}),!1)}};Vue.directive("drag-window",r),Vue.directive("modal-width",s),Vue.directive("maximize",n);const o={template:'\n<div class="modal-window modal-animation-window" @keydown.tab="tabPress" :class="mwClass" ref=dialog>\n\t<include v-if="isInclude" class="modal-body" :src="dialog.url" :done="loaded" :inside-dialog="true"></include>\n\t<div v-else class="modal-body">\n\t\t<div class="modal-header" v-drag-window><span v-text="title"></span><button ref=\'btnclose\' class="btnclose" @click.prevent="modalClose(false)">&#x2715;</button></div>\n\t\t<div :class="bodyClass">\n\t\t\t<i v-if="hasIcon" :class="iconClass" />\n\t\t\t<div class="modal-body-content">\n\t\t\t\t<div v-html="messageText()" />\n\t\t\t\t<ul v-if="hasList" class="modal-error-list">\n\t\t\t\t\t<li v-for="(itm, ix) in dialog.list" :key="ix" v-text="itm"/>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="modal-footer">\n\t\t\t<button class="btn btn-default" v-for="(btn, index) in buttons"  :key="index" @click.prevent="modalClose(btn.result)" v-text="btn.text"/>\n\t\t</div>\n\t</div>\n</div>\n',props:{dialog:Object},data:()=>({modalCreated:!1,keyUpHandler:function(e){27===e.which&&(t.$emit("modalClose",!1),e.stopPropagation(),e.preventDefault())}}),methods:{modalClose(e){t.$emit("modalClose",e)},loaded(){},messageText(){return i.text.sanitize(this.dialog.message)},tabPress(t){const e=this.$refs.dialog,i=document.activeElement;let s=Array.from(e.querySelectorAll("input:enabled, button:enabled, textarea:enabled, select:enabled, a:not([disabled])"));if(s=s.filter(t=>t&&(t.offsetLeft||t.offsetTop||t.offsetWidth||t.offsetHeight)).map(t=>({elem:t,ti:+t.getAttribute("tabindex")||0,active:t==i})).filter(t=>-1!==t.ti).sort((t,e)=>t.ti==e.ti?0:t.ti<e.ti?-1:1),!s.length)return;const n=t.shiftKey?-1:1;let r=s.findIndex(t=>t.active)+n;r<0?r=s.length-1:r>=s.length&&(r=0),s[r].elem.focus(),t.preventDefault()},__modalRequery(){alert("requery yet not implemented")}},computed:{isInclude:function(){return!!this.dialog.url},mwClass(){return this.modalCreated?"loaded":""},hasIcon(){return!!this.dialog.style},title:function(){return this.dialog.title?this.dialog.title:"confirm"===this.dialog.style?e.$Confirm:"info"===this.dialog.style?e.$Message:e.$Error},bodyClass(){return"modal-body "+(this.dialog.style||"")},iconClass(){let t=this.dialog.style;return"info"===t&&(t="info-blue"),"ico ico-"+t},hasList(){return this.dialog.list&&this.dialog.list.length},buttons:function(){let t=this.dialog.okText||e.$Ok,i=this.dialog.cancelText||e.$Cancel;return this.dialog.buttons?this.dialog.buttons:"alert"===this.dialog.style||"info"===this.dialog.style?[{text:t,result:!0,tabindex:1}]:[{text:t,result:!0,tabindex:2},{text:i,result:!1,tabindex:1}]}},created(){document.addEventListener("keyup",this.keyUpHandler),this.savedFocus=document.activeElement,this.savedFocus&&this.savedFocus.blur&&this.savedFocus.blur()},mounted(){setTimeout(()=>{this.modalCreated=!0},50)},destroyed(){this.savedFocus&&this.savedFocus.focus&&this.savedFocus.focus(),document.removeEventListener("keyup",this.keyUpHandler)}};app.components["std:modal"]=o}(),function(){const t={template:'<div class="wait-cursor" v-if="visible()"><div class="spinner"/></div>',props:{ready:Boolean},methods:{visible(){return!this.ready}}};Vue.component("wait-cursor",t)}(),function(){const t=require("std:eventBus"),e=window.$$locale;Vue.component("a2-wizard-panel",{template:'\n<div class="wizard-panel" :style="panelStyle">\n\t<ul class="wizard-header">\n\t\t<li v-for="(p, px) in pages" :class="pageClass(p)" @click.prevent="selectPage(p)">\n\t\t\t<a><span class="wizard-header-title" v-text="p.header"/><span class="wizard-header-descr" v-text="p.descr"></span><i v-if="p.errorIcon" class="ico ico-error-outline"></i></a>\n\t\t</li>\n\t</ul>\n\t<div class="wizard-content">\n\t\t<slot />\n\t</div>\n\t<div class="modal-footer">\n\t\t<template v-if="helpLink">\n\t\t\t<a class="btn-help" rel="help" :href="helpLink" @click.prevent="$showHelp()"><i class="ico ico-help"/><span v-text="$locale.$Help"/></a>\n\t\t\t<div class="aligner"/>\n\t\t</template>\n\t\t<button class="btn a2-inline" :disabled="backDisabled" @click.stop="back"><i class="ico ico-chevron-left"/> <span v-text="$locale.$Back"/></button>\n\t\t<button class="btn a2-inline btn-primary" @click.stop="nextFinish" :disabled="nextDisabled()"><span v-text="nextFinishText"/> <i class="ico" :class="nextFinishIco""/></button>\n\t\t<button class="btn a2-inline" @click.prevent="close" v-text="$locale.$Cancel" style="margin-left:2rem"/>\n\t</div>\n</div>\n',props:{finish:Function,helpLink:String,minHeight:String},data:()=>({pages:[],activePage:null}),computed:{$locale:()=>e,nextFinishText(){let t=this.pages;return this.activePage===t[t.length-1]?e.$Finish:e.$Next},nextFinishIco(){let t=this.pages;return this.activePage===t[t.length-1]?"ico-chevron-right-end":"ico-chevron-right"},backDisabled(){return this.activePage===this.pages[0]},panelStyle(){if(this.minHeight)return{"min-height":this.minHeight}}},methods:{nextDisabled(){return!!this.activePage&&!!this.activePage.$invalid()},setActivePage(t){this.activePage&&(this.activePage.visit=!0),this.activePage=t,this.activePage.state="edit"},selectPage(t){!this.$nextPage(t)||this.nextDisabled()?t.visit&&this.setActivePage(t):this.setActivePage(t)},pageClass(t){let e="";if(!t.visit){if(this.$nextPage(t)&&!this.nextDisabled())return e;e="disabled"}return t===this.activePage?e="active":t.wasInvalid&&(e="invalid"),e},close(){t.$emit("modalClose")},back(){let t=this.pages,e=t.indexOf(this.activePage);e<=0||this.setActivePage(t[e-1])},nextFinish(){if(this.nextDisabled())return;let t=this.pages,e=t.indexOf(this.activePage);e===t.length-1?this.finish?this.finish():console.error("The FinishCommand is not specified"):this.setActivePage(t[e+1])},$nextPage(t){let e=this.pages.indexOf(this.activePage);return this.pages.indexOf(t)===e+1},$addPage(t){this.pages.push(t)},$removePage(t){let e=this.pages.indexOf(t);-1!==e&&this.pages.splice(e,1)},$showHelp(){this.helpLink&&window.open(this.helpLink,"_blank")},_pendingValidate(){this.$forceUpdate()}},mounted(){this.pages.length>0&&(this.activePage=this.pages[0],this.activePage.state="edit")},created(){t.$on("pendingValidate",this._pendingValidate)},beforeDestroy(){t.$off("pendingValidate",this._pendingValidate)}}),Vue.component("a2-wizard-page",{template:'\n<div class="wizard-page" v-if="isActive">\n\t<slot />\n</div>\n',props:{header:String,descr:String},data:()=>({controls:[],state:"init",wasInvalid:!1,visit:!1}),computed:{isActive(){return this===this.$parent.activePage},isNextPage(){return $parent.$nextPage(this)},errorIcon(){return!!this.visit&&this.wasInvalid}},methods:{$invalid(){if(!this.controls.length)return this.wasInvalid=!1,!1;for(let t of this.controls)if(t.invalid())return this.wasInvalid=!0,!0;return this.wasInvalid=!1,!1},$registerControl(t){this.controls.push(t)},$unregisterControl(t){let e=this.controls.indexOf(t);-1!==e&&this.controls.splice(e,1)}},created(){this.$parent.$addPage(this)},beforeDestroy(){this.controls.splice(0,this.controls.length)},destroyed(){this.$parent.$removePage(this)}})}(),function(){window.$$locale;const t=require("std:eventBus"),e={template:'\n<div class="toastr-stack" >\n\t<transition-group name="list" tag="ul">\n\t\t<a2-toast v-for="(t, k) in items":toast="t" :key="t.$index"></a2-toast>\n\t</transition-group>\n</div>\n',components:{"a2-toast":{template:'\n<li class="toast" :class="toast.style">\n\t<i class="ico" :class="icoCssClass"></i>\n\t<span v-text="toast.text" />\n</li>\n',props:{toast:Object},computed:{icoCssClass(){switch(this.toast.style){case"success":return"ico-check";case"danger":case"error":return"ico-error-outline-nocolor";case"warning":return"ico-warning-outline";case"info":return"ico-info-outline"}return"ico-dot"}}}},props:{},data:()=>({items:[],currentIndex:0}),methods:{showToast(t){t.$index=++this.currentIndex,this.items.unshift(t),setTimeout(()=>{this.removeToast(t.$index)},2e3)},removeToast(t){let e=this.items.findIndex(e=>e.$index===t);-1!==e&&this.items.splice(e,1)}},created(){t.$on("toast",this.showToast)}};app.components["std:toastr"]=e}(),function(){const t=require("std:url"),e=require("std:utils"),i=window.$$locale;Vue.component("a2-image",{template:'\n<div class="a2-image">\n\t<img v-if="hasImage" :src="href" :style="cssStyle" @click.prevent="clickOnImage"/>\n\t<a class="remove-image" v-if="hasRemove" @click.prevent="removeImage">&#x2715;</a>\n\t<a2-upload v-if="isUploadVisible" :style=uploadStyle accept="image/*"\n\t\t:item=itemForUpload :base=base :prop=prop :new-item=newItem :tip=tip :read-only=readOnly :limit=limit :icon=icon></a2-upload>\n</div>\n',props:{base:String,item:Object,prop:String,newItem:Boolean,inArray:Boolean,source:Array,width:String,height:String,readOnly:Boolean,limit:Number,placeholder:String,icon:String},data:()=>({newElem:{}}),computed:{href:function(){if(this.newItem)return;let e=window.$$rootUrl,i=this.item[this.prop];if(!i)return;let s={};return this.item._meta_&&this.item._meta_.$token&&(s.token=this.item[this.item._meta_.$token]),t.combine(e,"_image",this.base,this.prop,i)+t.makeQueryString(s)},tip(){return this.readOnly||this.placeholder?this.placeholder:i.$ClickToDownloadPicture},cssStyle(){return{maxWidth:this.width,maxHeight:this.height}},uploadStyle(){let t={width:this.width,height:this.height};return t.width||(t.width=t.height),t.height||(t.height=t.width),t},hasImage(){return!!this.href},hasRemove(){return!this.readOnly&&this.hasImage},isUploadVisible:function(){return!!this.newItem||(this.readOnly?!this.hasImage:!this.inArray&&!this.item[this.prop])},itemForUpload(){return this.newItem?this.newElem:this.item}},methods:{removeImage:function(){this.inArray?this.item.$remove():this.item[this.prop]=void 0},clickOnImage:function(){}},created(){this.newItem&&this.source&&this.source.$new&&(this.newElem=this.source.$new())}}),Vue.component("a2-static-image",{template:'<img :src="href" :alt="alt"/>',props:{url:String,alt:String},computed:{href:function(){let e=window.$$rootUrl;return t.combine(e,"_static_image",this.url.replace(/\./g,"-"))}}}),Vue.component("a2-file-image",{template:'<img :src="href" :style="cssStyle" />',props:{url:String,width:String,height:String,value:[String,Number,Object]},computed:{href:function(){let i=window.$$rootUrl,s=this.value,n={};return e.isObjectExact(this.value)&&(s=e.getStringId(this.value),this.value._meta_&&this.value._meta_.$token&&(n.token=this.value[this.value._meta_.$token])),t.combine(i,"_file",this.url,s)+t.makeQueryString(n)},cssStyle(){let t={};return this.width&&(t.maxWidth=this.width),this.height&&(t.maxHeight=this.height),t}}})}(),function(){const t=require("std:url"),e=require("std:http"),i=window.$$locale,s=require("std:tools");Vue.component("a2-file-upload",{template:'\n<div class="a2-file-upload">\n<label :class="cssClass" @dragover.prevent="dragOver" @dragleave.prevent="dragLeave">\n\t<input v-if=\'canUpload\' type="file" @change="uploadFile" v-bind:multiple="isMultiple" :accept="accept" ref="inputFile"/>\n\t<i class="ico ico-upload"></i>\n\t<span class="upload-tip" v-text="tip" v-if="tip"></span>\n</label>\n</div>\n',data:()=>({hover:!1}),props:{accept:String,url:String,source:Object,delegate:Function,errorDelegate:Function,argument:[Object,String,Number],limit:Number},computed:{cssClass(){return"file-upload"+(this.hover?" hover":"")},canUpload:()=>!0,isMultiple:()=>!1,tip(){return this.readOnly?"":i.$ClickToDownloadFile}},methods:{dragOver(t){this.hover=!0},dragLeave(t){this.hover=!1},checkLimit(t){if(!this.limit)return!1;return t.size/1024>this.limit},uploadFile(n){let r=window.$$rootUrl,o=t.combine(r,"_file",this.url),a=this.argument?Object.assign({},this.argument):{Id:1};o=t.createUrlForNavigate(o,a);var l=new FormData;for(let t of n.target.files){if(this.checkLimit(t)){n.target.value="";let t=i.$FileTooLarge.replace("{0}",this.limit);return void s.alert(t)}l.append("file",t,t.name)}this.$refs.inputFile.value="",e.upload(o,l).then(t=>{n.target.value="",this.delegate&&this.delegate(t)}).catch(t=>{this.errorDelegate?this.errorDelegate(t):0===t.indexOf("UI:")?s.alert(t.substring(3).replace("\\n","\n")):alert(t)})}}})}(),Vue.component("a2-taskpad",{template:'<div :class="cssClass">\n\t<a class="ico taskpad-collapse-handle" @click.stop="toggle"></a>\n\t<div v-if="expanded" class="taskpad-body">\n\t\t<slot>\n\t\t</slot>\n\t</div>\n\t<div v-else class="taskpad-title" @click.prevent="toggle">\n\t\t<span class="taskpad-label" v-text="tasksText"></span>\n\t</div>\n</div>\n',props:{title:String,initialCollapsed:Boolean},data:()=>({expanded:!0,__savedCols:""}),computed:{cssClass(){let t="taskpad";return this.expanded?t+=" expanded":t+=" collapsed",t},tasksText(){return this.title||window.$$locale.$Tasks}},methods:{setExpanded(t){this.expanded=t;let e=this.$el.parentElement.style;this.expanded?e.gridTemplateColumns=this.__savedCols:e.gridTemplateColumns="1fr 36px"},toggle(){this.setExpanded(!this.expanded)}},mounted(){let t=this.$el.parentElement.style;this.__savedCols=t.gridTemplateColumns,this.initialCollapsed&&this.setExpanded(!1)}}),Vue.component("a2-panel",{template:'<div :class="cssClass" :test-id="testId">\n\t<div class="panel-header" @click.prevent="toggle" v-if="!noHeader">\n\t\t<slot name=\'header\'></slot>\n\t\t<span v-if="collapsible" class="ico panel-collapse-handle"></span>\n\t</div>\n\t<slot v-if="expanded"></slot>\n</div>\n',props:{initialCollapsed:Boolean,collapsible:Boolean,panelStyle:String,noHeader:Boolean,testId:String},data(){return{collapsed:this.initialCollapsed}},computed:{cssClass(){let t="panel";if(this.collapsed?t+=" collapsed":t+=" expanded",this.panelStyle){let e=this.panelStyle.toLowerCase();switch(e){case"red":case"danger":case"error":t+=" panel-red";break;case"info":case"cyan":t+=" panel-cyan";break;case"green":case"success":t+=" panel-green";break;case"warning":case"yellow":t+=" panel-yellow";break;default:t+=" panel-"+e}}return t},expanded(){return!this.collapsed}},methods:{toggle(){this.collapsible&&(this.collapsed=!this.collapsed)}}}),function(){const t=require("std:eventBus");Vue.component("a2-inline-dialog",{template:'<div class="inline-modal-wrapper modal-animation-frame" v-if="visible" :class="{show: open}" v-cloak>\n\t<div class="modal-window modal-animation-window" :class="{loaded: open}" :style="dlgStyle">\n\t\t<slot></slot>\n\t</div>\n</div>\n',props:{dialogId:String,dialogTitle:String,width:String,noClose:Boolean},data:()=>({visible:!1,open:!1}),computed:{dlgStyle(){if(this.width)return{width:this.width}}},methods:{__keyUp(e){this.noClose||27===e.which&&(t.$emit("inlineDialog",{cmd:"close",id:this.dialogId}),e.stopPropagation(),e.preventDefault())},__inlineEvent(t){if(t&&t.id===this.dialogId)switch(t.cmd){case"close":if(window.__requestsCount__>0)return;this.open=!1,this.visible=!1,document.removeEventListener("keyup",this.__keyUp);break;case"open":this.visible=!0,document.addEventListener("keyup",this.__keyUp),setTimeout(()=>{this.open=!0},50);break;default:console.error(`invalid inline command '${t.cmd}'`)}}},created(){t.$on("inlineDialog",this.__inlineEvent)},beforeDestroy(){t.$off("inlineDialog",this.__inlineEvent)}})}(),Vue.component("a2-sheet",{template:'\n<table class="sheet">\n\t<slot name="columns"></slot>\n\t<thead>\n\t\t<slot name="header"></slot>\n\t</thead>\n\t<slot name="col-shadow"></slot>\n\t<slot name="body"></slot>\n\t<tfoot>\n\t\t<slot name="footer"></slot>\n\t</tfoot>\n</table>\n'}),Vue.component("a2-sheet-section",{template:"\n<tbody>\n\t<slot></slot>\n</tbody>\n"}),Vue.component("a2-sheet-section-tree",{functional:!0,name:"a2-sheet-section",props:{itemsSource:Object,propName:String},render(t,e){const i=e.props.propName,s=e.props.itemsSource;if(!s)return;if(!i)return;function n(){let t=this.item.$collapsed||!1;Vue.set(this.item,"$collapsed",!t)}function r(){let t="";return this.hasChildren()&&(t+="has-children"),this.item.$collapsed&&(t+=" collapsed"),t+=" lev-"+this.item.$level,t}function o(){let t="";return this.hasChildren()&&(t+=" group"),this.item.$collapsed&&(t+=" collapsed"),t}function a(){return"indent lev-"+this.item.$level}function l(){let t=this.item[i];return t&&t.length>0}const d=e.data.scopedSlots.default;let c=[];for(let e of function*t(e,i,s){if(i in e){let n=e[i];for(let e=0;e<n.length;e++){let r=n[e];r.$level=s,yield r,r.$collapsed||(yield*t(r,i,s+1))}}}(s,i,1)){let i=d({item:e,toggle:n,cssClass:r,hasChildren:l,rowCssClass:o,indentCssClass:a})[0];c.push(t(i.tag,i.data,i.children))}return t("tbody",{},c)}}),function(){const t=component("std:store"),e=(require("std:url"),require("std:eventBus"));Vue.component("a2-new-button",{template:'<div class="dropdown dir-down a2-new-btn separate" v-dropdown v-if="isVisible">\n\t<button class="btn btn-icon" :class="btnClass" toggle aria-label="New"><i class="ico" :class="iconClass"></i></button>\n\t<div class="dropdown-menu menu down-left">\n\t\t<div class="super-menu" :class="cssClass">\n\t\t\t<div v-for="(m, mx) in topMenu" :key="mx" class="menu-group">\n\t\t\t\t<div class="group-title" v-text="m.Name"></div>\n\t\t\t\t<template v-for="(itm, ix) in m.Menu">\n\t\t\t\t\t<div class="divider" v-if=isDivider(itm)></div>\n\t\t\t\t\t<a v-else @click.prevent=\'doCommand(itm.Url, itm.Params)\' \n\t\t\t\t\t\tclass="dropdown-item" tabindex="-1"><i class="ico" :class="\'ico-\' + itm.Icon"></i><span v-text="itm.Name"></span></a>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n',store:t,props:{menu:Array,icon:String,btnStyle:String},computed:{isVisible(){return!!this.menu},topMenu(){return this.menu?this.menu[0].Menu:null},iconClass(){return this.icon?"ico-"+this.icon:""},btnClass(){return this.btnStyle?"btn-"+this.btnStyle:""},columns(){let t=this.menu?this.menu[0].Params:"";if(!t)return 1;try{return+JSON.parse(t).columns||1}catch(t){return 1}},cssClass(){return"cols-"+this.columns}},created(){},methods:{isDivider:t=>"-"===t.Name,doCommand(t,e){let i=!1;if(e)try{i=JSON.parse(e).requeryAfter}catch(t){i=!1}(t=t||"").startsWith("navigate:")?this.navigate(t.substring(9)):t.startsWith("dialog:")?this.dialog(t.substring(7),i):alert("invalid command:"+t)},navigate(t){this.$store.commit("navigate",{url:t})},dialog(t,i){const s={promise:null};e.$emit("modaldirect",t,s),s.promise.then((function(n){i&&e.$emit("requery",t,s)}))}}})}(),Vue.component("a2-company-button",{template:'<div class="a2-company-btn"><div class="dropdown dir-down separate" v-dropdown v-if="isVisible">\n\t<button class="btn btn-companyname" toggle aria-label="Company">\n\t\t<i class="ico ico-home"></i>\n\t\t<span class="company-name" v-text=companyName></span>\n\t\t<span class="caret"/>\n\t</button>\n\t<div class="dropdown-menu menu down-left">\n\t\t<a v-for="comp in source" @click.prevent="selectCompany(comp)" href="" tabindex="-1" class="dropdown-item">\n\t\t\t<i class="ico" :class="icoClass(comp)"/><span class="company-menu-name" v-text="comp.Name"/>\n\t\t</a>\n\t\t<template v-if="hasLinks">\n\t\t\t<div class="divider"/>\n\t\t\t<a v-for="link in links" @click.prevent="gotoLink(link)" href="" tabindex="-1" class="dropdown-item">\n\t\t\t\t<i class="ico" :class="linkClass(link)"/><span v-text="link.Name" />\n\t\t\t</a>\n\t\t</template>\n\t</div>\n</div></div>\n',props:{source:Array,links:Array},computed:{isVisible(){return this.source.length>0},hasLinks(){return this.links&&this.links.length},companyName(){if(0===this.source.length)return"";let t=this.source.find(t=>t.Current);return t?t.Name:"*** UNSELECTED ***"}},methods:{selectCompany(t){const e=require("std:http"),i=require("std:url"),s=window.$$rootUrl,n=JSON.stringify({company:t.Id});e.post(i.combine(s,"_application/switchtocompany"),n).then(t=>{window.location.assign(i.combine(s,"/"))}).catch(t=>{alert(t)})},gotoLink(t){const e=component("std:store");e&&e.commit("navigate",{url:t.Url})},icoClass:t=>t.Current?"ico-check":"ico-none",linkClass:t=>"ico-"+(t.Icon||"none")}}),function(){let t=1237;Vue.component("a2-graphics",{template:'<div :id="id" class="a2-graphics" ref=canvas></div>',props:{render:Function,arg:[Object,String,Number,Array,Boolean,Date],watchmode:String},data:()=>({unwatch:null,id:(t+=1,"el-gr-"+t)}),computed:{controller(){return this.$root}},methods:{draw(){const t=this.$refs.canvas,e=d3.select(t);e.selectAll("*").remove(),this.render.call(this.controller.$data,e,this.arg,t)}},mounted(){if(this.$nextTick(()=>this.draw()),"none"===this.watchmode)return;let t="deep"===this.watchmode;this.unwatch=this.$watch("arg",()=>this.draw(),{deep:t})},beforeDestroy(){this.unwatch&&this.unwatch();d3.select("#"+this.id).selectAll("*").remove(),this.$el.remove()}})}(),function(){const t=require("std:http"),e=require("std:url"),i=require("std:eventBus"),s=window.$$locale,n=require("std:utils").date.isZero,r={$vm:null,$ctrl:null,$host:null,$root:null,$parent:null,$items:null};const o={name:"a2-trace-item",template:'\n<div v-if="hasElem" class="trace-item-body">\n\t<span class="title" v-text="name"/><span class="badge" v-text="elem.length"/>\n\t<ul class="a2-debug-trace-item">\n\t\t<li v-for="itm in elem">\n\t\t\t<div class="rq-title"><span class="elapsed" v-text="itm.elapsed + \' ms\'"/> <span v-text="itm.text"/></div>\n\t\t</li>\n\t</ul>\n</div>',props:{name:String,elem:Array},computed:{hasElem(){return this.elem&&this.elem.length}}};Vue.component("a2-debug",{template:'\n<div class="debug-panel" v-if="paneVisible" :class="panelClass">\n\t<div class="debug-pane-header">\n\t\t<span class="debug-pane-title" v-text="title"></span>\n\t\t<a class="btn btn-close" @click.prevent="close">&#x2715</a>\n\t</div>\n\t<div class="toolbar">\n\t\t<button class="btn btn-tb" @click.prevent="refresh"><i class="ico ico-reload"></i> {{text(\'$Refresh\')}}</button>\n\t\t<div class="aligner"></div>\n\t\t<button class="btn btn-tb" @click.prevent="toggle"><i class="ico" :class="toggleIcon"></i></button>\n\t</div>\n\t<div class="debug-model debug-body" v-if="modelVisible">\n\t\t<pre class="a2-code" v-text="modelJson()"></pre>\n\t</div>\n\t<div class="debug-trace debug-body" v-if="traceVisible">\n\t\t<ul class="a2-debug-trace">\n\t\t\t<li v-for="r in trace">\n\t\t\t\t<div class="rq-title"><span class="elapsed" v-text="r.elapsed + \' ms\'"/> <span v-text="r.url" /></div>\n\t\t\t\t<a2-trace-item name="Sql" :elem="r.items.Sql"></a2-trace-item>\n\t\t\t\t<a2-trace-item name="Render" :elem="r.items.Render"></a2-trace-item>\n\t\t\t\t<a2-trace-item name="Report" :elem="r.items.Report"></a2-trace-item>\n\t\t\t\t<a2-trace-item name="Workflow" :elem="r.items.Workflow"></a2-trace-item>\n\t\t\t\t<a2-trace-item class="exception" name="Exceptions" :elem="r.items.Exception"></a2-trace-item>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</div>\n',components:{"a2-trace-item":o},props:{modelVisible:Boolean,traceVisible:Boolean,modelStack:Array,counter:Number,close:Function},data:()=>({trace:[],left:!1}),computed:{refreshCount(){return this.counter},paneVisible(){return this.modelVisible||this.traceVisible},title(){return this.modelVisible?s.$DataModel:this.traceVisible?s.$Profiling:""},traceView(){return this.traceVisible},toggleIcon(){return this.left?"ico-pane-right":"ico-pane-left"},panelClass(){return this.left?"left":"right"}},methods:{modelJson(){var t;if(this.modelVisible)return this.modelStack.length?(t=this.modelStack[0].$data,JSON.stringify(t,(function(t,e){return"$"===t[0]?t in r?void 0:e:"_"!==t[0]?n(this[t])?null:e:void 0}),2)):""},refresh(){this.modelVisible?this.$forceUpdate():this.traceVisible&&this.loadTrace()},toggle(){this.left=!this.left},loadTrace(){const i=window.$$rootUrl,s=e.combine(i,"_shell/trace"),n=this;t.post(s,null,null,!0).then((function(t){n.trace.splice(0,n.trace.length),t&&t.forEach(t=>{n.trace.push(t)})}))},text:t=>s[t]},watch:{refreshCount(){this.$forceUpdate()},traceView(t){t&&this.loadTrace()}},created(){i.$on("endRequest",t=>{-1===t.indexOf("/_shell/trace")&&this.traceVisible&&this.loadTrace()})}})}(),function(){const t=require("std:dataservice"),e=require("std:url"),i=window.$$locale,s=require("std:utils");Vue.component("a2-feedback",{template:'\n<div class="feedback-panel" v-if="visible">\n    <div class="feedback-pane-header">\n        <span class="feedback-pane-title" v-text="source.title"></span>\n        <a class="btn btn-close" @click.prevent="close">&#x2715</a>\n    </div>\n    <div class="feedback-body">\n\t\t<template v-if="shown">\n\t\t\t<div v-html="source.promptText"></div>\n\t\t\t<div style="margin-bottom:20px" />\n\t\t\t<div class="control-group" style="">\n\t\t\t\t<label v-html="source.labelText" /> \n\t\t\t\t<div class="input-group">\n\t\t\t\t\t<textarea rows="5" maxlength="2048" v-model="value" style="height: 92px;max-height:400px" v-auto-size="true" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button class="btn btn-primary" :disabled="noValue" @click.prevent="submit" v-text="source.buttonText" />\n\t\t\t<include v-if="source.externalFragment" :src="source.externalFragment"/>\n\t\t\t\n\t\t</template>\n\t\t<template v-else>\n\t\t\t<div class="thanks" v-html="source.thanks" />\n\t\t\t<button class="btn btn-primary" @click.prevent="close" v-text="closeText" />\n\t\t</template>\n\t</div>\n</div>\n',components:{},props:{visible:Boolean,modelStack:Array,close:Function,source:Object},data:()=>({value:"",shown:!0}),computed:{noValue(){return!this.value},closeText:()=>i.$Close},methods:{text:t=>i[t],refresh(){},loadfeedbacks(){},submit(){const i=window.$$rootUrl,n=e.combine(i,"_shell/savefeedback"),r=this;let o=s.toJson({text:this.value});t.post(n,o).then((function(t){r.shown=!1,r.value=""})).catch((function(t){console.dir(t),r.$parent.$alert(r.source.alert),r.close()}))}},watch:{visible(t){t&&(this.shown=!0,this.value="",this.loadfeedbacks())}},created(){}})}(),function(){const t={render:()=>null,props:["page-title"],watch:{pageTitle(t){this.setTitle()}},methods:{setTitle(){this.pageTitle&&(document.title=this.pageTitle)}},created(){this.setTitle()}};app.components["std:doctitle"]=t}(),Vue.component("a2-span-sum",{props:{content:[String,Number],dir:Number},render(t,e){let i=[];i.push(t("span",{domProps:{innerText:this.content}}));let s="span-sum ";return this.dir>0?(i.push(t("i",{class:"ico ico-arrow-up-green"})),s+="in"):this.dir<0?(i.push(t("i",{class:"ico ico-arrow-down-red"})),s+="out"):0===this.dir&&(i.push(t("i",{class:"ico ico-arrow-sort"})),s+="inout"),t("span",{class:s},i)}}),function(){const t=require("std:utils");Vue.component("mega-menu",{template:'<div class="dropdown-menu menu" role="menu">\n\t<div class="super-menu" :class="cssClass" :style="cssStyle">\n\t\t<div v-for="(m, mx) of topMenu" :key="mx" class="menu-group">\n\t\t\t<div class="group-title" v-text="m.Name"></div>\n\t\t\t<template v-for="(itm, ix) in m.menu">\n\t\t\t\t<div class="divider" v-if=isDivider(itm) ></div>\n\t\t\t\t<slot name="item" :menuItem="itm" v-else></slot>\n\t\t\t</template>\n\t\t</div>\n\t</div>\n</div>\n',props:{itemsSource:Array,groupBy:String,columns:Number,width:String},data:()=>({}),computed:{cssClass(){let t="cols-"+(this.columns||1);return this.width&&(t+=" with-width"),t},cssStyle(){if(this.width)return{width:this.width}},topMenu(){return this.itemsSource?this.itemsSource.reduce((e,i)=>{let s=t.simpleEval(i,this.groupBy)||"",n=e[s];return n?n.menu.push(i):e[s]={Name:s,menu:[i]},e},{}):{}}},methods:{isDivider:t=>"-"===t.Name}})}(),function(){const t=require("std:eventBus");Vue.component("a2-iframe-target",{template:'\n<div class="frame-stack" v-if="visible">\n\t<iframe width="100%" height="100%" :src="iFrameUrl" frameborder="0" />\n</div>\n',data:()=>({iFrameUrl:""}),computed:{visible(){return!!this.iFrameUrl}},created(){t.$on("openframe",t=>{alert(t),this.iFrameUrl=t})}})}(),Vue.directive("autoSize",{bind(t,e,i){e.value&&(t.style.overflowY=!1,t._ops={initHeight:-1,extraSpace:0},t._autosize=function(){if(!t.offsetHeight)return;const e=t._ops;-1===e.initHeight&&(e.initHeight=t.offsetHeight),t.style.height=e.initHeight+"px";var i=t.scrollHeight+e.extraSpace;i>e.initHeight&&(t.style.height=i+"px")},t.addEventListener("input",(function(){t._autosize()})),t.addEventListener("autosize",(function(){Vue.nextTick(()=>t._autosize())})))},inserted(t,e){if(!e.value)return;let i=window.getComputedStyle(t),s=parseFloat(i.borderTopWidth)+parseFloat(i.borderBottomWidth);t._ops.extraSpace=s,setTimeout(()=>t._autosize(),1)}}),Vue.directive("disable",{bind(t,e,i){t.addEventListener("click",(function(t){if(this.getAttribute("disabled"))return t.preventDefault(),t.stopImmediatePropagation(),!1}),!0)}}),Vue.directive("dropdown",{bind(t,e,i){const s=require("std:popup");t._btn=t.querySelector("[toggle]"),t.setAttribute("dropdown-top",""),t._btn||console.error("DropDown does not have a toggle element"),s.registerPopup(t),t._close=function(e){t._hide&&t._hide(),t.classList.remove("show")},t.addEventListener("click",(function(e){let i=e.target;if(!t._btn.disabled){for(;i&&i!==t._btn;){if(i===t)return;i=i.parentElement}if(i===t._btn){if(e.preventDefault(),e.stopPropagation(),t.classList.contains("show"))t._hide&&t._hide(),t.classList.remove("show");else{let e=s.closest(t,".popup-body");e?s.closeInside(e):s.closeAll(),t._show&&t._show(),t.classList.add("show")}}}}))},unbind(t){require("std:popup").unregisterPopup(t)}}),Vue.directive("focus",{bind(t,e,i){function s(t){t.select&&(t._selectDone||(t.select(),t._selectDone=!0))}t.addEventListener("focus",(function(e){if(e.target.parentElement.classList.add("focus"),t.__opts&&t.__opts.mask)return;let i=e.target;i._selectDone=!1,setTimeout(()=>{s(i)},0)}),!1),t.addEventListener("blur",(function(t){let e=t.target;e._selectDone=!0,e.parentElement.classList.remove("focus")}),!1),t.addEventListener("click",(function(e){t.__opts&&t.__opts.mask||s(e.target)}),!1)},inserted(t){t._selectDone=!1,1===t.tabIndex&&setTimeout(()=>{t.focus&&t.focus(),t.select&&t.select()},0)}}),Vue.directive("settabindex",{inserted(t){1===t.tabIndex&&setTimeout(()=>{t.focus&&t.focus()},0)}}),function(){function t(t){t&&t.$loadLazy&&t.$loadLazy()}Vue.directive("lazy",{componentUpdated(e,i,s){t(i.value)},inserted(e,i,s){t(i.value)}})}(),function(){const t=Symbol();let e=null,i=null;function s(t){if(!e)return null;let i=`@media print {@page {size: ${e.pageSize||"A4"} ${e.orientation}; margin:${e.margin};}`;return(t=t||e.zoom)&&(i+=`.sheet-page > .sheet { zoom: ${t}; width: 1px;} .print-target {zoom: ${t}}`),i+="}",i}function n(t){if(function(){let t=document.getElementsByClassName("with-wrapper");if(t&&t.length){t[0].scrollTo(0,0)}}(),!e)return;if("auto"!=e.zoom)return;let n=document.getElementsByClassName("sheet");if(!n||!n.length)return;let r=n[0],o={w:210,h:297},a=10,l=10,d=10,c=10;"landscape"===e.orientation&&([o.w,o.h]=[o.h,o.w]);let u=function(){let t=document.createElement("div");t.classList.add("mm-100-100"),document.body.appendChild(t);let e={w:(t.clientWidth-5)/100,h:(t.clientHeight-5)/100};return document.body.removeChild(t),e}(),h=r.clientWidth/u.w,p=r.clientHeight/u.h,m=(o.w-c-l-5)/h,f=(o.h-a-d-5)/p,g=Math.round(1e3*Math.min(m,f))/1e3;i.innerHTML=s(g)}Vue.directive("page-orientation",{bind(s,n){e=null,i=null;let r=document.createElement("style");r.innerHTML=`@page {size: A4 ${n.value}; margin:1cm;}`,document.head.appendChild(r),s[t]=r},unbind(e){let i=e[t];i&&document.head.removeChild(i)}}),Vue.directive("print-page",{bind(r,o){let a=o.value;e=a;let l=s();if(l){let e=document.createElement("style");e.innerHTML=l,i=document.head.appendChild(e),r[t]=e}window.addEventListener("beforeprint",n)},unbind(e){let i=e[t];i&&document.head.removeChild(i),window.removeEventListener("beforeprint",n)}})}(),Vue.directive("resize",{unbind(t,e,i){let s=t._parts;s.mouseDown&&t.removeEventListener("mousedown",s.mouseDown,!1)},update(t){if(!t._parts)return;let e=t._parts;if(e.init)return;e.init=!0;let i=t.getAttribute("data-min-width"),s=t.getAttribute("second-min-width"),n=t.getAttribute("first-pane-width");e.minWidth=o(e.grid,i),e.minWidth2=o(e.grid,s),e.firstWidth=o(e.grid,n);let r=Math.max(e.minWidth,e.firstWidth);function o(t,e){if(-1!==(e=e||"").indexOf("px"))return Number.parseFloat(e);let i=document.createElement("div");i.style.width=e,i.style.position="absolute",i.style.visibility="hidden",document.body.appendChild(i);let s=i.clientWidth;return i.remove(),s?isNaN(s)?20:s:20}e.grid.style.gridTemplateColumns=`${r}px ${e.handleWidth}px 1fr`,e.grid.style.visibility="visible"},inserted(t,e,i){let s=t.parentElement,n={handleWidth:6,grid:s,handle:findHandle(s),resizing:!1,firstWidth:0,minWidth:0,minWidth2:0,delta:0,mouseDown:a,init:!1,offsetX(t,e){let i=this.delta,s=this.grid.getBoundingClientRect();if(e){let e=t.target.getBoundingClientRect();i=t.clientX-e.left,this.delta=i}return t.clientX-s.left-i},fitX(t){t<this.minWidth&&(t=this.minWidth);let e=this.grid.clientWidth;return t+this.handleWidth+this.minWidth2>e&&(t=e-this.minWidth2-this.handleWidth),t}};function r(e){let i=t._parts;if(!i.resizing)return;e.preventDefault(),i.handle.style.display="none",i.grid.style.cursor="default";let s=i.offsetX(e,!1);s=i.fitX(s),i.grid.style.gridTemplateColumns=`${s}px ${i.handleWidth}px 1fr`,document.removeEventListener("mouseup",r),document.removeEventListener("mousemove",o),i.resizing=!1}function o(e){let i=t._parts;if(!i.resizing)return;e.preventDefault();let s=i.offsetX(e,!1);s=i.fitX(s),i.handle.style.left=s+"px"}function a(e){let i=t._parts;if(i.resizing)return;if(!i.handle)return;if(!e.target.classList.contains("spl-handle"))return void console.error("click out of splitter handle");e.preventDefault();let s=i.offsetX(e,!0);i.handle.style.left=s+"px",i.handle.style.display="block",i.grid.style.cursor="w-resize",document.addEventListener("mouseup",r,!1),document.addEventListener("mousemove",o,!1),i.resizing=!0}t._parts=n,t.addEventListener("mousedown",a,!1)}}),function(){const t=require("std:eventBus"),e=require("std:utils"),i=require("std:dataservice"),s=require("std:url"),n=require("std:log",!0),r=window.$$locale,o=require("std:mask"),a=require("std:modelInfo"),l=require("std:platform"),d=require("std:html",!0),c=component("std:store"),u=component("std:doctitle",!0);let h=0,p=0;function m(e,i,s,n){return new Promise((function(r,o){const a={promise:null,data:i,query:s,rd:!0};t.$emit("modal",e,a),a.promise.then((function(t){n(t),r(t)}))}))}function f(t){let e=[];for(let i of t)for(let t of i.e)e.push(t.msg);return e.length?e:null}function g(t,i){if(t&&t.checkPermission&&e.isObjectExact(i)&&i.$permissions){let e=i.$permissions,s=t.checkPermission;if(s in e){if(!e[s])return!0}else console.error(`invalid permssion name: '${s}'`)}return!1}const v=Vue.extend({store:c,components:{"a2-document-title":u},data:()=>({__init__:!0,__baseUrl__:"",__baseQuery__:{},__requestsCount__:0,__lockQuery__:!0,__testId__:null}),computed:{$baseUrl(){return this.$data.__baseUrl__},$baseQuery(){return this.$data.__baseQuery__},$indirectUrl(){return this.$data.__modelInfo.__indirectUrl__||""},$query(){return this.$data._query_},$jsonQuery(){return e.toJson(this.$data.Query)},$isDirty(){return this.$data.$dirty},$isPristine(){return!this.$data.$dirty},$isLoading(){return this.$data.__requestsCount__>0},$modelInfo(){return this.$data.__modelInfo},$canSave(){return this.$isDirty&&!this.$isLoading}},watch:{$jsonQuery(t,e){this.$nextTick(()=>this.$reload())}},methods:{$marker:()=>!0,$exec(t,e,i,s){if(this.$isReadOnly(s))return;if(this.$isLoading)return;if(g(s,e))return void this.$alert(r.$PermissionDenied);return this.$data._exec_(t,e,i,s)},$toJson:t=>e.toJson(t),$maxChars:(t,i)=>e.text.maxChars(t,i),$isReadOnly(t){return t&&t.checkReadOnly&&this.$data.$readOnly},$execSelected(t,i,s){if(this.$isLoading)return;let n=this.$data;e.isArray(i)?s?this.$confirm(s).then(()=>n._exec_(t,i.$selected)):n._exec_(t,i.$selected):console.error("Invalid argument for $execSelected")},$canExecute(t,e,i){if(this.$isReadOnly(i))return!1;return this.$data._canExec_(t,e,i)},$setCurrentUrl(e){this.inDialog&&(e=s.combine("_dialog",e)),this.$data.__baseUrl__=e,t.$emit("modalSetBase",e)},$save(t){if(this.$data.$readOnly)return;let n=this;let o=`${window.$$rootUrl}/${require("std:routing").dataUrl()}/save`,a=this.$indirectUrl||this.$baseUrl;const l=this.$data.$isCopy;if(!!t&&t.options&&t.options.validRequired&&this.$data.$invalid){let t=f(this.$data.$forceValidate());return void this.$alert(r.$MakeValidFirst,void 0,t)}n.$data.$emit("Model.beforeSave",n.$data);let d=n.$data._saveSelections();return new Promise((function(r,c){let u=e.toJson({baseUrl:a,data:n.$data}),h=s.isNewPath(n.$baseUrl);i.post(o,u).then((function(e){if(n.__destroyed__)return;let i,o;n.$data.$merge(e,!0,!0),n.$data.$emit("Model.saved",n.$data),n.$data.$setDirty(!1);for(let t in e)if(i=e[t],o=n.$data[t].$id,i)break;h&&o?(n.inDialog||n.$store.commit("setnewid",{id:o}),n.$data.__baseUrl__=s.replaceSegment(n.$data.__baseUrl__,o)):l&&(n.inDialog||n.$store.commit("setnewid",{id:o,action:"edit"}),n.$data.__baseUrl__=s.replaceSegment(n.$data.__baseUrl__,o,"edit")),n.$data._restoreSelections(d),r(i);let a=t&&t.toast?t.toast:null;a&&n.$toast(a),n.$notifyOwner(o,a)})).catch((function(t){n.$alertUi(t)}))}))},$notifyOwner(t,e){if(!window.opener)return;if(!window.$$token)return;let i=window.opener.require;if(!i)return;const s=i("std:eventBus");if(!s)return;let n={token:window.$$token.token,update:window.$$token.update,toast:e||null,id:t};s.$emit("childrenSaved",n)},$invoke(t,n,r,o){let a=this;let l=`${window.$$rootUrl}/${require("std:routing").dataUrl()}/invoke`,d=a.$indirectUrl||a.$baseUrl;return r&&(d=s.combine("_page",r,"index",0)),new Promise((function(s,r){var c=e.toJson({cmd:t,baseUrl:d,data:n});i.post(l,c).then((function(t){if(!a.__destroyed__)if(e.isObject(t))s(t);else{if(!e.isString(t))throw new Error("Invalid response type for $invoke");s(t)}})).catch((function(t){o&&o.catchError?r(t):a.$alertUi(t)}))}))},$asyncValid(t,e){const i=this,s=i.__asyncCache__,n=JSON.stringify(e);let r=s[t];return r||(r={data:"",result:null},s[t]=r),r.data===n?r.result:(r.data=n,new Promise((function(s,n){i.__destroyed__||Vue.nextTick(()=>{i.$invoke(t,e).then(t=>{i.__destroyed__||(r.result=t.Result.Value,s(r.result))})})})))},$reload(t){let n=this;if(e.isArray(t)&&t.$isLazy()){let e=t._path_.lastIndexOf("."),i=t._path_.substring(e+1);return t.$loaded=!1,n.$loadLazy(t.$parent,i)}let r=`${window.$$rootUrl}/${require("std:routing").dataUrl()}/reload`,o=n.$data,l=t?a.get(t.$ModelInfo):null;if(!t&&!l){let t=this.$data._findRootModelInfo();t&&(l=a.get(t))}let d=o._saveSelections();return new Promise((function(t,c){let u={baseUrl:s.replaceUrlQuery(n.$baseUrl,l)};if(e.isDefined(o.Query)){u.baseUrl=s.replaceUrlQuery(n.$baseUrl,o.Query);let t=s.replaceUrlQuery(null,o.Query);window.history.replaceState(null,null,t)}let h=e.toJson(u);i.post(r,h).then((function(i){if(!n.__destroyed__){if(!e.isObject(i))throw new Error("Invalid response type for $reload");o.$merge(i,!0),a.reconcileAll(i.$ModelInfo),o._setModelInfo_(void 0,i),o._setRuntimeInfo_(i.$runtime),o._fireLoad_(),o._restoreSelections(d),t(o)}})).catch((function(t){n.$alertUi(t)}))}))},$requery(){this.inDialog?t.$emit("modalRequery",this.$baseUrl):t.$emit("requery")},$remove(t,e){this.$data.$readOnly||this.$isLoading||(e?this.$confirm(e).then(()=>t.$remove()):t.$remove())},$removeSelected(t,i){if(e.isArray(t)||console.error("$removeSelected. The argument is not an array"),this.$data.$readOnly)return;let s=t.$selected;s&&this.$remove(s,i)},$mailto(t,e){let i="mailto:"+t;return e&&(i+="?subject="+s.encodeUrl(e)),i},$href:(t,e)=>s.createUrlForNavigate(t,e),$navigate(e,i,n,r,o){if(this.$isReadOnly(o))return;t.$emit("closeAllPopups");let a=s.createUrlForNavigate(e,i);if(!0===n){let t=window.open(a,"_blank");t&&(t.$$token={token:this.__currentToken__,update:r})}else this.$store.commit("navigate",{url:a})},$navigateSimple(t,e,i){if(!0===e){let e=window.open(t,"_blank");e&&(e.$$token={token:this.__currentToken__,update:i})}else this.$store.commit("navigate",{url:t})},$navigateExternal(t,e){!0===e?window.open(t,"_blank"):window.location.assign(t)},$download(t){const e=window.$$rootUrl;t=s.combine("/file",t.replace(".","-")),window.location=e+t},$file(t,i,n){const r=window.$$rootUrl;let o=i,a=void 0;i&&e.isObject(i)&&(o=e.getStringId(i),i._meta_&&i._meta_.$token&&(a=i[i._meta_.$token]));let l=s.combine(r,"_file",t,o),c={},u=(n||{}).action;switch(a&&(c.token=a),"download"==u&&(c.export=1),l+=s.makeQueryString(c),u){case"download":d.downloadUrl(l);break;case"print":d.printDirect(l);break;default:window.open(l,"_blank")}},$attachment(t,i,n){const r=window.$$rootUrl;let o=n&&n.export?"export":"show",a=i,l=void 0;i&&e.isObject(i)&&(a=e.getStringId(i),i._meta_&&i._meta_.$token&&(l=i[i._meta_.$token]));let d=s.combine(r,"attachment",o,a),c={base:t};l&&(c.token=l),d+=s.makeQueryString(c),n&&n.newWindow?window.open(d,"_blank"):window.location.assign(d)},$eusign(e,i){window.$$rootUrl;var s;(s="/eusign/index",new Promise((function(n,r){const o={promise:null,data:i,query:{base:e},raw:!0};t.$emit("modal",s,o),o.promise.then((function(t){cb(t),n(t)}))}))).then((function(t,e){alert("promise resolved")}))},$dbRemove(t,s,n){if(!t)return;if(g(n,t))return void this.$alert(r.$PermissionDenied);if(this.$isLoading)return;let o=t.$id,a=!!t.$parent.$isLazy&&t.$parent.$isLazy(),l=window.$$rootUrl;const d=this;function c(){let s=l+"/_data/dbRemove",n={baseUrl:d.$baseUrl,id:o};a&&(n.prop=function(t){let e=t.lastIndexOf(".");if(-1!==e)return t.substring(e+1)}(t.$parent._path_));let r=e.toJson(n);i.post(s,r).then((function(e){d.__destroyed__||t.$remove()})).catch((function(t){d.$alertUi(t)}))}s?this.$confirm(s).then((function(){c()})):c()},$dbRemoveSelected(t,e,i){if(this.$isLoading)return;let s=t.$selected;s&&this.$dbRemove(s,e,i)},$openSelectedFrame(e,i){e=e||"";let n=i.$selected;if(!n)return;let r=s.createUrlForNavigate(e,n.$id);t.$emit("openframe",r)},$openSelected(t,i,s,n){t=t||"";let r=i.$selected;if(r){if(t.startsWith("{")){t=t.substring(1,t.length-1);let i=e.eval(r,t);if(!i)throw new Error(`Property '${t}' not found in ${r.constructor.name} object`);t=i}this.$navigate(t,r.$id,s,n)}},$hasSelected(t,e){if(e&&e.validRequired){if(!this.$data.$valid)return!1}return t&&!!t.$selected},$hasChecked:t=>t&&t.$checked&&t.$checked.length,$sanitize:t=>e.text.sanitize(t),$confirm(i){e.isString(i)&&(i={message:i}),i.style=i.style||"confirm",i.message=i.message||i.msg;let s={promise:null,data:i};return t.$emit("confirm",s),s.promise},$focus(t){let e=document.querySelector("#"+t);if(!e)return;let i=e.querySelector("input, textarea, button, select");this.$defer(()=>{i&&i.focus?i.focus():e.focus&&e.focus()})},$msg(t,e,i){let s={message:t,title:e||r.$Message,style:i||"info"};return this.$confirm(s)},$alert(i,s,n){if(e.isObject(i)&&!s&&!n){let t=i;i=t.message||t.msg,s=t.title,n=t.list}let r={promise:null,data:{message:i,title:s,style:"alert",list:n}};return t.$emit("confirm",r),r.promise},$alertUi(t){t instanceof Error?alert(t.message):0===t.indexOf("UI:")?this.$alert(t.substring(3).replace("\\n","\n")):alert(t)},$toast(i,s){i&&(e.isString(i)&&(i={text:i,style:s||"success"}),t.$emit("toast",i))},$showDialog(t,e,i,s){return this.$dialog("show",t,e,i,s)},$inlineOpen(e){t.$emit("inlineDialog",{cmd:"open",id:e})},$inlineClose(e,i){t.$emit("inlineDialog",{cmd:"close",id:e,result:i})},$dialog(i,s,n,o,a){if(this.$isReadOnly(a))return;const l=this;function d(){if(!e.isArray(n))return console.error(`$dialog.${i}. The argument is not an array`),!0}function c(){if(!e.isObjectExact(n))return console.error(`$dialog.${i}. The argument is not an object`),!0}function u(){if(g(a,n))return void l.$alert(r.$PermissionDenied);e.isFunction(o)&&(o=o());let t=a&&a.reloadAfter;switch(i){case"new":if(d())return;return m(s,0,o,t=>{let e=n.$selected;e&&e.$merge(t)});case"append":if(d())return;return m(s,0,o,t=>{n.$append(t)});case"browse":return e.isObject(n)?m(s,n,o,t=>{n.$merge?n.$merge(t):function(t,e){for(let i in t)t[i]=i in e?e[i]:void 0}(n,t)}):void console.error(`$dialog.${i}. The argument is not an object`);case"edit-selected":if(d())return;if(!n.$selected)return;return m(s,n.$selected,o,e=>{n.$selected.$merge(e),n.__fireChange__("selected"),t&&l.$reload()});case"show-selected":if(d())return;if(!n.$selected)return;return m(s,n.$selected,o,e=>{("reload"===e||t)&&l.$reload()});case"edit":if(c())return;return m(s,n,o,i=>{"reload"===i?l.$reload():n.$merge&&e.isObjectExact(i)&&(n.$merge(i),t&&l.$reload())});case"copy":if(c())return;let r=n.$parent;return m(s,n,o,e=>{r.$append(e),t&&l.$reload()});default:return m(s,n,o,e=>{t&&l.$reload()})}}if(t.$emit("closeAllPopups"),a&&a.validRequired&&root.$invalid)return void this.$alert(r.$MakeValidFirst);let h=this.$data.$mainObject;if(a&&a.saveRequired&&(this.$isDirty||h&&h.$isNew)){let t=null;return this.$save().then(()=>{t=u()}),t}return u()},$export(t,i,n,r){if(this.$isLoading)return;const o=()=>{let r=t||"0";t&&e.isObject(t)&&(r=e.getStringId(t));const o=window.$$rootUrl;let a=i?s.combine("/_export",i,r):this.$baseUrl.replace("/_page/","/_export/");a=s.combine(o,a)+s.makeQueryString(n),window.location=a};r&&r.saveRequired&&this.$isDirty?this.$save().then(()=>{o()}):o()},$exportTo(t,s){const n=window.$$rootUrl;let r=this.$el.getElementsByClassName("sheet-page");if(!r.length)return void console.error("element not found (.sheet-page)");var o=r[0].getElementsByTagName("table");if(0==o.length)return void console.error("element not found (.sheet-page table)");if(o=o[0],d){d.getColumnsWidth(o);let t=o.classList.contains("compact")?4:12;d.getRowHeight(o,t)}let a="<table>"+o.innerHTML+"</table>",l={format:t,html:a,fileName:s,zoom:+window.devicePixelRatio.toFixed(2)};let c=`${n}/${require("std:routing").dataUrl()}/exportTo`;i.post(c,e.toJson(l),!0).then((function(e){d&&d.downloadBlob(e,s,t)})).catch((function(t){alert(t)}))},$report(t,i,n,o,a){if(this.$isReadOnly(n))return;if(this.$isLoading)return;let l="show",c="";n&&(n.export?(l="export",c=n.format||""):n.attach?l="attach":n.print&&(l="print"));const u=()=>{let r=i;i&&e.isObject(i)&&(r=e.getStringId(i));let u=`${window.$$rootUrl}/report/${l}/${r}`,h=s.removeFirstSlash(o)||this.$indirectUrl||this.$baseUrl,p=s.makeBaseUrl(h),m=Object.assign({},{base:p,rep:t},a);if(c&&(m.format=c),u+=s.makeQueryString(m),n)if(n.export)window.location=u;else if(n.print)d.printDirect(u);else{if(n.attach)return;window.open(u,"_blank")}else window.open(u,"_blank")};n&&n.validRequired&&root.$invalid?this.$alert(r.$MakeValidFirst):n&&n.saveRequired&&this.$isDirty?this.$save().then(()=>{u()}):u()},$modalSaveAndClose(e,i){if(this.$isDirty){const e=this.$data;if(i&&i.validRequired&&e.$invalid){let t=f(e.$forceValidate());return void this.$alert(r.$MakeValidFirst,void 0,t)}this.$save().then(e=>t.$emit("modalClose",e))}else t.$emit("modalClose",e)},$modalClose(e){t.$emit("modalClose",e)},$setFilter(e,i,s){t.$emit("setFilter",{source:e,prop:i,value:s})},$modalSelect(t,e){if("$selected"in t){if(e&&e.validRequired){if(!this.$data.$valid)return}this.$modalClose(t.$selected)}else console.error("Invalid array for $modalSelect")},$modalSelectChecked(t){if(!("$checked"in t))return void console.error("invalid array for $modalSelectChecked");let e=t.$checked;e.length>0&&this.$modalClose(e)},$saveAndClose(t){this.$isDirty?this.$save(t).then(()=>this.$close()):this.$close()},$close(){this.$saveModified()&&this.$store.commit("close")},$showHelp(t){window.open(this.$helpHref(t),"_blank")},$helpHref:t=>s.helpHref(t),$searchChange(){let t=this.$store.replaceUrlSearch(this.$baseUrl);this.$data.__baseUrl__=t,this.$reload()},$saveModified(e,i){if(!this.$isDirty)return!0;let s=this,n={message:e||r.$ElementWasChanged,title:i||r.$ConfirmClose,buttons:[{text:r.$Save,result:"save"},{text:r.$NotSave,result:"close"},{text:r.$Cancel,result:!1}]};function o(e){s.inDialog?t.$emit("modalClose",e):s.$close()}return this.$confirm(n).then((function(t){"close"===t?(s.$data.$setDirty(!1),o(!1)):"save"===t&&s.$save().then((function(t){o(t)}))})),!1},$format:(t,i)=>i?(e.isString(i)&&(i={dataType:i}),i.format||i.dataType||i.mask?i.mask?t?o.getMasked(i.mask,t):t:i.dataType?e.format(t,i.dataType,{hideZeros:i.hideZeros,format:i.format}):i.format&&-1!==i.format.indexOf("{0}")?i.format.replace("{0}",t):e.isDate(t)&&i.format?e.format(t,"DateTime",{format:i.format}):t:t):t,$getNegativeRedClass:t=>e.isNumber(t)&&t<0?"negative-red":"",$expand(t,s,n){let r=this,o=window.$$rootUrl+"/_data/expand";return new Promise((function(a,d){let c=t[s];if(e.isDefined(n)){if(t.$expanded==n)return void a(c);l.set(t,"$expanded",n)}if(c.$loaded)return void a(c);if(!e.isDefined(t.$hasChildren))return void a(c);if(!t.$hasChildren)return c.$loaded=!0,void a(c);let u=e.toJson({baseUrl:r.$baseUrl,id:t.$id});i.post(o,u).then((function(t){if(r.__destroyed__)return;let e=t[s];if(c.$empty(),e)for(let t of e)c.push(c.$new(t));a(c)})).catch((function(t){r.$alertUi(t),d(c)})),c.$loaded=!0}))},$loadLazy(t,n){const r=require("std:routing");let o=this,l=`${window.$$rootUrl}/${r.dataUrl()}/loadlazy`,d=t[n].$ModelInfo,c=(t.$parent.$ModelInfo,a.get(d)),u=s.parseUrlAndQuery(o.$baseUrl,c).url+s.makeQueryString(c),h=e.toJson({baseUrl:u,id:t.$id,prop:n});return new Promise((function(e,s){let r=t[n];r.$loaded?e(r):(i.post(l,h).then((function(t){if(!o.__destroyed__){if(n in t){r.$empty();for(let e of t[n])r.push(r.$new(e));let e=n+".$RowCount";e in t&&(r.$RowCount=t[e]),t.$ModelInfo&&a.reconcile(t.$ModelInfo[n]),r._root_._setModelInfo_(r,t)}e(r)}})).catch((function(t){o.$alertUi(t)})),r.$loaded=!0)}))},$delegate(t){return this.$data._delegate_(t)},$defer:l.defer,$print:l.print,$hasError(t){let i=this[e.text.splitPath(t).obj]._errors_;if(!i)return!1;let s=i[t];return s&&s.length},$errorMessage(t){let i=this[e.text.splitPath(t).obj]._errors_;if(!i)return"";let s=i[t];return s&&s.length?s[0].msg:""},$getErrors(t){let i=this.$data.$forceValidate();if(!i||!i.length)return null;t&&!e.isArray(t)&&(t=[t]);let s=[];for(let e of i)for(let i=0;i<e.e.length;i++){let r=e.e[i];n=r.severity,t&&-1===t.indexOf(n)||s.push({path:e,msg:r.msg,severity:r.severity,index:i})}var n;return s.length?s:null},__beginRequest(){this.$data.__requestsCount__+=1},__endRequest(){this.$data.__requestsCount__-=1},__cwChange(t){this.$reload(t)},__queryChange(t,i){e.isObjectExact(t)||console.error("base.__queryChange. invalid argument type");let s=Object.assign({},this.$baseQuery);for(let e in t)t[e]?s[e]=t[e]:delete s[e];let n=i?i.$ModelInfo:this.$data._findRootModelInfo();a.copyfromQuery(n,s),this.$reload(i)},__doInit__(t){const e=this.$data;if(!e._modelLoad_)return;let i=null;t&&(e.__baseUrl__=t),this.$caller&&(i=this.$caller.$data),this.__createController__(),e._modelLoad_(i),e._seal_(e)},__createController__(){let t={$save:this.$save,$invoke:this.$invoke,$close:this.$close,$modalClose:this.$modalClose,$msg:this.$msg,$alert:this.$alert,$confirm:this.$confirm,$showDialog:this.$showDialog,$inlineOpen:this.$inlineOpen,$inlineClose:this.$inlineClose,$saveModified:this.$saveModified,$asyncValid:this.$asyncValid,$toast:this.$toast,$requery:this.$requery,$reload:this.$reload,$notifyOwner:this.$notifyOwner,$navigate:this.$navigate,$defer:l.defer,$setFilter:this.$setFilter,$expand:this.$expand,$focus:this.$focus,$report:this.$report};return Object.defineProperty(t,"$isDirty",{enumerable:!0,configurable:!0,get:()=>this.$isDirty}),Object.defineProperty(t,"$isPristine",{enumerable:!0,configurable:!0,get:()=>this.$isPristine}),Object.seal(t),t},__notified(t){t&&this.__currentToken__===t.token&&(t.toast&&this.$toast(t.toast),this.$reload(t.update||null).then((function(i){if(!t.id)return;if(!e.isArray(i))return;let s=i.find(e=>e.$id===t.id);s&&s.$select&&s.$select()})))},__parseControllerAttributes(t){if(!t)return null;let e=JSON.parse(t.replace(/\'/g,'"')),i={};if(e.canClose){let t=this.$delegate(e.canClose);t&&(i.canClose=t.bind(this.$data))}return e.alwaysOk&&(i.alwaysOk=!0),i},__isModalRequery(){let e={url:this.$baseUrl,result:!1};return t.$emit("isModalRequery",e),e.result},__invoke__test__(t){if("controller"!==(t=t||{}).target)return;if(this.inDialog&&t.testId!==this.__testId__)return;const i=this.$data;switch(t.action){case"eval":t.result=e.eval(i,t.path)}},__global_period_changed__(t){this.$data._fireGlobalPeriodChanged_(t)}},created(){let e={caller:null};t.$emit("registerData",this,e),this.$caller=e.caller,this.__destroyed__=!1,t.$on("beginRequest",this.__beginRequest),t.$on("endRequest",this.__endRequest),t.$on("queryChange",this.__queryChange),t.$on("childrenSaved",this.__notified),t.$on("invokeTest",this.__invoke__test__),t.$on("globalPeriodChanged",this.__global_period_changed__),this.$on("cwChange",this.__cwChange),this.__asyncCache__={},this.__currentToken__=window.app.nextToken(),n&&n.time("create time:",p,!1)},beforeDestroy(){this.$data._fireUnload_()},destroyed(){this.$caller=null,t.$emit("registerData",null),t.$off("beginRequest",this.__beginRequest),t.$off("endRequest",this.__endRequest),t.$off("queryChange",this.__queryChange),t.$off("childrenSaved",this.__notified),t.$off("invokeTest",this.__invoke__test__),t.$off("globalPeriodChanged",this.__global_period_changed__),this.$off("cwChange",this.__cwChange),d.removePrintFrame(),this.$data.$destroy&&this.$data.$destroy(),this._data=null,this.__destroyed__=!0},beforeUpdate(){h=performance.now()},beforeCreate(){p=performance.now()},mounted(){let t=this.$el.getAttribute("test-id");t&&(this.__testId__=t)},updated(){n&&n.time("update time:",h,!1)}});app.components.baseController=v}(),function(){const t=require("std:platform"),e=require("std:url");function i(t,e){return!(!e||!t)&&-1!==t.indexOf(e+",")}function s(e,i,n){if(!e)return null;for(let r=0;r<e.length;r++){let o=e[r];if(i(o))return o;if(o.Menu){n&&(n.Url=o.Url);let e=s(o.Menu,i);if(e)return t.set(o,"$expanded",!0),e}}return null}app.components["std:navmenu"]={findMenu:s,makeMenuUrl:function(t,n,r){r=r||{};let o=(n=e.combine(n).toLowerCase()).split("/");if(o.length>=4)return n;o.length;let a=o[1];if("app"===a)return n;if(r&&i(r.pages,a))return n;let l=null;if(a&&(l=t.find(t=>t.Url===a)),l){if(l&&!l.Menu)return r.title=l.Name,n}else{let i={Url:""};if(l=s(t,t=>t.Url&&!t.Menu,i),l)return r.title=l.Name,e.combine(n,i.Url,l.Url)}n=e.combine(a);let d=o[2];return!d&&r.seg2&&(d=r.seg2),l=s(l.Menu,d?t=>t.Url===d:t=>t.Url&&!t.Menu),l?(r.title=l.Name,e.combine(n,l.Url)):n},isSeparatePage:i}}(),function(){const t=window.$$locale,e=component("std:navmenu"),i=require("std:eventBus"),s=require("std:period"),n=component("std:store"),r=require("std:url"),o=require("std:http"),a={template:'\n<ul class="nav-bar">\n\t<li v-for="(item, index) in menu" :key="index" :class="{active : isActive(item)}">\n\t\t<a :href="itemHref(item)" tabindex="-1" v-text="item.Name" @click.prevent="navigate(item)"></a>\n\t</li>\n\t<li class="aligner"/>\n\t<div class="nav-global-period" v-if="hasPeriod">\n\t\t<a2-period-picker class="drop-bottom-right pp-hyperlink pp-navbar" \n\t\t\tdisplay="namedate" :callback="periodChanged" prop="period" :item="that"/>\n\t</div>\n\t<li v-if="hasHelp()" :title="locale.$Help"><a :href="helpHref()" class="btn-help" rel="help" aria-label="Help" @click.prevent="showHelp()"><i class="ico ico-help"></i></a></li>\n</ul>\n',props:{menu:Array,period:s.constructor,isNavbarMenu:Boolean},computed:{seg0:()=>n.getters.seg0,seg1:()=>n.getters.seg1,locale:()=>t,hasPeriod(){return!!this.period},that(){return this}},methods:{isActive(t){return this.seg0===t.Url},isActive2(t){return this.seg1===t.Url},itemHref:t=>"/"+t.Url,navigate(t){if(this.isActive(t))return;let i="menu:"+r.combine(window.$$rootUrl,t.Url),s=localStorage.getItem(i)||"";s&&!e.findMenu(t.Menu,t=>t.Url===s)&&(s="");let n={title:null,seg2:s},o=e.makeMenuUrl(this.menu,t.Url,n);this.$store.commit("navigate",{url:o,title:n.title})},showHelp(){window.open(this.helpHref(),"_blank")},_findHelp(){if(!this.menu)return null;let t=this.menu.find(t=>this.isActive(t));if(t&&t.Menu){let i=e.findMenu(t.Menu,t=>this.isActive2(t));if(i&&i.Help)return i.Help}return t?t.Help:null},helpHref(){let t=this._findHelp()||"";return r.helpHref(t)},hasHelp(){return!!this._findHelp()},periodChanged(t){o.post("/_application/setperiod",t.toJson()).then(()=>{i.$emit("globalPeriodChanged",t)}).catch(t=>{alert(t)})}}},l={template:'\n<div class="menu-navbar-overlay" @click.stop=closeNavMenu>\n<div class="menu-navbar" :class="{show:visible}">\n<div class="menu-navbar-top">\n\t<a href=\'\' class=menu-navbar-back @click.stop.prevent=closeNavMenu><i class="ico ico-grid2"></i></a>\n\t<h2 v-text=title></h2>\n</div>\n<ul class=menu-navbar-list>\n\t<li v-for="(item, index) in menu" :key=index>\n\t\t<a class="menu-navbar-link" :href="itemHref(item)" @click.prevent="navigate(item)" :class="{active : isActive(item)}">\n\t\t\t<i class="ico" :class=icoClass(item)></i>\n\t\t\t<span v-text="item.Name"></span>\n\t\t</a>\n\t</li>\n</ul>\n<div class="aligner"/>\n<a class=powered-by-a2v10 href="https://a2v10.com" rel=noopener target=_blank><i class="ico ico-a2logo"></i> Powered by A2v10</a>\n</div></div>\n',props:{menu:Array,isNavbarMenu:Boolean,title:String},data:()=>({visible:!1}),computed:{seg0:()=>n.getters.seg0,seg1:()=>n.getters.seg1,locale:()=>t,that(){return this}},methods:{isActive(t){return this.seg0===t.Url},isActive2(t){return this.seg1===t.Url},itemHref:t=>"/"+t.Url,icoClass:t=>t.Icon?"ico-"+t.Icon:"ico-empty",navigate(t){if(this.isActive(t))return;this.closeNavMenu();let i="menu:"+r.combine(window.$$rootUrl,t.Url),s=localStorage.getItem(i)||"";s&&!e.findMenu(t.Menu,t=>t.Url===s)&&(s="");let n={title:null,seg2:s},o=e.makeMenuUrl(this.menu,t.Url,n);this.$store.commit("navigate",{url:o,title:n.title})},closeNavMenu(){this.visible=!1,i.$emit("clickNavMenu",!1)}},mounted(){setTimeout(()=>{this.visible=!0},5)}};app.components["std:navbar"]={standardNavBar:a,pageNavBar:l}}(),function(){const t=component("std:navmenu"),e=component("std:store"),i=require("std:url"),s=require("std:html"),n={props:{menu:Array,mode:String},computed:{seg0:()=>e.getters.seg0,seg1:()=>e.getters.seg1,sideMenu(){let t=this.topMenu;return t?t.Menu:null},topMenu(){let e=this.seg0;return t.findMenu(this.menu,t=>t.Url===e)}},methods:{isActive(t){let e=this.seg1===t.Url;return e&&s.updateDocTitle(t.Name),e},isGroup(t){if(!t.Params)return!1;try{return JSON.parse(t.Params).group||!1}catch(t){return!1}},navigate(t){if(this.isActive(t))return;if(!t.Url)return;let e=this.topMenu;if(e){let s=i.combine(e.Url,t.Url);if(-1===t.Url.indexOf("/"))try{localStorage.setItem("menu:"+i.combine(window.$$rootUrl,e.Url),t.Url)}catch(t){}this.$store.commit("navigate",{url:s,title:t.Name})}else console.error("no top menu found")},itemHref(t){let e=this.topMenu;if(e)return i.combine(e.Url,t.Url)},toggle(){this.$parent.sideBarCollapsed=!this.$parent.sideBarCollapsed;try{localStorage.setItem("sideBarCollapsed",this.$parent.sideBarCollapsed)}catch(t){}}}},r={template:'\n<div :class="cssClass">\n\t<a href role="button" class="ico collapse-handle" @click.prevent="toggle"></a>\n\t<div class="side-bar-body" v-if="bodyIsVisible">\n\t\t<tree-view :items="sideMenu" :is-active="isActive" :is-group="isGroup" :click="navigate" :get-href="itemHref"\n\t\t\t:options="{folderSelect: folderSelect, label: \'Name\', title: \'Description\',\n\t\t\tsubitems: \'Menu\', expandAll:true,\n\t\t\ticon:\'Icon\', wrapLabel: true, hasIcon: true}">\n\t\t</tree-view>\n\t</div>\n\t<div v-else class="side-bar-title" @click.prevent="toggle">\n\t\t<span class="side-bar-label" v-text="title"></span>\n\t</div>\n</div>\n',mixins:[n],computed:{bodyIsVisible(){return!this.$parent.sideBarCollapsed||this.compact},compact(){return"Compact"===this.mode},title(){let e=this.sideMenu;if(!e)return"unknown title";let i=this.seg1,s=t.findMenu(e,t=>t.Url===i);return s&&s.Name||"unknown title"},cssClass(){let t="side-bar";return this.compact&&(t+="-compact"),t+(this.$parent.sideBarCollapsed?" collapsed":" expanded")}},methods:{folderSelect:t=>!!t.Url}},o={template:'\n<div class="side-bar-top">\n\t<div class="a2-tab-bar">\n\t\t<div v-for="mi in topMenu.Menu" class="a2-tab-bar-item">\n\t\t\t<a :href="itemHref(mi)" @click.stop.prevent="navigate(mi)" v-text=mi.Name class="a2-tab-button" :class="{active: isActive(mi)}"></a>\n\t\t</div>\n\t</div>\n</div>\n',mixins:[n],computed:{},methods:{}};app.components["std:sidebar"]={standardSideBar:r,compactSideBar:r,tabSideBar:o}}(),function(){const t=component("std:store"),e=require("std:eventBus"),i=component("std:modal"),s=component("std:toastr"),n=require("std:popup"),r=require("std:url"),o=require("std:period"),a=require("std:log"),l=require("std:utils"),d=window.$$locale,c=require("std:platform"),u=component("std:navbar"),h=component("std:sidebar"),p=component("std:navmenu"),m={template:'\n<header class="header">\n\t<div class=h-menu v-if=isNavBarMenu @click.stop.prevent=clickMenu><i class="ico ico-grid2"></i></div>\n\t<div class=h-block v-if=\'!isNavBarMenu\'>\n\t\t\x3c!--<i class="ico-user"></i>--\x3e\n\t\t<a class=app-title href=\'/\' @click.prevent="root" v-text="title" tabindex="-1"></a>\n\t\t<span class=app-subtitle v-text="subtitle"></span>\n\t</div>\n\t<div v-if=isNavBarMenu class=h-menu-title v-text=seg0text></div>\n\t<div class="aligner"></div>\n\t<span class="title-notify" v-if="notifyText" v-text="notifyText" :title="notifyText" :class="notifyClass"></span>\n\t<div class="aligner"></div>\n\t<template v-if="!isSinglePage ">\n\t\t<a2-new-button :menu="newMenu" icon="plus" btn-style="success"></a2-new-button>\n\t\t<slot></slot>\n\t\t<a2-new-button :menu="settingsMenu" icon="gear-outline" :title="locale.$Settings"></a2-new-button>\n\t\t<a class="nav-admin middle" v-if="hasFeedback" tabindex="-1" @click.prevent="showFeedback" :title="locale.$Feedback" :class="{open: feedbackVisible}"><i class="ico ico-comment-outline"></i></a>\n\t\t<a class="nav-admin" v-if="userIsAdmin" href="/admin/" tabindex="-1"><i class="ico ico-gear-outline"></i></a>\n\t</template>\n\t<div class="dropdown dir-down separate" v-dropdown>\n\t\t<button class="btn user-name" toggle :title="personName"><i class="ico ico-user"></i> \n\t\t\t<span id="layout-person-name" class="person-name" v-text="personName"></span>\n\t\t\t<span id="layout-client-id" class="client-id" v-if="clientId"> [<span v-text="clientId" ></span>]</span>\n\t\t\t<span class="caret"></span>\n\t\t</button>\n\t\t<div class="dropdown-menu menu down-left">\n\t\t\t<a v-if="!isSinglePage " v-for="(itm, itmIndex) in profileItems" @click.prevent="doProfileMenu(itm)" class="dropdown-item" tabindex="-1"><i class="ico" :class="\'ico-\' + itm.icon"></i> <span v-text="itm.title" :key="itmIndex"></span></a>\n\t\t\t<a @click.prevent="changePassword" class="dropdown-item" tabindex="-1"><i class="ico ico-access"></i> <span v-text="locale.$ChangePassword"></span></a>\n\t\t\t<div class="divider"></div>\n\t\t\t<form id="logoutForm" method="post" action="/account/logoff">\n\t\t\t\t<a href="javascript:document.getElementById(\'logoutForm\').submit()" tabindex="-1" class="dropdown-item"><i class="ico ico-exit"></i> <span v-text="locale.$Quit"></span></a>\n\t\t\t</form>\n\t\t</div>\n\t</div>\n</header>\n',props:{title:String,subtitle:String,userState:Object,personName:String,clientId:String,userIsAdmin:Boolean,menu:Array,newMenu:Array,settingsMenu:Array,appData:Object,showFeedback:Function,feedbackVisible:Boolean,singlePage:String,changePassword:Function,navBarMode:String},computed:{isSinglePage(){return!!this.singlePage},locale:()=>d,notifyText(){return this.getNotify(2)},notifyClass(){return this.getNotify(1).toLowerCase()},feedback(){return this.appData?this.appData.feedback:null},hasFeedback(){return this.appData&&this.appData.feedback},profileItems(){return this.appData?this.appData.profileMenu:null},isNavBarMenu(){return"Menu"===this.navBarMode},seg0text(){let t=this.$store.getters.seg0,e=this.menu.find(e=>e.Url===t);return e?e.Name:""}},methods:{getNotify(t){let e=this.userState?this.userState.Notify:null;if(!e)return"";let i=e.match(/\((.*)\)(.*)/);return i&&i.length>t?i[t]:""},root(){let t={title:null},e=this.$store.getters.url,i=this.isSinglePage?"/"+this.singlePage:p.makeMenuUrl(this.menu,"/",t);e!==i&&this.$store.commit("navigate",{url:i,title:t.title})},doProfileMenu(e){t.commit("navigate",{url:e.url})},clickMenu(){this.isNavBarMenu&&e.$emit("clickNavMenu",!0)}}},f={render(t){return t("div",{attrs:{class:"content-view "+this.cssClass}},[t("include",{props:{src:this.currentView,needReload:this.needReload}})])},computed:{currentView(){let e=window.$$rootUrl,i=t.getters.url;if("/"===i)return;let s=t.getters.len;return 2!==s&&3!==s||(i+="/index/0"),r.combine(e,"/_page",i)+t.getters.search},cssClass(){let t=this.$store.getters.route;return"app"===t.seg0||p.isSeparatePage(this.pages,t.seg0)?"full-view":3===t.len?"partial-page":2===t.len?"full-page":"full-view"}},props:{pages:String},data:()=>({needReload:!1}),created(){var t=this;e.$on("requery",(function(){t.needReload=!0,Vue.nextTick(()=>t.needReload=!1)}))}},g={store:t,template:'\n<div :class=cssClass class=main-view>\n\t<component :is=navBarComponent :title=title :menu=menu v-if=isNavBarVisible \n\t\t:period=period :is-navbar-menu=isNavBarMenu></component>\n\t<component :is=sideBarComponent v-if=sideBarVisible :menu=menu :mode=sideBarMode></component>\n\t<a2-content-view :pages=pages></a2-content-view>\n\t<div class=load-indicator v-show=pendingRequest></div>\n\t<div class=modal-stack v-if=hasModals>\n\t\t<div class="modal-wrapper modal-animation-frame" v-for="dlg in modals" :class="{show: dlg.wrap}">\n\t\t\t<a2-modal :dialog=dlg></a2-modal>\n\t\t</div>\n\t</div>\n\t<a2-toastr></a2-toastr>\n</div>',components:{"a2-nav-bar":u.standardNavBar,"a2-nav-bar-page":u.pageNavBar,"a2-side-bar":h.standardSideBar,"a2-side-bar-compact":h.compactSideBar,"a2-side-bar-tab":h.tabSideBar,"a2-content-view":f,"a2-modal":i,"a2-toastr":s},props:{menu:Array,sideBarMode:String,navBarMode:String,period:o.constructor,pages:String,title:String},data:()=>({sideBarCollapsed:!1,showNavBar:!0,requestsCount:0,modals:[],modalRequeryUrl:""}),computed:{navBarComponent(){return this.isNavBarMenu?"a2-nav-bar-page":"a2-nav-bar"},sideBarComponent(){return"Compact"===this.sideBarMode?"a2-side-bar-compact":"TabBar"===this.sideBarMode?"a2-side-bar-tab":"a2-side-bar"},isSideBarCompact(){return"Compact"===this.sideBarMode},route(){return this.$store.getters.route},sideBarInitialCollapsed:()=>"true"===localStorage.getItem("sideBarCollapsed")||!window.matchMedia("(min-width:1025px)").matches,isNavBarVisible(){if(!this.showNavBar)return!1;if(this.isNavBarMenu)return!0;let t=this.route;return!p.isSeparatePage(this.pages,t.seg0)&&("app"!==t.seg0&&(2===t.len||3===t.len))},sideBarVisible(){let t=this.route;return"app"!==t.seg0&&3===t.len},isSideBarTop(){return"TabBar"===this.sideBarMode},cssClass(){let t=(this.isNavBarMenu?"nav-bar-menu ":"")+"side-bar-position-"+(this.isSideBarTop?"top ":"left ");return this.isSideBarTop?t+=this.sideBarVisible?"":"side-bar-hidden":t+=this.sideBarCollapsed?"collapsed":"expanded",t},pendingRequest(){return!this.hasModals&&this.requestsCount>0},hasModals(){return this.modals.length>0},isNavBarMenu(){return"Menu"===this.navBarMode}},methods:{setupWrapper(t){this.modalRequeryUrl="",setTimeout(()=>{t.wrap=!0},50)},showNavMenu(t){t&&e.$emit("closeAllPopups"),this.showNavBar=t}},created(){let i=this;function s(){for(let t=i.modals.length-1;t>=0;--t){let e=i.modals[t];if(e.rd)return e}return null}if(this.isNavBarMenu&&(this.showNavBar=!1),e.$on("beginRequest",(function(){i.requestsCount+=1})),e.$on("endRequest",(function(){i.requestsCount-=1})),this.isNavBarMenu&&e.$on("clickNavMenu",this.showNavMenu),e.$on("modal",(function(e,s){let n=l.getStringId(s?s.data:null),o=s&&s.raw,a=window.$$rootUrl,d=r.combine(a,"/_dialog",e,n);o&&(d=r.combine(a,e,n)),d=t.replaceUrlQuery(d,s.query);let c={title:"dialog",url:d,prms:s.data,wrap:!1,rd:s.rd};c.promise=new Promise((function(t,e){c.resolve=t})),s.promise=c.promise,i.modals.push(c),i.setupWrapper(c)})),e.$on("modaldirect",(function(t,e){let s=window.$$rootUrl,n={title:"dialog",url:r.combine(s,"/_dialog",t),prms:e.data,wrap:!1};n.promise=new Promise((function(t,e){n.resolve=t})),e.promise=n.promise,i.modals.push(n),i.setupWrapper(n)})),e.$on("modalSetAttribites",(function(t,e){if(!t||!e)return;let i=s();i&&(i.attrs=e.__parseControllerAttributes(t))})),e.$on("modalCreated",(function(t){let e=s();e&&(e.instance=t)})),e.$on("isModalRequery",(function(t){t.url&&i.modalRequeryUrl&&i.modalRequeryUrl===t.url&&(t.result=!0)})),e.$on("modalRequery",(function(t){let e=s();if(!e)return;let n=e.instance;n&&n.modalRequery&&(t&&(e.url=t),i.modalRequeryUrl=e.url,n.modalRequery())})),e.$on("modalSetBase",(function(t){let e=s();e&&(e.url=t)})),e.$on("modalClose",(function(t){if(!i.modals.length)return;if(i.requestsCount>0)return;const e=i.modals[i.modals.length-1];function s(t){let e=i.modals.pop();t&&e.resolve(t)}if(e.attrs)if(e.attrs.alwaysOk&&(t=!0),e.attrs.canClose){let i=e.attrs.canClose();!0===i?s(t):i.then?t.then((function(e){!0===e?s(t):e&&s(e)})):i&&s(i)}else s(t);else s(t)})),e.$on("modalCloseAll",(function(){for(;i.modals.length;){i.modals.pop().resolve(!1)}})),e.$on("confirm",(function(t){let e=t.data;e.wrap=!1,e.promise=new Promise((function(t){e.resolve=t})),t.promise=e.promise,i.modals.push(e),i.setupWrapper(e)})),!this.menu){let t={promise:null,data:{message:d.$AccessDenied,title:d.$Error,style:"alert"}};return e.$emit("confirm",t),void t.promise.then((function(){let t=window.$$rootUrl,e=r.combine(t,"/account/login");window.location.assign(e)}))}this.sideBarCollapsed=this.sideBarInitialCollapsed;let n={title:null,pages:this.pages},o=r.normalizeRoot(window.location.pathname);"/home"===o&&this.menu&&!this.menu.find(t=>"home"===t.Url.toLowerCase())&&(o="/");let a=p.makeMenuUrl(this.menu,o,n);a+=window.location.search,this.$store.commit("setstate",{url:a,title:n.title});let u={url:"",title:""};u.url=p.makeMenuUrl(this.menu,"/",n),u.title=n.title,r.firstUrl=u,function t(e){if(e)for(let i of e)"Menu"in i&&(c.set(i,"$expanded",!0),t(i.Menu))}(this.menu)}},v=Vue.extend({components:{"a2-main-view":g,"a2-app-header":m},store:t,data:()=>({requestsCount:0,loadsCount:0,debugShowTrace:!1,debugShowModel:!1,feedbackVisible:!1,globalPeriod:null,dataCounter:0,traceEnabled:a.traceEnabled()}),computed:{processing(){return!this.hasModals&&this.requestsCount>0},modelStack(){return this.__dataStack__},singlePage(){let t=this.$store.getters.seg0;if(p.isSeparatePage(this.pages,t))return t}},watch:{traceEnabled(t){a.enableTrace(t)}},methods:{about(){this.$store.commit("navigate",{url:"/app/about"})},appLink(t){this.$store.commit("navigate",{url:t.url})},navigate(t){this.$store.commit("navigate",{url:t})},debugOptions(){alert("debug options")},debugTrace(){window.$$debug&&(this.debugShowModel=!1,this.feedbackVisible=!1,this.debugShowTrace=!this.debugShowTrace)},debugModel(){window.$$debug&&(this.debugShowTrace=!1,this.feedbackVisible=!1,this.debugShowModel=!this.debugShowModel)},debugClose(){this.debugShowModel=!1,this.debugShowTrace=!1,this.feedbackVisible=!1},showFeedback(){this.debugShowModel=!1,this.debugShowTrace=!1,this.feedbackVisible=!this.feedbackVisible},feedbackClose(){this.feedbackVisible=!1},profile(){alert("user profile")},changeUser(){alert("change user")},changePassword(){if(window.cefHost)return void this.$alert(d.$DesktopNotSupported);const t={promise:null,data:{Id:-1}};e.$emit("modal","/app/changePassword",t),t.promise.then((function(t){!1!==t&&e.$emit("toast",{text:d.$ChangePasswordSuccess,style:"success"})}))},$alert(t,i,s){let n={promise:null,data:{message:t,title:i,style:"alert",list:s}};return e.$emit("confirm",n),n.promise}},created(){let t=this;this.initialPeriod&&(this.globalPeriod=new o.constructor(this.initialPeriod)),t.__dataStack__=[],window.addEventListener("popstate",(function(i,s,n){if(e.$emit("modalCloseAll"),t.__dataStack__.length>0){let e=t.__dataStack__[0],s=i.state;if(!e.$saveModified())return s=e.$data.__baseUrl__.replace("/_page",""),void window.history.pushState(s,null,s)}t.$store.commit("popstate")})),e.$on("registerData",(function(e,i){t.dataCounter+=1,e?(t.__dataStack__.length>0&&(i.caller=t.__dataStack__[0]),t.__dataStack__.unshift(e)):t.__dataStack__.shift(e)})),n.startService(),e.$on("beginRequest",()=>{t.requestsCount+=1,window.__requestsCount__=t.requestsCount}),e.$on("endRequest",()=>{t.requestsCount-=1,window.__requestsCount__=t.requestsCount}),e.$on("beginLoad",()=>{void 0===window.__loadsCount__&&(window.__loadsCount__=0),t.loadsCount+=1,window.__loadsCount__=t.loadsCount}),e.$on("endLoad",()=>{t.loadsCount-=1,window.__loadsCount__=t.loadsCount}),e.$on("closeAllPopups",n.closeAll)}});app.components["std:shellController"]=v}(),function(){const t=component("std:store"),e=require("std:eventBus");let i=void 0;window.__tests__={$navigate:function(e){t.commit("navigate",{url:e})},$isReady:function(){return"complete"===document.readyState&&window.__requestsCount__+window.__loadsCount__===0},$invoke:function(t){return"shell"===t.target?function(t){i=void 0;const e=require("std:http"),s=window.$$rootUrl,n=require("std:routing"),r=`${s}/${n.dataUrl()}/invoke`,o={cmd:t.cmd,baseUrl:`/_page${t.path}/index/${t.id}`,data:null};e.post(r,JSON.stringify(o)).then(e=>{t.result="success:"+e,i=t.result}).catch(e=>{t.result="error:"+e,i=t.result})}(t):e.$emit("invokeTest",t),t.result},$lastResult:()=>i}}();